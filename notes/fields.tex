\documentclass{amsart}
\usepackage{hyperref}
\usepackage{fullpage}
\usepackage{amsrefs}
\usepackage{verbatim}
\usepackage{tikz}
\usepackage[type={CC},modifier={by-nc-sa},version={3.0}]{doclicense}

\newif\ifscreen
\newif\iftwo
\newif\ifshowall
\newif\ifshowkeys
\screenfalse
\twotrue
\showalltrue
\showkeystrue

\input xypic
\newdir{ >}{{}*!/-9pt/\dir{>}}

\ifshowkeys
\newcommand{\lbl}[1]{\label{#1}\textup{[\texttt{#1}]}\ \\}
\else
\newcommand{\lbl}{\label}
\fi

%\input{fields_macros}

\newcommand{\Aff}       {\operatorname{Aff}}
\newcommand{\Gal}       {\operatorname{Gal}}
\newcommand{\chr}       {\operatorname{char}}
\newcommand{\img}       {\operatorname{image}}
\newcommand{\inc}       {\operatorname{inc}}
\newcommand{\lcm}	{\operatorname{lcm}}
\newcommand{\sgn}	{\operatorname{sgn}}
\newcommand{\stab}	{\operatorname{stab}}
\newcommand{\trc}	{\operatorname{trace}}

\newcommand{\N}         {{\mathbb{N}}}
\newcommand{\Z}         {{\mathbb{Z}}}
\newcommand{\Q}         {{\mathbb{Q}}}
\newcommand{\R}         {{\mathbb{R}}}
\newcommand{\C}         {{\mathbb{C}}}
\newcommand{\F}         {{\mathbb{F}}}          

\newcommand{\al}        {\alpha}
\newcommand{\bt}        {\beta} 
\newcommand{\gm}        {\gamma}
\newcommand{\dl}        {\delta}
\newcommand{\zt}        {\zeta}
\newcommand{\tht}       {\theta}
\newcommand{\kp}        {\kappa}
\newcommand{\lm}        {\lambda}
\newcommand{\ep}        {\epsilon}
\newcommand{\sg}        {\sigma}
\newcommand{\om}        {\omega}
\newcommand{\ob}        {\overline{\omega}}
\newcommand{\vph}       {\varphi}

\newcommand{\Dl}        {\Delta}
\newcommand{\Sg}        {\Sigma}

\newcommand{\CA}        {{\mathcal{A}}}
\newcommand{\CB}        {{\mathcal{B}}}
\newcommand{\CH}        {{\mathcal{H}}}
\newcommand{\CL}        {{\mathcal{L}}}
\newcommand{\CM}        {{\mathcal{M}}}
\newcommand{\CN}        {{\mathcal{N}}}
\newcommand{\CP}        {{\mathcal{P}}}
\newcommand{\CV}        {{\mathcal{V}}}
\newcommand{\CX}        {{\mathcal{X}}}

\newcommand{\bsm}       {\left[\begin{smallmatrix}}
\newcommand{\esm}       {\end{smallmatrix}\right]}
\newcommand{\iffa}      {\Leftrightarrow}
\newcommand{\ov}[1]     {\overline{#1}}
\newcommand{\sm}        {\setminus}
\newcommand{\st}        {\;|\;}
\newcommand{\tm}        {\times}
\newcommand{\blm}	{\mathbf{\lambda}}
\newcommand{\sse}       {\subseteq}
\newcommand{\xra}       {\xrightarrow}
\newcommand{\xla}       {\xleftarrow}
\newcommand{\tf}	{\tilde{f}}
\newcommand{\half}      {{\textstyle\frac{1}{2}}}
\newcommand{\bcf}[2]{\left(\begin{array}{c}{#1}\\{#2}\end{array}\right)}
\newcommand{\ip}[1]     {\langle #1\rangle}
\newcommand{\bbm}       {\left[\begin{matrix}}
\newcommand{\ebm}       {\end{matrix}\right]}

\renewcommand{\:}{\colon}

%\input{soldefs}

\newwrite\solsfile
\immediate\openout\solsfile=solutions.tex
\makeatletter
\immediate\write\solsfile{\@percentchar\@percentchar  Autogenerated from fields.tex: do not edit}
\makeatother
\immediate\write\solsfile{}
\newcommand{\includesolutions}{
 \immediate\closeout\solsfile
 \input{solutions.tex}
}

\makeatletter

% \lastexlabel stores the label of the last exercise
\newcommand{\lastexlabel}{}

% \exlabel sets \lastexlabel and generates a LaTeX label
\ifshowkeys
\newcommand{\exlabel}[1]{
 \global\def\lastexlabel{#1}\label{#1}[\texttt{#1}]\ \\
}
\else
\newcommand{\exlabel}[1]{
 \global\def\lastexlabel{#1}\label{#1}
}
\fi

% \exref generates a link to the exercise with the specified
% label
\newcommand{\exref}[1]{Exercise~\ref*{#1}}

% An environment for a solution that is included inline.
\newenvironment{SolutionInline}{{\noindent \bf Solution:}}{}

% An environment that records a solution for inclusion in an
% appendix, and generates a link to that solution.
\newenvironment{SolutionAtEnd}
 {\ifscreen\noindent\hyperlink{sol_\lastexlabel}{Solution}%
  \fi
  \immediate\write\solsfile{}
  \immediate\write\solsfile{%
   \string\BeginDeferredSolution{\lastexlabel}{\theexercise}}
  \@bsphack
  \let\do\@makeother\dospecials\catcode`\^^M\active
  \def\verbatim@processline{%
   \immediate\write\solsfile{\the\verbatim@line}}%
 \verbatim@start}%
{\immediate\write\solsfile{\string\EndDeferredSolution}\@esphack\par\vspace{2ex}}

% An environment for a solution that has been hidden in an appendix
\newcommand{\BeginDeferredSolution}[2]{%
 \ifscreen\newpage\else\par\fi
 \def\exanchor{#1}
 \label{sol_#1}{\noindent\bf Exercise #2:}
}

\newcommand{\EndDeferredSolution}{\par\noindent\bigskip}

% An environment that hides a solution, with a promise that
% it will be revealed later.
\newenvironment{SolutionLater}
 {\noindent{\bf \ORANGE{(A solution will be given later.)}}
  \@bsphack
  \let\do\@makeother\dospecials\catcode`\^^M\active
  \def\verbatim@processline{}%
 \verbatim@start}%
{\@esphack\par\vspace{2ex}}

% An environment that makes a solution completely invisible.
\newenvironment{SolutionHidden}
 {\@bsphack
  \let\do\@makeother\dospecials\catcode`\^^M\active
  \def\verbatim@processline{}%
 \verbatim@start}%
{\@esphack\par\vspace{2ex}}

\newenvironment{solution}{\SolutionInline}{\endSolutionInline}

\newcommand{\exsolinline}[1]{\input{problems/#1}}

\newcommand{\exsolatend}[1]{
 \renewenvironment{solution}{\SolutionAtEnd}{\endSolutionAtEnd}
 \renewenvironment{background}{\BackgroundWithSolution}{\endBackgroundWithSolution}
 \input{problems/#1}
 \renewenvironment{solution}{\SolutionInline}{\endSolutionInline}
 \renewenvironment{background}{\BackgroundInline}{\endBackgroundInline}
}

\ifshowall
\newcommand{\exsollater}[1]{
 \renewenvironment{solution}{\SolutionAtEnd}{\endSolutionAtEnd}
 \renewenvironment{background}{\BackgroundWithSolution}{\endBackgroundWithSolution}
 \input{problems/#1}
 \renewenvironment{solution}{\SolutionInline}{\endSolutionInline}
 \renewenvironment{background}{\BackgroundInline}{\endBackgroundInline}
}
\else
\newcommand{\exsollater}[1]{
 \renewenvironment{solution}{\SolutionLater}{\endSolutionLater}
 \renewenvironment{background}{\BackgroundHidden}{\endBackgroundHidden}
 \input{problems/#1}
 \renewenvironment{solution}{\SolutionInline}{\endSolutionInline}
 \renewenvironment{background}{\BackgroundInline}{\endBackgroundInline}
}
\fi

\newcommand{\exsolhidden}[1]{
 \renewenvironment{solution}{\SolutionHidden}{\endSolutionHidden}
 \renewenvironment{background}{\BackgroundHidden}{\endBackgroundHidden}
 \input{problems/#1}
 \renewenvironment{solution}{\SolutionInline}{\endSolutionInline}
 \renewenvironment{background}{\BackgroundInline}{\endBackgroundInline}
}

\makeatother

\newtheorem{theorem}{Theorem}[section]
\newtheorem{conj}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
% Exercises are numbered separately
\newtheorem{exercise}{Exercise}[section]

\newtheorem{notation}{Notation}
\renewcommand{\thenotation}{} % make the notation environment unnumbered

%\numberwithin{equation}{subsection}

\renewenvironment{solution}{\SolutionAtEnd}{\endSolutionAtEnd}
%\renewenvironment{solution}{\SolutionHidden}{\endSolutionHidden}

\begin{document}
\title{Fields and Galois Theory}
\author{N.~P.~Strickland}
%\thanks{}
\address{
Department of Pure Mathematics\\
University of Sheffield\\
Sheffield S3 7RH\\
UK
}
\email{N.P.Strickland@sheffield.ac.uk}
\date{\today}


\maketitle 

\begin{center}
 This work is licensed under a 
 \href{https://creativecommons.org/licenses/by-nc-sa/3.0/deed.en}{
  Creative Commons Attribution-NonCommercial-ShareAlike license}.
 
 \bigskip

 \doclicenseImage 
\end{center}

\section{Fields: definitions and examples}
\label{sec-fields}

\begin{definition}\lbl{defn-field}
 A \emph{commutative ring} is a set $K$ together with elements
 $0,1\in K$ and a definition of what it means to add or
 multiply two elements of $K$, such that:
 \begin{enumerate}
  \item[(a)] If $a,b\in K$ then $a+b\in K$ and $ab\in K$.
  \item[(b)] The usual rules of algebra are valid.  More
   explicitly, for all $a,b,c\in K$ the following equations
   hold: 
   \begin{itemize}
    \item[(1)] $0+a=a$
    \item[(2)] $a+(b+c)=(a+b)+c$
    \item[(3)] $a+b=b+a$
    \item[(4)] $0.a=0$
    \item[(5)] $1.a=a$
    \item[(6)] $a(bc)=(ab)c$
    \item[(7)] $ab=ba$
    \item[(8)] $a(b+c)=ab+ac$
   \end{itemize}
  \item[(c)] For every $a\in K$ there is an element $-a$ with
   $a+(-a)=0$.
 \end{enumerate}
 A \emph{field} is a commutative ring that satisfies the following two
 additional axioms:
 \begin{enumerate}
  \item[(d)] For every $a\in K$ with $a\neq 0$ there is an
   element $a^{-1}\in K$ with $aa^{-1}=1$.
  \item[(e)] $1\neq 0$.
 \end{enumerate}
\end{definition}

\begin{remark}\lbl{rem-axioms}
 The field axioms are equivalent to the following:
 \begin{itemize}
  \item[(a)] The set $K$ is a commutative group under addition, with
   $0$ as the neutral element.
  \item[(b)] The set $K^\tm=K\sm\{0\}$ is a commutative group under
   multiplication, with $1$ as the neutral element.
  \item[(c)] The distributivity law $a(b+c)=ab+ac$ holds for all
   $a,b,c\in K$.
 \end{itemize}
\end{remark}

\begin{example}\lbl{eg-fields-numbers}
 Recall that 
 \begin{align*}
  \N &= \{ \text{ natural numbers } \} =
        \{ 0,1,2,3,4,\dotsc \} \\
  \Z &= \{ \text{ integers } \} =
        \{ \dotsc,-2,-1,0,1,2,3,4,\dotsc \} \\
  \Q &= \{ \text{ rational numbers } \} =
        \{ a/b\st a,b\in\Z\;,\; b\neq 0\} \\
  \R &= \{ \text{ real numbers } \} \\
  \C &= \{ \text{ complex numbers } \} = 
        \{ x+iy\st x,y\in\R \},
 \end{align*}
 so $\N\subset\Z\subset\Q\subset\R\subset\C$.  Then $\R$, $\C$ and
 $\Q$ are fields.  The set $\Z$ is a ring but not a field, because
 axiom~(d) is not satisfied: there is no element $2^{-1}$ \emph{in the
  set $\Z$} for which $2.2^{-1}=1$.  Similarly $\N$ is not a ring,
 because axiom~(c) is not satisfied: there is no element $-1$ in the
 set $\N$ with $1+(-1)=0$.
\end{example}

\begin{example}\lbl{eg-fields-rational}
 Let $K$ be any field, and let $K[x]$ denote the set of polynomials
 with coefficients in $K$.  This is a ring but not a field (because
 the nonzero element $1+x\in K[x]$ does not have an inverse in $K[x]$,
 for example).  A \emph{rational function over $K$} is an expression
 of the form $p(x)/q(x)$, where $p(x),q(x)\in K[x]$ and $q(x)\neq 0$.
 These can be manipulated in an obvious way: in particular,
 expressions $p(x)/q(x)$ and $r(x)/s(x)$ are considered to be the same
 if and only if $p(x)s(x)=r(x)q(x)$.  We write $K(x)$ for the set of
 all rational functions; this is again a field.
\end{example}

\begin{lemma}\lbl{lem-domain}
 Let $K$ be a field, and let $a$ and $b$ be nonzero elements of $K$.
 Then $ab\neq 0$.
\end{lemma}
\begin{proof}
 Suppose for a contradiction that $ab=0$.  Then we have
 \[ abb^{-1}a^{-1} = 0.b^{-1}a^{-1} = 0, \]
 but also $abb^{-1}a^{-1}=a.1.a^{-1}=aa^{-1}=1$.  This means that
 $0=1$, which contradicts axiom~(e).
\end{proof}

Next recall that $\Z/n\Z$ is the set of congruence classes modulo
$n$.  For each $a\in\Z$ we have a congruence class $\ov{a}\in\Z/n\Z$,
with $\ov{a}=\ov{b}$ if and only if $a-b$ is divisible by $n$, so 
\[ \Z/n\Z = \{\ov{0},\ov{1},\dotsc,\ov{n-1}\}. \]
There are well-defined operations of addition and multiplication,
given by $\ov{a}+\ov{b}=\ov{a+b}$ and $\ov{a}\,\ov{b}=\ov{ab}$.  
\begin{proposition}\lbl{prop-Zn-field}
 The set $\Z/n\Z$ is always a commutative ring (under the operations
 mentioned above).  It is a field if and only if $n$ is prime.
\end{proposition}
\begin{proof}
 The commutative ring axioms for $\Z/n\Z$ follow directly from those
 for $\Z$.  Next, note that 
 \begin{align*}
  & \text{ $\ov{a}$ has an inverse in $\Z/n\Z$} \\
  \iffa & \text{ There exists $\ov{b}\in\Z/n\Z$ with
   $\ov{a}\,\ov{b}=\ov{1}$} \\
  \iffa & \text{ There exists $b\in\Z$ with $ab=1\pmod{n}$} \\
  \iffa & \text{ There exists $b,c\in\Z$ with $ab+nc=1$} \\
  \iffa & \text{ $a$ and $n$ are coprime}.
 \end{align*}
 On the other hand, $\ov{a}$ is nonzero in $\Z/n\Z$ if and only if $a$
 is not divisible by $n$.  If $n$ is prime then any number that is
 not divisible by $n$ is coprime to $n$, so whenever $\ov{a}$ is
 nonzero, it is invertible.  This shows that $\Z/n\Z$ is a field.  On
 the other hand, if $n$ is not prime then we can write $n=ab$ for some
 integers $a,b>1$.  We find that $a$ is not divisible by $n$ but it is
 also not coprime with $n$, so $\ov{a}$ is a nonzero element of
 $\Z/n\Z$ that is not invertible, so $\Z/n\Z$ is not a field.
\end{proof}
\begin{remark}\lbl{rem-Z-pid}
 Here we have used various standard facts about divisibility and
 factorisation of integers.  We will not review these facts in detail
 or prove them, but we will remark that the proofs are similar to
 those for divisibility and factoriasation of polynomials, which are
 covered in Section~\ref{sec-poly}.
\end{remark}

\begin{definition}\lbl{defn-Fp}
 If $p$ is prime we write $\F_p$ as another notation for $\Z/p\Z$.  We
 will omit the bars on elements of $\F_p$ unless necessary for
 emphasis.  For example, the elements of $\F_5$ will usually be called
 $0,1,2,3,4$ rather than $\ov{0},\ov{1},\ov{2},\ov{3},\ov{4}$.
\end{definition}

The ideas in Proposition~\ref{prop-Zn-field} can be generalised
slightly as follows.

\begin{definition}\lbl{defn-char}
 Let $K$ be a field.  For any integer $n\geq 0$ we write $n.1$ for the
 sum $1+\dotsb+1\in K$ (with $n$ terms).  If for all $n>0$ we have
 $n.1\neq 0$ in $K$, we say that $K$ has \emph{characteristic zero}.
 Otherwise, the \emph{characteristic} of $K$ is the smallest $n>0$
 such that $n.1=0$ in $K$.
\end{definition}

\begin{proposition}\lbl{prop-char}
 Let $K$ be a field.  Then the characteristic of $K$ is either zero or
 a prime number.
\end{proposition}
\begin{proof}
 If $K$ has characteristic zero then there is nothing more to say, so
 we may assume that $K$ has characteristic $p>0$.  If $p$ is not prime
 then we can write $p=nm$ for some $n,m$ with $1<n,m<p$.  Put $a=n.1$
 and $b=m.1$.  By definition $p$ is the smallest positive integer with
 $p.1=0$, so we have $a\neq 0$ and $b\neq 0$.  It follows by
 Lemma~\ref{lem-domain} that $ab\neq 0$, but $ab=p.1=0$ so this is a
 contradiction.  It follows that $p$ must be prime after all.
\end{proof}

\begin{example}\lbl{eg-F-four}
 Let $\F_4$ denote the following set of matrices over $\F_2$:
 \[ \F_4 = \left\{ 
     \bsm 0&0\\ 0&0 \esm,
     \bsm 1&0\\ 0&1 \esm,
     \bsm 0&1\\ 1&1 \esm, 
     \bsm 1&1\\ 1&0 \esm
    \right\}. 
 \]
 We will allow ourselves to write $0$ for the zero matrix
 $\bsm 0&0\\ 0&0\esm$ and $1$ for the identity matrix
 $\bsm 1&0\\ 0&1\esm$.  We also write $\al=\bsm 0&1\\1&1\esm$.  Note
 that $\al^2=\bsm 1&1\\ 1&2\esm$, which is the same as
 $\bsm 1&1\\1&0\esm$ because we are working with matrices over
 $\F_2$.  We thus have $\F_4=\{0,1,\al,\al^2\}$.  One can check that
 $\al^3=1$ and thus $\al^4=\al$, and also that $1+\al+\al^2=0$.  From
 this it follows that $\F_4$ is closed under the operations of
 addition and multiplication, which can be tabulated as follows:
 \[ \renewcommand{\arraystretch}{1.5}
   \begin{array}{|c||c|c|c|c|}
    \hline
     + & 0 & 1 & \al & \al^2 \\ \hline
     0 & 0 & 1 & \al & \al^2 \\ \hline
     1 & 1 & 0 & \al^2 & \al \\ \hline
     \al & \al & \al^2 & 0 & 1 \\ \hline
     \al^2 & \al^2 & \al & 1 & 0 \\ \hline
   \end{array}
   \hspace{2em}
   \begin{array}{|c||c|c|c|c|}
    \hline
     \cdot & 0 & 1 & \al & \al^2 \\ \hline
     0 & 0 & 0 & 0 & 0 \\ \hline
     1 & 0 & 1 & \al & \al^2 \\ \hline
     \al & 0 & \al & \al^2 & 1 \\ \hline
     \al^2 & 0 & \al^2 & 1 & \al \\ \hline
   \end{array}
 \]
 From this we read off that every nonzero element of $\F_4$ has an
 inverse, namely $1^{-1}=1$ and $\al^{-1}=\al^2$ and
 $(\al^2)^{-1}=\al$.  This means that $\F_4$ is a field.
\end{example} 

\begin{remark}\lbl{rem-F-q}
 Let $p$ be a prime and $n$ a positive integer.  We will see in
 Section~\ref{sec-finite-fields} that there is an an essentially
 unique finite field with precisely $p^n$ different elements; this
 will be called $\F_{p^n}$.  Example~\ref{eg-F-four} is of course the
 case where $p=n=2$ so $p^n=4$.
\end{remark}


\begin{definition}\lbl{defn-subfield}
 Let $L$ be a field, and let $K$ be a subset of $L$.  We say that $K$
 is a \emph{subfield} of $L$ if 
 \begin{itemize}
  \item[(a)] $0$ and $1$ are elements of $K$.
  \item[(b)] If $a,b\in K$ then $a+b\in K$ and $-a\in K$ and
   $ab\in K$.
  \item[(c)] If $a\in K$ and $a\neq 0$ (so that there exists an
   inverse $a^{-1}\in L$) then $a^{-1}\in K$.
 \end{itemize}
 If this holds, it is clear that $K$ is itself a field.  We also say
 that $L$ is an \emph{extension} of $K$.
\end{definition}

\begin{example}\lbl{eg-QRC}
 $\Q$ is a subfield of $\R$, which is a subfield of $\C$, which is a
 subfield of $\C(x)$.
\end{example}

We next want to discuss the first of several examples involving square
roots of primes.  This relies on the basic fact that such square roots
are always irrational: we pause to recall the proof.
\begin{lemma}\lbl{lem-root-p}
 If $p$ is prime then $\sqrt{p}\not\in\Q$.
\end{lemma}
\begin{proof}
 Suppose for a contradiction that $\sqrt{p}$ is rational.  We can then
 write $\sqrt{p}$ in the form $a/b$, where $a$ and $b$ are integers
 with $b>0$ such that $a$ and $b$ are coprime.  We then have
 $(a/b)^2=p$ in $\Q$, so $a^2=pb^2$ in $\Z$.  This shows that $p$
 divides $a^2$, so $p$ must divide $a$, say $a=pc$.  This gives
 $p^2c^2=pb^2$, so $b^2=pc^2$.  This shows that $b^2$ is divisible by
 $p$, so $b$ is divisible by $p$.  Thus $a$ and $b$ have $p$ as a
 common factor contradicting the assumption that $a$ and $b$ are
 coprime. 
\end{proof}

\begin{proposition}\label{prop-Qp-R}
 Let $p$ be any prime.  Then the set
 \[ \Q(\sqrt{p}) = \{a+b\sqrt{p}\st a,b\in\Q\} \]
 is a subfield of $\R$.  
\end{proposition}
\begin{proof}
 We can write $0$ as $0+0\sqrt{p}$, and $1$ as $1+0\sqrt{p}$, so $0$
 and $1$ are elements of $\Q(\sqrt{p})$.  Now suppose we have two
 elements $u,v\in\Q(\sqrt{p})$, say $u=a+b\sqrt{p}$ and
 $v=c+d\sqrt{p}$ with $a,b,c,d\in\Q$.  We find that
 \begin{align*}
  u+v &= (a+c)+(b+d)\sqrt{p} \\
  uv &= (ac+bdp) + (ad+bc)\sqrt{p}
 \end{align*}
 with $a+c,b+d,ac+bdp,ad+bc\in\Q$, so $u+v,uv\in\Q(\sqrt{p})$.  Next,
 suppose that $u\neq 0$; we must show that $1/u\in\Q(\sqrt{p})$.
 There are two cases to consider, depending on whether $b=0$ or not.  
 If $b=0$ then $u$ is a nonzero rational number so $1/u$ is again a
 nonzero rational number, so $1/u\in\Q(\sqrt{p})$.  If $b\neq 0$ we
 note that $a/b$ cannot be $\pm\sqrt{p}$ (because $\sqrt{p}$ is
 irrational) so $(a/b)^2-p\neq 0$, so $a^2-pb^2\neq 0$.  It is
 therefore admissible to define
 \[ w = \frac{a-b\sqrt{p}}{a^2-pb^2} = 
      \left(\frac{a}{a^2-pb^2}\right) + 
      \left(\frac{-b}{a^2-pb^2}\right)\sqrt{p} \in\Q(\sqrt{p}).
 \]
 If we just expand out $uw$ we get $1$, so $w=u^{-1}$, so
 $u^{-1}\in\Q(\sqrt{p})$ as required.
\end{proof}
\begin{remark}\lbl{rem-not-square}
 Here and later in these notes we will mostly focus on the case where
 $p$ is prime.  However, many of the things that we will prove for
 $\Q(\sqrt{p})$ are also true for $\Q(\sqrt{d})$ whenever $d$ is an
 integer that is not the square of another integer. 
\end{remark}

\begin{proposition}\lbl{prop-subfield-meet}
 Let $K$ and $L$ be subfields of a field $M$.  Then $K\cap L$ is also
 a subfield of $M$.
\end{proposition}
\begin{proof}
 As $K$ is a subfield we have $0,1\in K$, and as $L$ is a subfield we
 have $0,1\in L$; it follows that $0,1\in K\cap L$.

 Now suppose that $a,b\in K\cap L$.  As $a,b\in K$ and $K$ is a
 subfield we have $a+b,a-b,ab\in K$.  As $a,b\in L$ and $L$ is a
 subfield we have $a+b,a-b,ab\in L$.  It follows that
 $a+b,a-b,ab\in K\cap L$, so we see that $K\cap L$ is a subring of
 $M$.  Now suppose that $a\in K\cap L$ and $a\neq 0$. 
 As $a\in K\sm\{0\}$ and $K$ is a subfield, we see that $a^{-1}\in K$.
 As $a\in L\sm\{0\}$ and $L$ is a subfield, we see that $a^{-1}\in L$.
 It follows that $a^{-1}\in K\cap L$, so we see that $K\cap L$ is a
 subfield as claimed.
\end{proof}

\begin{definition}\lbl{defn-field-hom}
 Let $R$ and $S$ be commutative rings.  A \emph{ring homomorphism}
 from $R$ to $S$ is a function $\phi\:R\to S$ satisfying
 \begin{itemize}
  \item $\phi(0)=0$ and $\phi(1)=1$.
  \item For all $a,b\in R$ we have $\phi(a+b)=\phi(a)+\phi(b)$ and
   $\phi(ab)=\phi(a)\phi(b)$ in $S$. 
 \end{itemize}
 We say that $\phi$ is an \emph{isomorphism} if there is another
 homomorphism $\psi=\phi^{-1}\:S\to R$ with $\psi(\phi(a))=a$ for all
 $a\in R$, and $\phi(\psi(b))=b$ for all $b\in S$.  An isomorphism
 from $R$ to itself is called an \emph{automorphism}.
\end{definition}

It will turn out that automorphisms of fields are of central
importance in Galois theory.  We therefore take some time to exhibit a
number of examples.

\begin{example}\lbl{eg-conjugation}
 We can define an automorphism $\phi\:\C\to\C$ by $\phi(z)=\ov{z}$, or
 in other words $\phi(x+iy)=x-iy$ for all $x,y\in\R$.
\end{example}

\begin{example}\lbl{eg-quadratic-auto}
 We claim that there is an automorphism $\phi$ of $\Q(\sqrt{p})$ given
 by $\phi(a+b\sqrt{p})=a-b\sqrt{p}$ (for $a,b\in\Q$).  Indeed, it is
 clear that this formula defines a $\Q$-linear map from $\Q(\sqrt{p})$
 to itself, which satisfies $\phi(0)=0$ and $\phi(1)=1$.  Suppose we
 have elements $u=a+b\sqrt{p}$ and $v=c+d\sqrt{p}$, with
 $a,b,c,d\in\Q$.  We then have
 \begin{align*}
  uv &= (ac+bdp)+(ad+bc)\sqrt{p} \\
  \phi(uv) &= \phi((ac+bdp)+(ad+bc)\sqrt{p}) =
  (ac+bdp)-(ad+bc)\sqrt{p} \\
  \phi(u)\phi(v) &= (a-b\sqrt{p})(c-d\sqrt{p})
   = (ac+bdp)-(ad+bc)\sqrt{p} 
 \end{align*}
 so $\phi(uv)=\phi(u)\phi(v)$.  This shows that $\phi$ is a
 homomorphism of fields.  It is also clear that 
 \[ \phi(\phi(a+b\sqrt{p}))=\phi(a-b\sqrt{p})=a+b\sqrt{p}, \]
 so $\phi$ is an inverse for itself, so $\phi$ is an automorphism.
\end{example}

\begin{example}\lbl{eg-mobius-aut}
 We can define an automorphism $\tau\:\C(x)\to\C(x)$ by
 $\tau(r(x))=r(x+1)$, so for example
 \[ \tau\left(\frac{x^2+1}{x^3-1}\right) =
      \frac{(x+1)^2+1}{(x+1)^3-1} =
      \frac{x^2+2x+2}{x^3+3x^2+3x}.
 \] 
 More generally, given any $a,b,c,d\in\C$ with $ad-bc\neq 0$ we can
 define an automorphism $\tht$ of $\C(x)$ by 
 \[ \tht(r(x)) = r\left(\frac{ax+b}{cx+d}\right). \]
 It can be shown that this construction gives all the automorphisms of
 $\C(x)$ that act as the identity on $\C$.  Thus, the group of such
 automorphisms is the same as the group of M\"obius transformations. 
\end{example}

\begin{example}\lbl{eg-generic-quintic-i}
 Consider the quintic $f(x)=x^5-6x+3$.  This has five roots in $\C$,
 approximately as follows:
 \begin{align*}
  \al_1 &= -1.670935264 \\
  \al_2 &= -0.1181039226 - 1.587459162 i \\
  \al_3 &= -0.1181039226 + 1.587459162 i \\
  \al_4 &= 0.5055012304 \\
  \al_5 &= 1.401641879.
 \end{align*}
 Let $K$ be the subfield of $\C$ generated by these roots.  It turns
 out that the automorphisms of $K$ are essentially the same as the
 permutations of $\{1,2,\dotsc,5\}$.  For example, corresponding to
 the transposition $(4\; 5)$ there is a unique automorphism $\phi$
 with $\phi(\al_4)=\al_5$ and $\phi(\al_5)=\al_4$ and
 $\phi(\al_k)=\al_k$ for $k=1,2,3$.  Moreover, most (but not all)
 other quintics behave in essentially the same way.  All this will be
 explained with proofs in Example~\ref{eg-generic-quintic}.
\end{example}

%%% End of Lecture 1

\begin{example}\lbl{eg-cyclotomic-i}
 Fix an integer $n>1$, put $\zt=e^{2\pi i/n}\in\C$, and let $K$ be the
 subfield of $\C$ generated by $\zt$.  We will see in
 Section~\ref{sec-cyclotomic} that whenever $k$ is coprime to $n$
 there is a unique automorphism $\phi_k$ of $K$ that satisfies
 $\phi_k(\zt)=\zt^k$.  Using this we will see that the group of
 automorphisms of $K$ is isomorphic to the group of invertible
 elements in the ring $\Z/n\Z$.
\end{example}

\begin{proposition}\lbl{prop-aut-Q}
 The only automorphism of $\Q$ is the identity, and the only
 automorphism of $\R$ is the identity.
\end{proposition}
\begin{proof}
 Let $\phi$ be an automorphism of $\Q$.  By definition we have
 $\phi(0)=0$ and $\phi(1)=1$.  If $\phi(n)=n$ for some $n\in\N$ then 
 \[ \phi(n+1) = \phi(n)+\phi(1) = n+1. \]
 It follows by induction that $\phi(n)=n$ for all $n\in\N$.  We also
 have $n+\phi(-n)=\phi(n)+\phi(-n)=\phi(n+(-n))=\phi(0)=0$, which can
 be rearranged to give $\phi(-n)=-\phi(n)$.  This shows that
 $\phi(a)=a$ for all $a\in\Z$.  Next, an arbitrary rational number $q$
 can be written as $q=a/b$ with $a,b\in\Z$ and $b>0$.  This gives
 $qb=a$ so $\phi(q)\phi(b)=\phi(qb)=\phi(a)$, but $a,b\in\Z$ so
 $\phi(a)=a$ and $\phi(b)=b$, so $\phi(q)b=a$.  This rearranges to
 give $\phi(q)=a/b=q$, so $\phi$ is the identity as claimed.

 Now instead let $\phi$ be an automorphism of $\R$.  Just as before,
 we see that $\phi(q)=q$ for all $q\in\Q$.  Next, we claim that if
 $a\leq b$ then $\phi(a)\leq\phi(b)$.  Indeed, if $a\leq b$ then
 $b-a\geq 0$ so $b-a=t^2$ for some $t\in\R$, or equivalently
 $a+t^2=b$.  We can apply $\phi$ to get $\phi(a)+\phi(t)^2=\phi(b)$,
 and all squares are nonnegative so $\phi(a)\leq\phi(b)$.  Now let $r$
 be an arbitrary real number.  For any $\ep>0$ we can choose rational
 numbers $q_1$ and $q_2$ such that $q_1\leq r\leq q_2$ with
 $q_2-q_1<\ep$.  We can then apply $\phi$, recalling that $\phi$
 preserves order and acts as the identity on rational numbers.  That
 gives $q_1\leq\phi(r)\leq q_2$, which implies that
 $|r-\phi(r)|<\ep$.  This holds for all $\ep>0$, so we must actually
 have $\phi(r)=r$ as claimed.
\end{proof}

\begin{proposition}\lbl{prop-Hom-C-R}
 There are no homomorphisms from $\C$ to $\R$.
\end{proposition}
\begin{proof}
 Suppose we had a homomorphism $\phi\:\C\to\R$.  Put
 $a=\phi(i)\in\R$.  We could then apply $\phi$ to the equation
 $i^2+1=0$ to get $a^2+1=0$.  This is clearly not possible for a real
 number $a$, so there cannot be any such homomorphism $\phi$.
\end{proof}

For the next result we recall the following definitions, which should
hopefully be very familiar:
\begin{definition}\lbl{defn-jective}
 Let $X$ and $Y$ be sets, and let $\phi$ be any function from $X$ to
 $Y$. 
 \begin{itemize}
  \item[(a)] We say that $\phi$ is \emph{injective} for whenever
   $x,x'\in X$ and $\phi(x)=\phi(x')$, we have $x=x'$.
  \item[(b)] We say that $\phi$ is \emph{surjective} if for every
   element $y\in Y$, there is an element $x\in X$ with $\phi(x)=y$.
  \item[(c)] We say that $\phi$ is \emph{bijective} if it is both
   injective and surjective.
 \end{itemize}
\end{definition}
\begin{remark}\lbl{rem-bijective}
 It is standard that $\phi$ is bijective if and only if there is an
 inverse map $\psi=\phi^{-1}\:Y\to X$ with $\psi(\phi(x))=x$ for all
 $x\in X$, and $\phi(\psi(y))=y$ for all $y\in Y$.
\end{remark}

\begin{proposition}\lbl{prop-hom-inj}
 Let $\phi\:K\to L$ be a field homomorphism.
 \begin{itemize}
  \item[(a)] If $a\in K^\tm=K\sm\{0\}$, then $\phi(a)\in L^\tm$ and
   $\phi(a^{-1})=\phi(a)^{-1}$.
  \item[(b)] The map $\phi$ is injective, and the image $\phi(K)$ is a
   subfield of $L$. 
 \end{itemize}
\end{proposition}
\begin{proof}
 If $a\in K$ is nonzero then we can find an inverse element
 $a^{-1}\in K$ and we have
 \[ \phi(a).\phi(a^{-1}) = \phi(aa^{-1}) = \phi(1) = 1. \]
 It follows from this that $\phi(a)$ must be nonzero, and
 $\phi(a^{-1})=\phi(a)^{-1}$ as claimed.  

 Now suppose we have elements $a,b\in K$ with $a\neq b$.  This means
 that $a-b\neq 0$, so by the above we have $\phi(a-b)\neq 0$, but
 $\phi(a-b)=\phi(a)-\phi(b)$, so we conclude that
 $\phi(a)\neq\phi(b)$.  This proves that $\phi$ is injective.

 Next, we have $\phi(0_K)=0_L$ and $\phi(1_K)=1_L$, so $0_L$ and $1_L$
 are in the image of $\phi$.  If $u$ and $v$ are in the image of
 $\phi$ then we have $u=\phi(a)$ and $v=\phi(b)$ for some $a,b\in K$,
 so $u\pm v=\phi(a\pm b)$ and $uv=\phi(ab)$.  This shows that the
 image of $\phi$ is closed under addition, subtraction and
 multiplication, so it is a subring of $L$.  Now suppose that
 $u=\phi(a)$ again, and that $u\neq 0$.  It follows that $a$ must be
 nonzero, and as at the beginning of this proof we see that
 $\phi(a^{-1})$ is an inverse for $u$ lying in the image of $\phi$.
 This completes the proof that the image is a subfield.
\end{proof}

\begin{remark}\lbl{rem-hom-inj}
 If we are studying a problem that involves only one homomorphism
 $\phi\:K\to L$, we will often identify $K$ with $\phi(K)$ and thus
 consider $K$ itself as a subfield of $L$.  This generally leads to
 more concise and convenient notation.  However, this convention can
 lead to confusion in cases where we need to consider more than one
 homomorphism from $K$ to $L$, so we will not adopt it everywhere.
\end{remark}

\begin{proposition}\lbl{prop-fixed-subfield}
 Let $H$ be a set of homomorphisms $L\to L$, and put 
 \[ L^H=\{a\in L\st \phi(a)=a \text{ for all } \phi\in H\}. \]
 Then $L^H$ is a subfield of $L$.
\end{proposition}
\begin{proof}
 For any homomorphism $\phi$, we have $\phi(0)=0$ and $\phi(1)=1$.  It
 follows that $0,1\in L^H$.  Next, suppose we have $a,b\in L^H$, and
 consider $\phi\in H$.  As $\phi$ is a homomorphism, we have
 $\phi(a\pm b)=\phi(a)\pm \phi(b)$.  As $a,b\in L^H$ we also have
 $\phi(a)=a$ and $\phi(b)=b$, so $\phi(a\pm b)=a\pm b$.  This holds
 for all $\phi\in H$, so we conclude that $a\pm b\in L^H$.
 Essentially the same argument shows that $ab\in L^H$.  Also, if
 $a\neq 0$ we see (from Proposition~\ref{prop-hom-inj}(a)) that
 $\phi(a^{-1})=\phi(a)^{-1}=a^{-1}$ for all $\phi\in H$, so
 $a^{-1}\in L^H$.  This shows that $L^H$ is a subfield.
\end{proof}

\begin{proposition}\lbl{prop-hom-char}\ \\
 \begin{itemize}
  \item[(a)] Suppose that there exists a homomorphism $\phi\:K\to L$.
   Then $K$ and $L$ have the same characteristic.
  \item[(b)] Suppose that $K$ has characteristic zero.  Then there is
   a unique homomorphism $\phi\:\Q\to K$.
  \item[(c)] Suppose instead that $K$ has characteristic $p>0$.  Then
   there is a unique homomorphism $\phi\:\F_p\to K$.
 \end{itemize}
\end{proposition}
\begin{proof}\ \\
 \begin{itemize}
  \item[(a)] Put $I=\{n\in\Z\st n.1_K=0\}$ and
   $J=\{n\in\Z\st n.1_L=0\}$.  As $I$ determines the characteristic of
   $K$, and $J$ determines the characteristic of $L$, it will suffice
   to show that $I=J$.  As $\phi$ is a homomorphism we have
   $\phi(1_K)=1_L$ and so $\phi(n.1_K)=n.1_L$.  In particular, if
   $n\in I$ then $n.1_L=\phi(n.1_K)=\phi(0)=0$ and so $n\in J$; thus
   $I\leq J$.  Conversely, if $n\in J$ then $\phi(n.1_K)=n.1_L=0$, but
   $\phi$ is injective by Proposition~\ref{prop-hom-inj}, so
   $n.1_K=0$, so $n\in I$.  This shows that $J\leq I$ and so $I=J$ as
   required.
  \item[(b)] This is related to proposition~\ref{prop-aut-Q}.  Suppose
   that $K$ has characteristic zero.  We can certainly define
   $\phi_0\:\N\to K$ by $\phi_0(n)=1+\dotsb+1$ (with $n$ terms).  We can
   then extend this over $\Z$ by $\phi_0(-n)=-\phi_0(n)$, and one can
   check that the resulting map $\phi_0\:\Z\to K$ is a homomorphism.  As
   $K$ has characteristic zero, we know that $\phi_0(b)$ is invertible
   for all positive integers $b$.  Any rational number $x\in\Q$ can be
   written as $x=a/b$ for some $a,b\in\Z$ with $b>0$.  We then put
   $\phi(x)=\phi_0(a)\phi_0(b)^{-1}$.  This is well-defined, because if
   $x$ is also $c/d$ then $ad=bc$ in $\Z$, and $\phi_0\:\Z\to K$ is a
   homomorphism, so $\phi_0(a)\phi_0(d)=\phi_0(b)\phi_0(c)$, so
   $\phi_0(a)\phi_0(b)^{-1}=\phi_0(c)\phi_0(d)^{-1}$.  We leave it to the
   reader to check that this gives a homomorphism $\phi\:\Q\to K$, and
   that it is the unique such homomorphism.
  \item[(c)] Now suppose instead that $K$ has characteristic $p>0$.
   We again have a unique homomorphism $\phi_0\:\Z\to K$.  By
   assumption we have $\phi_0(p)=0$, but $\phi_0(k)\neq 0$ for
   $0<k<p$.  We would like to define $\phi\:\F_p\to K$ by
   $\phi(\ov{n})=\phi_0(n)$.  To check that this is well-defined, we
   must show that $\phi_0(n)=\phi_0(m)$ whenever $\ov{n}=\ov{m}$.  If
   $\ov{n}=\ov{m}$ then we must have $n=m+kp$ for some $k\in\Z$ so
   $\phi_0(n)=\phi_0(m)+\phi_0(k)\phi_0(p)=\phi_0(m)+\phi_0(k).0=\phi_0(m)$
   as required.  This gives a function $\phi\:\F_p\to K$, and one can
   easily check that it is a homomorphism, and indeed that it is the
   only homomorphism. 
 \end{itemize}
\end{proof}

%%% End of Lecture 2

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-which-fields}
 Which of the following sets (with the usual definition of addition
 and multiplication) are fields?
 \begin{align*}
  K_0 &= \{x\in\R\st x\geq 0\} \\
  K_1 &= \{a+b\sqrt{2}\st a,b\in\Z\} \\
  K_2 &= \{a+b\sqrt{2}\st a,b\in\Q\} \\
  K_3 &= \{a+b\sqrt{2}\st a,b\in\R\} \\
  K_4 &= \{a+b.2^{1/3}\st a,b\in\Q\} \\
  K_5 &= \Q\tm\R = \{(a,b)\st a\in\Q \text{ and } b\in\R\} \\
  K_6 &= \Z/6\Z \\
  K_7 &= \Z/7\Z
 \end{align*}
\end{exercise}
\begin{solution}
 The set $K_0$ is not a field, because the element $1\in K_0$ has no
 additive inverse in $K_0$.  The set $K_1$ is a commutative ring but
 not a field, because the nonzero element $2\in K_1$ has no
 multiplicative inverse in $K_1$.  

 The set $K_2$ (otherwise known as
 $\Q(\sqrt{2})$) is a field.  Indeed, it is clearly closed under
 addition and contains $0$ and $1$.  It is also closed under
 multiplication because for all $a,b,c,d\in\Q$ we have 
 \[ (a+b\sqrt{2})(c+d\sqrt{2})=(ac+2bd)+(ad+bc)\sqrt{2} \]
 (and $ac+2bd,ad+bc\in\Q$).  Finally, any nonzero element
 $x\in\Q(\sqrt{2})$ has the form $x=a+b\sqrt{2}$ where at least one of
 $a$ and $b$ are nonzero.  A standard lemma tells us that $\sqrt{2}$
 is irrational, and thus that $a^2-2b^2$ cannot be zero.  It follows
 that the expression $y=(a-b\sqrt{2})/(a^2-2b^2)$ gives a well-defined
 element of $K_2$, and one checks directly that $xy=1$, so $y$ is a
 multiplicative inverse for $x$.  This proves that $K_2$ is a subfield
 of $\C$.  

 Next, $K_3$ is just equal to $\R$, so it is a field.  The set $K_4$
 contains the element $\al=2^{1/3}$ but it does not contain $\al^2$,
 so it is not closed under multiplication, so it is not a field (or
 even a ring).  The set $K_4$ is a commutative ring, with the pair
 $(1,1)$ as the multiplicative identity.  However, it is not a field.
 Indeed, the element $e=(1,0)$ is nonzero but for any $(a,b)\in K_4$
 we have $e.(a,b)=(a,0)\neq(1,1)$; this shows that $e$ has no
 multiplicative inverse.  The set $K_6=\Z/6\Z$ is a commutative ring
 but not a field, because the nonzero element $\ov{2}$ has no
 inverse, as we see from the multiplication table modulo $6$:
 \[ \renewcommand{\arraystretch}{1.5}
   \begin{array}{|c||c|c|c|c|c|c|}
    \hline
     \cdot & 0 & 1 & 2 & 3 & 4 & 5 \\ \hline
     0     & 0 & 0 & 0 & 0 & 0 & 0 \\ \hline
     1     & 0 & 1 & 2 & 3 & 4 & 5 \\ \hline
     2     & 0 & 2 & 4 & 0 & 2 & 4 \\ \hline
     3     & 0 & 3 & 0 & 3 & 0 & 3 \\ \hline
     4     & 0 & 4 & 2 & 0 & 4 & 2 \\ \hline
     5     & 0 & 5 & 4 & 3 & 2 & 1 \\ \hline
   \end{array}
 \]
 On the other hand, the ring $\Z/7Z$ is a field.  Indeed, we have 
 \[ 1^2 = 2\tm 4 = 3 \tm 5 = 6^2 = 1 \pmod{7}, \]
 so in $\Z/7\Z$ we have 
 \[ 1^{-1} = 1 \qquad
    2^{-1} = 4 \qquad
    3^{-1} = 5 \qquad
    4^{-1} = 2 \qquad
    5^{-1} = 3 \qquad
    6^{-1} = 6,
 \]
 so every nonzero element has an inverse.  (The real reason for the
 difference between $K_6$ and $K_7$ is that $7$ is prime and $6$ is
 not.) 
\end{solution}
\begin{exercise}\exlabel{ex-Ri-field}
 For any ring $R$ we can construct a new ring $R[i]$ of ``complex
 numbers over $R$'': the elements are expressions $a+bi$ with
 $a,b\in R$, and the multiplication rule is 
 \[ (a+bi)(c+di) = (ac-bd)+(ad+bc)i, \]
 so that $i^2=-1$.  Prove that $\F_3[i]$ is a field, but $\F_2[i]$ and
 $\F_5[i]$ are not.
\end{exercise}
\begin{solution}
 We have $\F_2[i]=\{0,1,i,1+i\}$ and one can check directly that none
 of these elements is an inverse for $1+i$, so $\F_2[i]$ is not a
 field.  Alternatively $(1+i)^2=2i=0$ which would contradict
 Lemma~\ref{lem-domain} if $\F_2[i]$ were a field.

 Similarly, in $\F_5[i]$ we find that $2+i$ and $2-i$ are nonzero but
 $(2+i)(2-i)=5=0$, so again $\F_5[i]$ is not a field.

 Now consider $\F_3[i]$, and put $\al=1+i$.  We find that 
 \begin{align*}
  \al^0 &= 1 & \al^1 &= 1+i \\
  \al^2 &= -i & \al^3 &= 1-i \\
  \al^4 &= -1 & \al^5 &= -1-i \\
  \al^6 &= i & \al^7 &= -1+i \\
  \al^8 &= 1.
 \end{align*}
 From this we see that every nonzero element of $\F_3[i]$ is $\al^k$
 for some $k\in\{0,\dotsc,7\}$, and that this has inverse
 $\al^{8-k}$.  This shows that $\F_3[i]$ is a field.
\end{solution}
\begin{exercise}\exlabel{ex-Qp-subfields}
 Show that the only subfields of $\Q(\sqrt{p})$ are $\Q$ and
 $\Q(\sqrt{p})$.  
\end{exercise}
\begin{solution}
 Let $K$ be a subfield of $\Q(\sqrt{p})$.  This contains $1$ and is
 closed under addition and subtraction, so it must contain $\Z$.  For
 integers $b>0$ we then deduce that $b^{-1}\in K$, and so $a/b\in K$
 for all $a\in\Z$; this shows that $K$ contains $\Q$.  Suppose that
 $K$ is not equal to $\Q$; then $K$ must contain some element
 $\al=u+v\sqrt{p}$ with $u,v\in\Q$ and $v\neq 0$.  As $u\in\Q\sse K$
 and $\al\in K$ we see that the number $v\sqrt{p}=\al-u$ is also in
 $K$.  Similarly, we have $v^{-1}\in K$ and so
 $\sqrt{p}=v^{-1}.(v\sqrt{p})\in K$.  Finally, let $x$ and $y$ be
 arbitrary rational numbers; then $x,y,\sqrt{p}\in K$, so
 $x+y\sqrt{p}\in K$.  This proves that $K$ is all of $\Q(\sqrt{p})$,
 as required.
\end{solution}
\begin{exercise}\exlabel{ex-nth-root-aut}
 Let $n$ be an odd prime, and $a\in\Q$.  Show that there are no
 non-trivial automorphisms of $\Q(a^{1/n})$.
\end{exercise}
\begin{solution}
 Put $\al=a^{1/n}$, so the field in question is $K=\Q(\al)\sse\R$.
 Let $\sg\:K\to K$ be an automorphism, and put
 $\zt=\sg(\al)/\al\in K\sse\R$.  We can apply $\sg$ to the equation
 $\al^n=a$ to get $\sg(\al)^n=a$, and then divide by the original
 equation to get $\zt^n=1$.  As $\zt$ is real and $n$ is odd, we see
 that $\zt$ has the same sign as $\zt^n$, but $\zt^n=1>0$, so
 $\zt>0$.  We also have $(\zt-1)(1+\zt+\dotsb+\zt^{n-1})=\zt^n-1=0$,
 but all terms in the sum $1+\zt+\dotsb+\zt^{n-1}$ are strictly
 positive, so $\zt=1$.  This means that $\sg(\al)=\al$, so $\sg$ acts
 as the identity on $\Q(\al)=K$.
\end{solution}
\begin{exercise}\exlabel{ex-aut-F-four}
 Consider the field $\F_4$ from Example~\ref{eg-F-four}.  This has
 precisely one automorphism that is not the identity; what is it?
\end{exercise}
\begin{solution}
 We have $\F_4=\{0,1,\al,\al^2\}$ with $\al^2=\al^{-1}=1+\al$.  Any
 automorphism $\phi\:\F_4\to\F_4$ must be a bijection and must satisfy
 $\phi(0)=0$ and $\phi(1)=1$, so either 
 \begin{itemize}
  \item[(a)] $\phi(\al)=\al$ and $\phi(\al^2)=\al^2$; or
  \item[(b)] $\phi(\al)=\al^2$ and $\phi(\al^2)=\al$.
 \end{itemize}
 In case~(a) we see that $\phi$ is the identity.  All that is left
 is to check that case~(b) really does define an automorphism, or
 equivalently that $\phi(x+y)=\phi(x)+\phi(y)$ and
 $\phi(xy)=\phi(x)\phi(y)$ for all $x,y\in\F_4$.  One way to do this
 would be to just work through the sixteen possible pairs $(x,y)$.
 More efficiently, we can note that $\phi(x)=x^2$ for all $x\in\F_4$.
 (This is clear for $x=0$ or $x=1$ or $x=\al$; for the case $x=\al^2$
 we recall that $\al^3=1$ so
 $(\al^2)^2=\al^4=\al^3.\al=\al=\phi(\al^2)$.)  Given this, it is
 clear that $\phi(xy)=x^2y^2=\phi(x)\phi(y)$ for all $x$ and $y$.  We
 also have $\phi(x+y)=(x+y)^2=x^2+y^2+2xy=\phi(x)+\phi(y)+2xy$, but we
 are working in characteristic two so $2xy=0$ and so
 $\phi(x+y)=\phi(x)+\phi(y)$ as required.
\end{solution}
\begin{exercise}\exlabel{ex-equaliser}
 Let $L$ and $M$ be fields, and suppose we have two homomorphisms
 $\phi,\psi\:L\to M$.  Show that the set
 $K=\{a\in L\st\phi(a)=\psi(a)\}$ is a subfield of $L$.
\end{exercise}
\begin{solution}
 This is very similar to Proposition~\ref{prop-fixed-subfield}.  We
 have $\phi(0_L)=0_M=\psi(0_L)$, so $0_L\in K$.  Similarly,  we
 have $\phi(1_L)=1_M=\psi(1_L)$, so $1_L\in K$.  If $a,b\in K$ then
 $\phi(a)=\psi(a)$ and $\phi(b)=\psi(b)$ so 
 \begin{align*}
  \phi(a+b) &=\phi(a)+\phi(b)=\psi(a)+\psi(b)=\psi(a+b) \\
  \phi(a-b) &=\phi(a)-\phi(b)=\psi(a)-\psi(b)=\psi(a-b) \\
  \phi(ab)  &=\phi(a)\phi(b)=\psi(a)\psi(b)=\psi(ab),
 \end{align*}
 which shows that $a+b,a-b,ab\in K$.  Finally, if $a\in K^\tm$ then we
 can apply Proposition~\ref{prop-hom-inj}(a) to both $\phi$ and $\psi$
 to get 
 \[ \phi(a^{-1}) = \phi(a)^{-1} = \psi(a)^{-1} =\psi(a^{-1}), \]
 which shows that $a^{-1}\in K$.  Thus, $K$ is a subfield as claimed.
\end{solution}
\begin{exercise}\exlabel{ex-product-ring}
 Let $K_0$ and $K_1$ be fields.  Show that $K_0\tm K_1$ is a
 commutative ring but not a field.  (You should check a representative
 sample of the ring axioms, but not necessarily the whole list.)
\end{exercise}
\begin{solution}
 Put $R=K_0\tm K_1$.  We recall that this is the set of all pairs
 $(a_0,a_1)$, where $a_0\in K_0$ and $a_1\in K_1$.  By hypothesis we
 are given an addition rule and a multiplication rule for elements of
 $K_0$, and an addition rule and a multiplication rule for elements of
 $K_1$.  We combine these in the obvious way to define addition and
 multiplication in $R$:
 \begin{align*}
  (a_0,a_1) + (b_0,b_1) &= (a_0+b_0,a_1+b_1) \\
  (a_0,a_1)(b_0,b_1) &= (a_0b_0,a_1b_1).
 \end{align*}
 The zero element of $R$ is the pair $(0,0)$, and the unit element is
 $(1,1)$.  Suppose we have three elements $a,b,c\in R$, say
 $a=(a_0,a_1)$ and $b=(b_0,b_1)$ and $c=(c_0,c_1)$.  By the
 associativity rule in $K_0$ we have $a_0+(b_0+c_0)=(a_0+b_0)+c_0$.
 By the associativity rule in $K_1$ we have
 $a_1+(b_1+c_1)=(a_1+b_1)+c_1$.  It follows that in $R$ we have
 \begin{align*}
  a+(b+c) &= (a_0,a_1) + ((b_0,b_1)+(c_0,c_1)) \\
   &= (a_0,a_1)+(b_0+c_0,b_1+c_1) \\
   &= (a_0+(b_0+c_0),a_1+(b_1+c_1)) \\
   &= ((a_0+b_0)+c_0,(a_1+b_1)+c_1) \\
   &= (a_0+b_0,a_1+b_1)+(c_0,c_1) \\
   &= ((a_0,a_1)+(b_0,b_1))+(c_0,c_1) = (a+b)+c.
 \end{align*}
 (The first, second, fourth and fifth steps here are just instances of
 the definition of addition in $R$; the third step uses the
 associativity rules in $K_0$ and $K_1$.)  Thus, addition in $R$ is
 associative. 

 Similarly, the distributivity rule in $K_0$ tells us that
 $a_0(b_0+c_0)=a_0b_0+a_0c_0$.  The distributivity rule in $K_1$ tells
 us that $a_1(b_1+c_1)=a_1b_1+a_1c_1$.  It follows that in $R$ we have 
 \begin{align*}
  a(b+c) &= (a_0,a_1)(b_0+c_0,b_1+c_1) \\
         &= (a_0(b_0+c_0),a_1(b_1+c_1)) \\
         &= (a_0b_0+a_0c_0,a_1b_1+a_1c_1) \\
         &= (a_0b_0,a_1b_1)+(a_0c_0,a_1c_1) = ab+ac.
 \end{align*}
 The other commutative ring axioms can be checked in the same way.

 As $1\neq 0$ in $K_0$, we see that the element $e=(1,0)\in R$ is
 nonzero.  For any element $a=(a_0,a_1)\in R$ we have
 $ea=(a_0,0)\neq(1,1)=1_R$, so $a$ is not inverse to $e$.  Thus $e$ is
 a nonzero element with no inverse, proving that $R$ is not a field.
\end{solution}

\section{Vector spaces}
\label{sec-vector-spaces}

\begin{definition}\lbl{defn-vector-space}
 A vector space over a field $K$ is a set $V$, together with
 an element $0\in V$ and a definition of what it means to
 add elements of $V$ or multiply them by elements of $K$,
 such that
 \begin{itemize}
  \item[(a)] If $u$ and $v$ are elements of $V$, then $u+v$ is an
   also an element of $V$.
  \item[(b)] If $v$ is an element of $V$ and $t$ is an
   element of $K$, then $tv$ is an element of $V$.
  \item[(c)] For any elements $u,v,w\in V$ and any elements
   $s,t\in K$, the following equations hold:
    \begin{enumerate}
     \item $0+v=v$
     \item $u+v=v+u$
     \item $u+(v+w)=(u+v)+w$
     \item $0u=0$
     \item $1u=u$
     \item $(st)u=s(tu)$
     \item $(s+t)u=su+tu$
     \item $s(u+v)=su+sv$.
    \end{enumerate}
 \end{itemize}  
\end{definition}

\begin{example}\lbl{eg-Kn-vs}
 We write $K^n$ for the set of column vectors of length $n$ with
 entries in $K$.  We define addition and scalar multiplication in the
 obvious way: for $n=4$ this reduces to 
 \[ \bsm u_1\\ u_2\\ u_3\\ u_4\esm + 
    \bsm v_1\\ v_2\\ v_3\\ v_4\esm =
    \bsm u_1+v_1\\ u_2+v_2\\ u_3+v_3\\ u_4+v_4\esm
    \hspace{5em}
    t \bsm u_1\\ u_2\\ u_3\\ u_4\esm =
    \bsm tu_1\\ tu_2\\ tu_3\\ tu_4\esm.
 \]
 This makes $K^n$ into a vector space over $K$.
\end{example}

\begin{example}\lbl{eg-MnK-vs}
 We write $M_n(K)$ for the set of $n\tm n$ matrices with entries in
 $K$.  We define addition and scalar multiplication in the
 obvious way: for $n=2$ this reduces to
 \[ \bsm a&b\\ c&d\esm + \bsm e&f\\ g&h\esm = 
     \bsm a+e&b+f \\ c+g & d+h \esm  \hspace{4em}
     t \bsm a&b\\ c&d\esm = \bsm ta&tb\\ tc&td\esm.
 \]
 This makes $M_n(K)$ into a vector space over $K$.
\end{example}

\begin{example}\lbl{eg-rational-vs}
 Recall that $K[x]$ is the set of all polynomials over $K$.  We can
 add together two polynomials to get a new polynomial, or we can
 multiply a polynomial by an element of $K$ to get a new polynomial,
 and these operations satisfy all the usual algebraic rules.  Thus,
 $K[x]$ is a vector space over $K$.  The field $K(x)$ (of rational
 functions over $K$, as in example~\ref{eg-fields-rational}) is also a
 vector space over $K$.
\end{example}

\begin{example}\lbl{eg-R-C-vs}
 We can add together two complex numbers to get a new complex number,
 or we can multiply a complex number by a real number to get a new
 complex number, and these operations satisfy all the usual algebraic
 rules.  Thus, $\C$ is a vector space over $\R$.  It can of course be
 identified with $\R^2$ by the usual rule
 $a+bi\leftrightarrow\bsm a\\ b\esm$.
\end{example}

\begin{example}\lbl{eg-extension-vs}
 More generally, whenever $L$ is a field and $K$ is a subfield, we can
 regard $L$ as a vector space over $K$.  Example~\ref{eg-rational-vs}
 includes the case where $L=K(x)$, and Example~\ref{eg-R-C-vs} is the
 case where $K=\R$ and $L=\C$.  Examples of this type will be very
 important in our study of the structure of fields.
\end{example}

\begin{remark}\lbl{rem-different-fields}
 The same set can often be regarded as a vector space over many
 different fields.  For example, the set $\C(x)$ can be regarded as a
 vector space over $\Q$, a vector space over $\R$, a vector space over
 $\C$ or a vector space over $\C(x)$ itself.  These different points
 of view can all be useful for different purposes, and there is no
 contradiction between them.
\end{remark}

\begin{definition}\lbl{defn-subspace}
 Let $V$ be a vector space over a field $K$.  A \emph{vector subspace}
 (or just \emph{subspace}) of $V$ is a subset $W\sse V$ such that
 \begin{itemize}
  \item[(a)] $0\in W$
  \item[(b)] Whenever $u$ and $v$ lie in $W$, the element $u+v$ also
   lies in $W$.  (In other words, $W$ is closed under addition.)
  \item[(c)] Whenever $u$ lies in $W$ and $t$ lies in $K$, the
   element $tu$ also lies in $W$.  (In other words, $W$ is
   closed under scalar multiplication.)
 \end{itemize}
 These conditions mean that $W$ is itself a vector space.
\end{definition}

\begin{definition}\lbl{defn-linear}
 Let $V$ and $W$ be vector spaces over a field $K$, and let
 $\phi\:V\xra{}W$ be a function (so for each element $v\in V$ we have
 an element $\phi(v)\in W$).  We say that $\phi$ is \emph{linear} if
 \begin{itemize}
  \item[(a)] For any $v$ and $v'$ in $V$, we have
   $\phi(v+v')=\phi(v)+\phi(v')$ in $W$.
  \item[(b)] For any $t\in K$ and $v\in V$ we have
   $\phi(tv)=t\phi(v)$ in $W$. 
 \end{itemize}
 By taking $t=v=0$ in~(b), we see that a linear map must satisfy
 $\phi(0)=0$.  Further simple arguments also show that
 $\phi(v-v')=\phi(v)-\phi(v')$.
\end{definition}
\begin{remark}\lbl{rem-linear}
 One can check that $\phi$ is linear if and only if it satisfies the
 single axiom that $\phi(tv+t'v')=t\phi(v)+t\phi(v')$ for all
 $t,t'\in K$ and $v,v'\in V$.
\end{remark}

\begin{definition}\lbl{defn-ker-img}
 Let $\phi\:V\to W$ be a linear map of vector spaces over a field
 $K$.  We put 
 \begin{align*}
  \ker(\phi) &= \{v\in V\st \phi(v)=0\} \sse V \\
  \img(\phi) &= \{\phi(v) \st v\in V\} \sse W.
 \end{align*}
\end{definition}
\begin{remark}\lbl{rem-ker-img}
 It is not hard to see that $\ker(\phi)$ and $\img(\phi)$ are
 subspaces of $V$ and $W$ respectively.  Moreover, $\phi$ is injective
 iff $\ker(\phi)=0$, and $\phi$ is surjective iff $\img(\phi)=W$. 
\end{remark}

\begin{definition}\lbl{defn-basis}
 Let $K$ be a field, let $V$ be a vector space over $K$, and let
 $\CV=v_1,\dotsc,v_n$ be a finite list of elements of $V$.  We define
 a map $\mu_{\CV}\:K^n\to V$ by $\mu_{\CV}(\blm)=\sum_i\lm_iv_i$.
 \begin{itemize}
  \item We say that $\CV$ is \emph{linearly independent} if
   $\ker(\mu_{\CV})=0$, or equivalently, $\mu_{\CV}$ is injective.
  \item We say that $\CV$ \emph{spans} $V$ if
   $\img(\mu_{\CV})=V$, or equivalently, $\mu_{\CV}$ is surjective.
  \item We say that $\CV$ is a \emph{basis} for $V$ if it is linearly
   independent and it also spans.
  \item It can be shown that if $V$ has a basis then all bases have
   the same length; we call this length the \emph{dimension} of $V$
   over $K$, and write it as $\dim_K(V)$.  If $V$ has no basis then we
   say that the dimension is infinite.
 \end{itemize}
\end{definition}

We recall without proof some basic facts about these concepts:

\begin{proposition}\lbl{thm-vect-misc}
 Let $K$ be a field, and let $V$ be a vector space of dimension
 $d<\infty$ over $K$.  
 \begin{itemize}
  \item[(a)] Any linearly independent list in $V$ has length at most
   $d$.  
  \item[(b)] Any spanning list in $V$ has length at least $d$.
  \item[(c)] Any linearly independent list of length $d$ is a basis.
   More generally, if $\CV$ is a linearly independent list of length
   less than $d$ then we can add extra elements on the end to make a
   basis. 
  \item[(d)] Any spanning list of length $d$ is also a basis. \qed
 \end{itemize}
\end{proposition}

\begin{example}\lbl{eg-dim}
 $K^n$ has dimension $n$ over $K$, and $M_n(K)$ has dimension $n^2$.
 The spaces $K[x]$ and $K(x)$ have infinite dimension over $K$.
\end{example}

\begin{example}\lbl{eg-dim-R-Cn}
 $\C$ has dimension two over $\R$.  If we put 
 \[ e_1 = \bsm 1\\ 0\\ 0 \esm \hspace{4em}
    e_2 = \bsm 0\\ 1\\ 0 \esm \hspace{4em}
    e_3 = \bsm 0\\ 0\\ 1 \esm 
 \]
 then the list $e_1,e_2,e_3$ is a basis for $\C^3$ over $\C$, so
 $\dim_\C(\C^3)=3$, as mentioned in the previous example.  However,
 we can also regard $\C^3$ as a vector space over $\R$, and the list
 $e_1,e_2,e_3$ does not span $\C^3$ over $\R$, so it is not a basis.
 Instead, we can use the formula
 \[ \bsm x_1+iy_1\\ x_2+iy_2 \\ x_3+iy_3\esm =
     x_1e_1 + y_1(ie_1) + x_2e_2 + y_2(ie_2) + x_3e_3 + y_3(ie_3)
 \] 
 to show that the list $e_1,ie_1,e_2,ie_2,e_3,ie_3$ is a basis for
 $\C^3$ over $\R$, so $\dim_\R(\C^3)=6$.  In exactly the same way, we
 have $\dim_\R(\C^n)=2n$ for all $n\geq 0$.
\end{example}

\begin{remark}\lbl{rem-partial-fractions}
 We have set up our definitions so that bases are by definition finite
 lists.  It is also possible to set up a theory of infinite bases, but
 this involves some subtleties that we will not take the time to
 explain.  It then works out that the set $\CX=\{x^n\st n\geq 0\}$ is
 a basis for $\C[x]$ over $\C$.  Moreover, using the Fundamental
 Theorem of Algebra (Theorem~\ref{thm-fta}) and the theory of partial
 fractions one can show that the (uncountable) set
 \[ \CX \cup \{(x-\lm)^{-n}\st \lm\in\C,\; n>0\} \]
 is a basis for $\C(x)$ over $\C$.
\end{remark}

\begin{definition}\lbl{defn-extension-degree}
 If $K$ is a subfield of $L$, then we write $[L:K]=\dim_K(L)$, the
 dimension of $L$ considered as a vector space over $K$.  We also say
 that $L$ is an \emph{extension} of $K$, and the number $[L:K]$ is
 called the \emph{degree} of the extension.  
\end{definition}

\begin{definition}\lbl{defn-hom-degree}
 For a slightly more general picture, suppose we have two fields $K$
 and $L$ and a homomorphism $\phi\:K\to L$.  Then the image $\phi(K)$
 is a subfield of $L$, so we have a (possibly infinite) number
 $[L:\phi(K)]$.  We write $\deg(\phi)$ for this, and call it the
 degree of $\phi$.
\end{definition}

\begin{example}\lbl{eg-degrees}
 The list $1,i$ is a basis for $\C$ over $\R$, so $[\C:\R]=2$.
 Similarly, the list $1,\sqrt{p}$ is a basis for $\Q(\sqrt{p})$ over
 $\Q$, so $[\Q(\sqrt{p}):\Q]=2$.  More generally, for any $n>1$ we can
 consider the field $K=\Q(p^{1/n})$ and we find that the list
 $1,p^{1/n},p^{2/n},\dotsc,p^{(n-1)/n}$ is a basis for $K$ over $\Q$,
 so $[K:\Q]=n$.  We can also consider a second prime $q\neq p$ and the
 field $L=\Q(\sqrt{p},\sqrt{q})$ generated by $\sqrt{p}$ and
 $\sqrt{q}$.  We will check in Proposition~\ref{prop-biquadratic} that
 the list $1,\sqrt{p},\sqrt{q},\sqrt{pq}$ is a basis for $L$ over
 $\Q$, so $[L:\Q]=4$.
\end{example}

\begin{example}\lbl{eg-infinite-degree}
 On the other hand, it can be shown that $[\R:\Q]=\infty$.  One proof
 of this uses the theory of countability: standard methods show that
 $\Q^n$ is countable for all $n$ but $\R$ is uncountable, so $\R$
 cannot be isomorphic to $\Q^n$ for any $n$.  Another proof uses the
 fact (which we shall not justify) that the powers $1,e,e^2,\dotsc$
 (where $e\simeq 2.71828$ is the base of natural logarithms) are
 linearly independent over $\Q$.  A third proof uses
 Section~\ref{sec-mquad} below.  It follows from results given there
 that the list $\sqrt{2},\sqrt{3},\sqrt{7},\sqrt{11},\dotsc$ (of
 square roots of all primes) is linearly independent over $\Q$, which
 would not be possible if $[\R:\Q]$ were finite.
\end{example}

\begin{proposition}\lbl{prop-degree-product}
 If $K$ is a subfield of $L$ and $L$ is a subfield of $M$ then
 $[M:L][L:K]=[M:K]$.  More precisely, if $\al_1,\dotsc,\al_n$ is a
 basis for $L$ over $K$ (so that $[L:K]=n$) and $\bt_1,\dotsc,\bt_m$
 is a basis for $M$ over $L$ (so that $[M:L]=m$) then the $nm$
 elements $\al_i\bt_j$ form a basis for $M$ over $K$.
\end{proposition}
\begin{remark}\lbl{rem-degree-product}
 We will prove this under the assumption that $m$ and $n$ are finite.
 It is also true that if $L$ has infinite dimension over $K$ or $M$
 has infinite dimension over $L$ then $M$ has infinite dimension over
 $K$.  We leave this as an exercise.
\end{remark}
\begin{proof}
 Consider an element $u\in M$.  As the elements $\bt_j$ span $M$ over
 $L$, there must exist elements $v_1,\dotsc,v_m\in L$ with
 $u=\sum_jv_j\bt_j$.  Now $v_j\in L$ and the elements
 $\al_1,\dotsc,\al_n$ span $L$ over $K$, so there must exist elements
 $w_{1j},\dotsc,u_{nj}\in K$ with 
 \[ v_j = w_{1j}\al_1 + w_{2j}\al_2 + \dotsb + w_{nj} \al_n
        = \sum_{i=1}^n w_{ij}\al_i.
 \]
 It follows that
 \[ u = \sum_{j=1}^m v_j\bt_j =
      \sum_{j=1}^m\sum_{i=1}^n w_{ij}\al_i\bt_j. 
 \]
 This shows that $u$ is a $K$-linear combination of the elements
 $\al_i\bt_j$, so these elements span $M$ over $K$.

 We now need to prove that these elements are linearly independent.
 This essentially just reverses the steps already taken.  In detail, a
 linear relation between the elements $\al_i\bt_j$ is a system of
 elements $w_{ij}\in K$ for which $\sum_{i,j}w_{ij}\al_i\bt_j$ is
 zero.   If we put $v_j=\sum_iw_{ij}\al_i$ then the relation can be
 written as $\sum_jv_j\bt_j=0$.  Here $v_j\in L$ and the elements
 $\bt_j$ are assumed to be linearly independent over $L$, so we must
 have $v_j=0$ for all $j$.  This means that $\sum_iw_{ij}\al_i=0$, and
 here $w_{ij}\in K$ and the elements $\al_i$ are assumed to be
 linearly independent over $K$, so we must have $w_{ij}=0$ for all $i$
 and $j$, so our original linear relation between the elements
 $\al_i\bt_j$ is the trivial relation.
\end{proof}

We can restate the same fact in different notation as follows:
\begin{corollary}\lbl{cor-degree-product}
 Let $K$, $L$ and $M$ be fields, and let $K\xra{\phi}L\xra{\psi}M$ be
 homomorphisms of fields.  Then $\deg(\psi\phi)=\deg(\psi)\deg(\psi)$.
\end{corollary}
\begin{proof}
 Put $K'=\phi(K)\leq L$ and $K''=\psi(K')\leq M$ and
 $L''=\psi(L)\leq M$, so 
 \[ \deg(\phi) = [L:K'] \hspace{4em}
    \deg(\psi) = [M:L''] \hspace{4em}
    \deg(\psi\phi) = [M:K''].
 \]
 The previous proposition tells us that $[M:K'']=[M:L''][L'':K'']$,
 so $\deg(\psi\phi)=\deg(\psi)[L'':K'']$, so it will be enough to
 prove that $[L'':K'']=[L:K']$.  The homomorphism $\psi$ gives an
 isomorphism $L\to L''$ that carries $K'$ to $K''$.  It is
 straightforward to check that a list $\al_1,\dotsc,\al_d$ is a basis
 for $L$ over $K'$ if and only if $\psi(\al_1),\dotsc,\psi(\al_d)$ is
 a basis for $L''$ over $K''$, and this means that $[L'':K'']=[L:K']$
 as claimed.
 
 The fields considered can be displayed as follows:
 \[ \xymatrix{
     & & M \\
     & L \urto^\psi \rto^\simeq_\psi &
     L'' \ar@{ >->}[u]_{\sse} \\
     K \urto^\phi \rto^\simeq_\phi &
     K' \ar@{ >->}[u]_{\sse} \rto^\simeq_\psi &
     K'' \ar@{ >->}[u]_{\sse}
    }
 \]
\end{proof}

\begin{proposition}\lbl{prop-deg-one}
 A homomorphism $\phi\:K\to L$ is an isomorphism if and only if
 $\deg(\phi)=1$. 
\end{proposition}
\begin{proof}
 Put $K'=\phi(K)$ as before, so $\phi$ gives an isomorphism $K\to K'$,
 so the question is whether $K'=L$ or not.  If $\deg(\phi)=1$, then
 $L$ has dimension one over $K'$, so any nonzero element of $L$ gives
 a basis for $L$ over $K'$.  In particular, the element $1$ gives a
 basis for $L$ over $K'$, so $L=K'.1=K'$ as required.  The converse is
 also clear.
\end{proof}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-which-linear}
 Which of the following maps are $\C$-linear?
 \begin{itemize}
  \item The map $\phi_0\:M_2(\C)\to M_2(\C)$ given by
   $\phi_0(A)=A^2$.
  \item The map $\phi_1\:M_2(\C)\to M_2(\C)$ given by $\phi_1(A)=A-A^T$.
  \item The map $\phi_2\:\C^2\to\C[x]$ given by 
   $\phi_2\bsm a \\ b\esm=ax+bx^2$
  \item The map $\phi_3\:\C^2\to\C[x]$ given by 
   $\phi_3\bsm a \\ b\esm=ax+(bx)^2$
  \item The map $\phi_4\:\C[x]\to\C^2$ given by 
   $\phi_4(f(x))=\bsm f(2)\\ f(-2)\esm$
  \item The map $\phi_5\:\C[t]\to\C$ given by 
   $\phi(f(x))=f(0)f(1)f(2)$.
 \end{itemize}
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item $\phi_0$ is not linear because $\phi_0(-I)=(-I)^2=I\neq -\phi(I)$.
  \item $\phi_1$ is linear because 
   \[ \phi_1(sA+tB)=sA+tB-(sA+tB)^T = 
        sA+tB-sA^T-tB^T=s(A-A^T)+t(B-B^T)=s\phi_1(A)+t\phi_1(B).
   \]
   (This is enough by Remark~\ref{rem-linear}.)
  \item $\phi_2$ is also linear, because
   \[ \phi_2\left(s\bsm a\\ b\esm + t\bsm c\\ d\esm\right) = 
       \phi_2\bsm sa+tc\\ sb+td\esm =
       (sa+tc)x+(sb+td)x^2 = 
       s(ax+bx^2)+t(cx+dx^2) = 
       s\phi_2\bsm a\\ b\esm + t\phi_2\bsm c\\ d\esm .
   \]
  \item $\phi_3$ is not linear, because 
   \[ \phi_3\left(-\bsm 0\\ 1\esm\right) = \phi_3\bsm 0\\ -1\esm = 
        (-x)^2 \neq -x^2 = -\phi_3\bsm 0\\ 1\esm.
   \]
  \item $\phi_4$ is linear, because if $h(x)=s\,f(x)+t\,g(x)$ then
   $h(2)=s\,f(2)+t\,g(2)$ and $h(-2)=s\,f(-2)+t\,g(-2)$ so 
   \[ \phi_4(s\,f(x)+t\,g(x)) = \bsm h(2)\\ h(-2)\esm = 
       s\bsm f(2)\\ f(-2)\esm + t\bsm g(2)\\ g(-2)\esm = 
        s\phi_4(f(x)) + t\phi_4(g(x)).
   \]
  \item $\phi_5$ is not linear.  Indeed, for constant polynomials we
   just have $\phi_5(c)=c^3$, so
   $\phi_5(1+1)=8\neq 2=\phi_5(1)+\phi_5(1)$. 
 \end{itemize}
\end{solution}

\begin{exercise}\exlabel{ex-degrees-possible}
 Do there exist fields $K,L,M$ with $\Q<K<M$ and $\Q<L<M$ and degrees
 as follows?
 \[ [K:\Q] = 3 \qquad [L:\Q] = 4 \qquad
    [M:L] = 5 \qquad [M:K] = 7.
 \]
\end{exercise}
\begin{solution}
 No.  We would have
 \begin{align*}
  [M:\Q] &= [M:K][K:\Q] = 7\tm 3 = 21 \\
  [M:\Q] &= [M:L][L:\Q] = 5\tm 4 = 20,
 \end{align*}
 which is obviously not possible.
\end{solution}

\begin{exercise}\exlabel{ex-find-degrees}
 Suppose we have fields $K<L<M<N$ (all different) such that $[M:K]=6$
 and $[N:L]=15$.  Find $[L:K]$, $[M:L]$ and $[N:M]$.
\end{exercise}
\begin{solution}
 Put $a=[L:K]$ and $b=[M:L]$ and $c=[N:M]$.  As $K$, $L$, $M$ and $N$
 are all different we must have $a,b,c>1$.  We also have
 \begin{align*}
  ab &= [M:L][L:K] = [M:K] = 6 \\
  bc &= [N:M][M:L] = [N:L] = 15.
 \end{align*}
 As $ab=6$ with $a,b>1$ we must have $(a,b)=(2,3)$ or $(a,b)=(3,2)$.
 As $bc=15$ with $b,c>1$ we must have $(b,c)=(3,5)$ or $(b,c)=(5,3)$.
 The only way these can both be satisfied is if $(a,b,c)=(2,3,5)$.
\end{solution}

\begin{exercise}\exlabel{ex-basis-i}
 Recall that the \emph{trace} of a square matrix is the sum of the
 diagonal entries.  Find a basis for the space 
 \[ V = \{M\in M_3(\C)\st M^T=M \text{ and } \trc(M)=0\} \]
 (considered as a vector space over $\C$).
\end{exercise}
\begin{solution}
 The general form for elements of $V$ is
 \[ M = \bsm a & b & c \\ b & d & e \\ c & e & -a-d \esm =
     aA+bB+cC+dD+eE,
 \]
 where 
 \[ A = \bsm 1&0&0\\ 0&0&0\\ 0&0&-1 \esm
    B = \bsm 0&1&0\\ 1&0&0\\ 0&0&0 \esm 
    C = \bsm 0&0&1\\ 0&0&0\\ 1&0&0 \esm 
    D = \bsm 0&0&0\\ 0&1&0\\ 0&0&-1 \esm
    E = \bsm 0&0&0\\ 0&0&1\\ 0&1&0 \esm.
 \]
 It follows easily from this that the list $A,B,C,D,E$ is a basis for
 $V$. 
\end{solution}

\begin{exercise}\exlabel{ex-matrix-subspaces}
 Recall that for a matrix $A=\bsm a&b\\ c&d\esm\in M_2(\C)$, we write 
 $A^\dag=\bsm\ov{a}&\ov{c} \\ \ov{b}&\ov{d}\esm$.  Put
 $V=\{A\in M_2(\C)\st A+A^\dag=0\}$.  
 \begin{itemize}
  \item[(a)] Show that if we consider $M_2(\C)$ as a vector space over
   $\C$, then $V$ is not a subspace.
  \item[(b)] Show that if we consider $M_2(\C)$ as a vector space over
   $\R$, then $V$ is a subspace of dimension $4$.
 \end{itemize}
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item Put $A=iI=\bsm i&0\\ 0&i\esm$.  As $\ov{i}=-i$ we see that
   $A^\dag=-A$, so $A\in V$.  On the other hand, we have $-iA=I$ and
   $I+I^\dag=2I$ so $-iA\not\in V$.  This means that $V$ is not closed
   under multiplication by the complex number $-i$, so it is not a
   subspace over $\C$ of $M_2(\C)$.
  \item If $A=\bsm a&b\\ c&d\esm$ then
   $A+A^\dag=\bsm a+\ov{a} & b+\ov{c}\\ c+\ov{b} & d\ov{d}\esm$.  For
   this to be zero, we need $a+\ov{a}=d+\ov{d}=0$ (so $a$ and $d$ are
   purely imaginary) and $c=-\ov{b}$.  Equivalently, $A$ must have the
   form 
   \[ A=\bsm iw & x+iy \\ -x+iy & iz \esm = 
       w\bsm i&0\\0&0 \esm + 
       x\bsm 0&1\\-1&0\esm +
       y\bsm 0&i\\ i&0\esm +
       z\bsm 0&0\\ 0&i\esm
   \] 
   for some $w,x,y,z\in\R$.  It follows that $V$ is a subspace over
   $\R$ of $M_2(\C)$, with basis given by the matrices
   \[  \bsm i&0\\0&0 \esm \hspace{3em}
       \bsm 0&1\\-1&0\esm \hspace{3em}
       \bsm 0&i\\ i&0\esm \hspace{3em}
       \bsm 0&0\\ 0&i\esm.
   \]
   In particular, this basis has size four, so $\dim_\R(V)=4$ as
   required. 
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-rational-extension}
 Let $L$ be the field $\C(x)$ of rational functions of $x$, and let
 $K$ be the subfield $\C(x^n)$.  Prove that $[L:K]=n$.
\end{exercise}
\begin{solution}
 As $L$ is generated over $\C$ by $x$, it is certainly generated over
 the larger field $K$ by $x$.  Put $f(t)=t^n-x^n\in K[t]$.  Clearly
 $f(x)=0$, so $x$ is algebraic over $K$.  Let $g(t)$ be the minimal
 polynomial of $x$ over $K$, so $g(t)$ divides $f(t)$, and
 $L=K(x)\simeq K[t]/g(t)$, so $m=[L:K]$ is the degree of $g(t)$.  As
 $g(t)$ divides $f(t)$ we see that $m\leq n$.  We will suppose that
 $m<n$ and derive a contradiction; this will complete the proof.

 The coefficients of $g(t)$ are elements of $K=\Q(x^n)$, so they can
 be written as $a_i(x^n)/b_i(x^n)$ for certain polyomials $a_i(s)$ and
 $b_i(s)\neq 0$.  If we let $d(s)$ be the product of all the terms
 $b_i(s)$ we obtain an expression
 $d(x^n)g(t)=\sum_{i=0}^mc_i(x^n)t^i$, with $c_i(s),d(s)\in\C[s]$.  By
 assumption $g(x)=0$, so $\sum_{i=0}^mc_i(x^n)x^i=0$.  As $m<n$ we can
 compare coefficient of $x^{nj+i}$ (for $0\leq i\leq m$) to see that
 $c_i(x)=0$.  It follows that $g(t)=0$, which contradicts the fact
 that $g(t)$ divides $f(t)$, as required.
\end{solution}

\section{Ideals and quotient rings}
\label{sec-ideals}

\begin{definition}\lbl{defn-ideal}
 Let $R$ be a commutative ring.  An \emph{ideal} in $R$ is a subset
 $I\sse R$ such that
 \begin{itemize}
  \item[(a)] $0\in I$
  \item[(b)] If $a,b\in I$ then $a+b\in I$
  \item[(c)] If $a\in R$ and $b\in I$ then $ab\in I$.
 \end{itemize}
 For any element $x\in R$, the set $Rx=\{ax\st a\in R\}$ is an ideal
 in $R$; ideals of this form are called \emph{principal} ideals, and
 we say that $x$ is a \emph{generator} of $Rx$.
\end{definition}
\begin{remark}\lbl{rem-ideal-subtract}
 If $b\in I$ then $-b=(-1).b\in I$ by the case $a=-1$ of axiom~(c).
 It follows that if $a,b\in I$ then $a-b=a+(-b)\in I$ by axiom~(b).  
\end{remark}

\begin{example}\lbl{eg-silly-ideals}
 In any ring $R$, the subsets $\{0\}$ and $R$ itself are ideals.
 These are both principal, because $\{0\}=R.0$ and $R=R.1$.
\end{example}
\begin{example}\lbl{eg-field-ideals}
 Now let $K$ be a field.  We claim that $\{0\}$ and $K$ are the
 \emph{only} ideals in $K$.  Indeed, let $I$ be an ideal that is
 different from $\{0\}$.  Then there is a nonzero element $b\in I$.
 As $K$ is a field, there is an inverse element $b^{-1}\in K$.  Now
 Axiom~(c) tells us that $b^{-1}b\in I$, or in other words $1\in I$.
 Now for any element $a\in K$ we can use Axiom~(c) again to see that
 $a.1\in I$, or in other words $a\in I$; so $I=K$.
\end{example}
\begin{example}\lbl{eg-poly-ideals}
 Consider the following subsets of $\R[x]$:
 \begin{align*}
  I_0 &= \{f(x)\st f(0)=1\} \\
  I_1 &= \{f(x)\st f(0)=f(1)\} \\
  I_2 &= \{f(x)\st f(0)f(1)=0\} \\
  I_3 &= \{f(x)\st f(0)=f'(0)=f(1)=0\}.
 \end{align*}
 We claim that $I_3$ is an ideal, but that the other sets are not.
 Indeed, the zero polynomial does not lie in $I_0$, so Axiom~(a) is
 violated.  The constant polynomial $1$ lies in $I_1$, but $x.1$ is
 not in $I_1$, so Axiom~(c) is violated.  The polynomials $x$ and
 $1-x$ both lie in $I_2$ but $x+(1-x)$ does not, so Axiom~(b) is
 violated.  However, it is clear that $0\in I_3$.  If
 $f(x),g(x)\in I_3$ and $h(x)=f(x)+g(x)$ then 
 \begin{align*}
  h(0)  &= f(0)+g(0) = 0+0 = 0 \\
  h'(0) &= f'(0)+g'(0) = 0+0 = 0 \\
  h(1)  &= f(1)+g(1) = 0+0 = 0 
 \end{align*}
 so $h\in I_3$.  Similarly, if $f(x)\in\R[x]$ and $g(x)\in I_3$ and
 $h(x)=f(x)g(x)$ then $g(0)=g'(0)=g(1)=0$ and
 $h'(x)=f'(x)g(x)+f(x)g'(x)$ so
 \begin{align*}
  h(0)  &= f(0)g(0) = f(0).0 = 0 \\
  h'(0) &= f'(0)g(0)+f(0)g'(0) = f'(0).0+f(0).0 = 0 \\
  h(1)  &= f(1)g(1) = f(1).0 = 0, 
 \end{align*}
 so again $h\in I_3$.  Thus all axioms are satisfied and $I_3$ is an
 ideal.  In fact it is not hard to see that $I_3=\R[x].(x^3-x^2)$, so
 $I_3$ is a principal ideal.
\end{example}

\begin{proposition}\lbl{prop-ker-ideal}
 Let $\phi\:R\to S$ be a homomorphism of rings, and put
 $\ker(\phi)=\{a\in R\st\phi(a)=0\}$.  Then $\ker(\phi)$ is an ideal
 in $R$.  Moreover, $\phi$ is injective if and only if
 $\ker(\phi)=\{0\}$.  
\end{proposition}
\begin{proof}
 As $\phi$ is a homomorphism we have $\phi(0)=0$, so $0\in\ker(\phi)$.
 Now suppose that $a,b\in\ker(\phi)$.  We then have
 $\phi(a)=\phi(b)=0$, so $\phi(a+b)=\phi(a)+\phi(b)=0+0=0$, so
 $a+b\in\ker(\phi)$.  Suppose instead that $a\in R$ and
 $b\in\ker(\phi)$.  We then have $\phi(b)=0$ and so
 $\phi(ab)=\phi(a)\phi(b)=\phi(a).0=0$, so $ab\in\ker(\phi)$.  This
 shows that $\ker(\phi)$ is an ideal as claimed.

 Now suppose that $\phi$ is injective.  If $a\in\ker(\phi)$ then we
 have $\phi(a)=0=\phi(0)$, so by injectivity we have $a=0$; thus
 $\ker(\phi)=\{0\}$.  

 Conversely, suppose we have $\ker(\phi)=\{0\}$.  If $a,b\in R$
 satisfy $\phi(a)=\phi(b)$, then $\phi(a-b)=\phi(a)-\phi(b)=0$, so
 $a-b\in\ker(\phi)=\{0\}$, so $a-b=0$, so $a=b$.  This shows that
 $\phi$ is injective as claimed. 
\end{proof}

\begin{proposition}\lbl{prop-ideal-ops}
 Let $R$ be a commutative ring, and let $I$ and $J$ be ideals in $R$.
 Put 
 \[ I+J = \{a\in R\st a=u+v \text{ for some } 
             u\in I \text{ and } v\in J\}.
 \]
 Then $I+J$ and $I\cap J$ are both ideals in $R$.
\end{proposition}
\begin{proof}
 We first consider $I\cap J$.  As $I$ and $J$ are ideals we have
 $0\in I$ and $0\in J$, so $0\in I\cap J$, so Axiom~(a) is satisfied.
 Now suppose that $a,b\in I\cap J$.  As $a,b\in I$ and $I$ is an ideal
 we have $a+b\in I$.  As $a,b\in J$ and $J$ is an ideal we have
 $a+b\in J$.  Thus $a+b\in I\cap J$, so Axiom~(b) is satisfied.  Now
 suppose instead that $a\in R$ and $b\in I\cap J$.  As $a\in R$ and
 $b\in I$ and $I$ is an ideal we see that $ab\in I$.  As $a\in R$ and
 $b\in J$  and $J$ is an ideal we also have $ab\in J$.  It follows
 that $ab\in I\cap J$, so Axiom~(c) is satisfied.  Thus $I\cap J$ is
 an ideal as claimed.

 Now consider $I+J$.  We can write $0$ as $0+0$ with $0\in I$ and
 $0\in J$, so $0\in I+J$, so Axiom~(a) is satisfied.  Now suppose that
 $a,b\in I+J$.  As $a\in I+J$ we can write $a=u+v$ for some $u\in I$
 and $v\in J$.  Similarly we can write $b=x+y$ for some $x\in I$ and
 $y\in J$.  We now have $a+b=u+v+x+y=(u+x)+(v+y)$.  Here $u+x\in I$
 and $v+y\in J$, so we see that $a+b\in I+J$, so Axiom~(b) is
 satisfied.  Finally, suppose instead that $a\in R$ and $b\in I+J$.
 We can write $b=x+y$ as before, with $x\in I$ and $y\in J$.  As $I$
 is an ideal we have $ax\in I$, and as $J$ is an ideal we have
 $ay\in J$.  We can write $ab$ as $ax+ay$ with $ax\in I$ and
 $ay\in J$, so $ab\in I+J$.  Thus Axiom~(c) is satisfied and $I+J$ is
 an ideal.
\end{proof}

\begin{definition}\lbl{defn-R-mod-I}
 Let $R$ be a commutative ring, and let $I$ be an ideal in $R$.  For
 any $a\in R$ we put $a+I=\{a+b\st b\in I\}\sse R$.  A \emph{coset} of
 $I$ in $R$ is a set of the form $a+I$ for some $a\in R$.  We write
 $R/I$ for the set of all cosets.  We define a map $\pi\:R\to R/I$ by
 $\pi(a)=a+I$.  
\end{definition}

\begin{proposition}\lbl{prop-R-mod-I}\ \\
 \begin{itemize}
  \item[(a)] If $a-b\in I$ then the cosets $\pi(a)=a+I$ and
   $\pi(b)=b+I$ are the same; but if $a-b\not\in I$ then they are
   disjoint. 
  \item[(b)] The set $R/I$ has a unique ring structure such that $\pi$
   is a homomorphism.
 \end{itemize}
\end{proposition}

%%% End of Lecture 3

\begin{proof}
 \begin{itemize}
  \item[(a)] First suppose that the element $a-b$ lies in $I$.
   Then any element of $a+I$ can be written as $a+x$ for some
   $x\in I$,  but $a+x=b+((a-b)+x)$ with $(a-b)+x\in I$, so
   $a+x\in b+I$.  This shows that $a+I\sse b+I$, and a symmetrical
   argument shows that $b+I\sse a+I$, so $a+I=b+I$.  Next suppose that
   $a+I$ and $b+I$ are not disjoint, so we can choose an element
   $u\in(a+I)\cap(b+I)$.  As $u\in a+I$ we have $u=a+x$ for some
   $x\in I$.  As $u\in b+I$ we have $u=b+y$ for some $y\in I$.  We now
   see that $a+x=b+y$, which can be rearranged as $a-b=y-x$.  Here $x$
   and $y$ lie in $I$ so $y-x\in I$, so $a-b\in I$.  As we argued
   above, this means that in fact $a+I=b+I$.
  \item[(b)] Suppose that $A,B\in R/I$, so $A$ and $B$ are subsets of
   $R$.  We define 
   \begin{align*}
    0_{R/I} &= \pi(0) = I \\
    1_{R/I} &= \pi(1) = 1 + I \\
    A+B &= \{x+y\st x\in A\text{ and } y\in B\} \\
    AB &= \{xy+t\st x\in A\text{ and } y\in B \text{ and } t\in I\}.
   \end{align*}
   We now claim $A+B$ is always a coset.  Indeed, the sets $A$ and $B$
   are cosets by assumption, so we can choose $a$ and $b$ such that
   $A=a+I=\pi(a)$ and $B=b+I=\pi(b)$.  We claim more precisely that
   $A+B=\pi(a+b)$.  Indeed, every element $x\in A$ can be written as
   $x=a+u$ for some $u\in I$, and every element $y\in B$ can be
   written as $y+v$ for some $v\in I$.  It follows that
   $x+y=(a+b)+(u+v)$ with $u+v\in I$, so $A+B\sse a+b+I=\pi(a+b)$.
   Conversely, if $z\in\pi(a+b)$ then $z=a+b+w$ for some $w\in I$,
   and so $z=(a+w)+(b+0)\in A+B$; so $\pi(a+b)=A+B$ as required.
   Using the special case $b=0$ we see in particular that
   $A+0_{R/I}=A$. 

   Similarly, we claim that $AB$ is a coset, namely $AB=\pi(ab)$.
   Indeed, any element of $AB$ can be written as $xy+t$ for some
   $x\in A$ and $y\in B$ and $t\in I$.  Equivalently, it can be
   written as $(a+u)(b+v)+t$ with $u,v,t\in I$, and thus as
   $ab+(ub+av+uv+t)$ with $ub+av+uv+t\in I$.  This shows that
   $AB\sse\pi(ab)$.  Conversely, any element $z\in\pi(ab)$ can be
   written as $ab+t$ for some $t\in I$, and $a\in A$ and $b\in B$ so
   $ab+t\in AB$.  This shows that $\pi(ab)=AB$ as claimed.  
   Using the special case $b=1$ we see in particular that
   $A.1_{R/I}=A$. 

   We next claim that these operations make $R/I$ into a ring.
   Consider for example the distributive law: we must show that if
   $A,B,C\in R/I$ then $A(B+C)=AB+AC$.  As $A$, $B$ and~$C$ are
   cosets, there must exist elements $a,b,c\in R$ such that $A=\pi(a)$
   and $B=\pi(b)$ and $C=\pi(c)$.  From what we proved above, we then
   have $B+C=\pi(b+c)$ and then 
   \begin{align*}
    A(B+C) &= \pi(a)\pi(b+c)=\pi(a(b+c))=\pi(ab+ac) \\
     &= \pi(ab)+\pi(ac) = \pi(a)\pi(b)+\pi(a)\pi(c) =AB+AC.
   \end{align*}
   All the other axioms are obvious or can be proved in the same way. 

   We have shown that $\pi(0)=0$ and $\pi(1)=1$ and
   $\pi(a+b)=\pi(a)+\pi(b)$ and $\pi(ab)=\pi(a)\pi(b)$, so
   $\pi\:R\to R/I$ is a homomorphism of rings.  We leave it to the
   reader to check that our ring structure is the unique one with this
   property. 
 \end{itemize}
\end{proof}

\begin{proposition}\lbl{prop-induced-hom}
 Let $\phi\:R\to S$ be a homomorphism of rings, and let $I$ be an
 ideal in $R$ such that $\phi(a)=0$ for all $a\in I$ (so
 $I\sse\ker(\phi)$).  Then there is a unique homomorphism
 $\ov{\phi}\:R/I\to S$ with $\ov{\phi}\circ\pi=\phi\:R\to S$.
 Moreover, if $\phi$ is surjective and $\ker(\phi)=I$ then $\ov{\phi}$
 is an isomorphism.
\end{proposition}
The rings and homomorphisms under consideration can be displayed in a
diagram as follows:
\[ \xymatrix{
     R \rto^\phi \dto_\pi & S \\ R/I \urto_{\ov{\phi}}
   }
\]
The equation $\ov{\phi}\circ\pi=\phi$ says that the two routes around
the diagram from $R$ to $S$ are actually the same.  The standard
terminology for this is to say that the diagram \emph{commutes}.

\begin{proof}
 Suppose that $A\in R/I$, so $A\sse R$.  If $a,b\in A$ then
 Proposition~\ref{prop-R-mod-I} tells us that $a-b\in I$, so
 $\phi(a)-\phi(b)=\phi(a-b)=0$, so $\phi(a)=\phi(b)$.  There is thus a
 well-defined map $\ov{\phi}\:R/I\to S$ given by
 $\ov{\phi}(A)=\phi(a)$ for any $a\in A$.  For a general element
 $x\in R$ we have $x\in\pi(x)\in R/I$, so $\ov{\phi}(\pi(x))=\phi(x)$,
 which shows that $\ov{\phi}\circ\pi=\phi$.  We now claim that
 $\ov{\phi}$ is a homomorphism.  Indeed, the additive and
 multiplicative identity elements in $R/I$ are $\pi(0)$ and $\pi(1)$,
 and using $\ov{\phi}\circ\pi=\phi$ we see that these are sent by
 $\ov{\phi}$ to $0$ and $1$ in $S$.  Next, consider elements
 $A,B\in R/I$.  We can then choose $a,b\in R$ with $A=\pi(a)$ and
 $B=\pi(b)$.  It then follows that $A+B=\pi(a+b)$, and so 
 \[ \ov{\phi}(A+B)=\ov{\phi}(\pi(a+b))=\phi(a+b)=\phi(a)+\phi(b)
     =\ov{\phi}(\pi(a))+\ov{\phi}(\pi(b))
     =\ov{\phi}(A)+\ov{\phi}(B).
 \]
 A similar argument shows that
 $\ov{\phi}(AB)=\ov{\phi}(A)\ov{\phi}(B)$, so $\ov{\phi}$ is a
 homomorphism as claimed.

 Now suppose that $\phi$ is surjective and $\ker(\phi)=I$.  For each
 $c\in S$, we put $\psi(c)=\{a\in R\st \phi(a)=c\}\sse R$.  We claim
 that $\psi(c)$ is a coset of $I$.  Indeed, as $\phi$ is surjective we
 see that $\psi(c)$ is nonempty, so we can choose $a\in\psi(c)$, so
 $\phi(a)=c$.  If $u\in I$ then $\phi(u)=0$ so
 $\phi(a+u)=\phi(a)+\phi(u)=c+0=c$, so $a+u\in\psi(c)$.  It follows
 that $a+I\sse\psi(c)$.  Conversely, if $b\in\psi(c)$ then
 $\phi(b)=c=\phi(a)$, so $\phi(b-a)=\phi(b)-\phi(a)=c-c=0$, so
 $b-a\in\ker(\phi)=I$, so $b\in a+I$.  This shows that
 $\psi(c)\in R/I$, so we have defined a function $\psi\:S\to R/I$.
 One can see directly from the definitions that $\psi(\ov{\phi}(A))=A$
 and $\ov{\phi}(\psi(c))=c$, so $\psi$ is inverse to $\ov{\phi}$.
 This means that $\ov{\phi}$ is a bijective homomorphism and thus an
 isomorphism. 
\end{proof}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-F-four-ideal}
 Find an ideal $I\leq\Z[x]$ such that $\Z[x]/I$ is isomorphic to the
 field $\F_4$ in Example~\ref{eg-F-four}.
\end{exercise}
\begin{solution}
 Recall that $\F_4=\{0,1,\al,\al^2\}$ with $\al^2=\al^{-1}=1+\al$.
 Define $\phi\:\Z[x]\to\F_4$ by 
 \[ \phi(a_0+a_1x+\dotsb+a_dx^d) = 
     \ov{a_0}+\ov{a_1}\al+\dotsb+\ov{a_d}\al^d.
 \]
 This is clearly a homomorphism.  It satisfies $\phi(0)=0$ and
 $\phi(1)=1$ and $\phi(x)=\al$ and $\phi(x^2)=\al^2$, so every element
 of $\F_4$ is in the image of $\phi$, so $\phi$ is surjective.  Let
 $I$ be the kernel of $\phi$.  Proposition~\ref{prop-induced-hom} then
 gives us an induced isomorphism $\ov{\phi}\:\Z[x]/I\to\F_4$.  One can
 check that $I$ can be described more explicitly as 
 \[ I = \{f(x)\in\Z[x]\st f(x)=2g(x)+(x^2+x+1)h(x)
           \text{ for some } g(x),h(x)\in\Z[x]\}.
 \]
\end{solution}
\begin{exercise}\exlabel{ex-ideals-twelve}
 Find all the principal ideals in the ring $\Z/12\Z$.
\end{exercise}
\begin{solution}
 Write 
 \[ R=\Z/12\Z=\{0,1,2,3,4,5,6,7,8,9,10,11\}. \]
 The principal ideals are as follows:
 \begin{align*}
  R.0 &= \{0\} \\
  R.1 &= \{0,1,2,3,4,5,6,7,8,9,10,11\} = R.5 = R.7 = R.11 \\
  R.2 &= \{0,2,4,6,8,10\} = R.10 \\
  R.3 &= \{0,3,6,9\} = R.9 \\
  R.4 &= \{0,4,8\} = R.8 \\
  R.6 &= \{0,6\}.
 \end{align*}
 In fact, it can be shown that every ideal in $\Z/n\Z$ is principal,
 so the above list actually contains all ideals in $R$.
\end{solution}

\section{Polynomials over fields}
\label{sec-poly}

\begin{definition}\lbl{defn-poly-degree}
 Consider a polynomial $f(t)=\sum_{i=0}^da_it^i$.  The \emph{degree}
 of $f(t)$ is the largest $d$ for which $a_d$ is nonzero.  (This is
 only meaningful if $f(t)$ is nonzero; the degree of the zero
 polynomial is undefined.)  If this coefficient $a_d$ is equal to one,
 we say that $f(t)$ is \emph{monic}.
\end{definition}

\begin{remark}\lbl{rem-degree}
 We now have three different (but related) meanings for the word
 ``degree''.  The degree $[L:K]$ of a field extension was introduced
 in Definition~\ref{defn-extension-degree}, and the degree of a
 homomorphism $\phi\:K\to L$ in Definition~\ref{defn-hom-degree}.
 These are related by the fact that $\deg(\phi)=[L:\phi(K)]$, and
 $[L:K]$ is the degree of the inclusion homomorphism $K\to L$.  The
 connection between these and Definition~\ref{defn-poly-degree} will
 emerge in Section~\ref{sec-adjoining}.
\end{remark}

\begin{example}\lbl{eg-poly-degree}
 The polynomial $f(t)=1+2t+3t^3\in\Q[t]$ has degree $3$ and is not
 monic.  The polynomial $i+t^6\in\C[t]$ is monic and has degree $6$.   
\end{example}

\begin{lemma}\lbl{lem-deg-prod}
 If $f(t)$ and $g(t)$ are nonzero polynomials over a field $K$ then
 $f(t)g(t)\neq 0$ and $\deg(f(t)g(t))=\deg(f(t))+\deg(g(t))$.
 Moreover, if $f(t)$ and $g(t)$ are both monic then so is $f(t)g(t)$. 
\end{lemma}
\begin{proof}
 Put $d=\deg(f(t))$ and $e=\deg(g(t))$, so
 $f(t)=at^d+\text{lower terms}$ and $g(t)=bt^e+\text{lower terms}$ for
 some $a,b\in K$ with $a\neq 0$ and $b\neq 0$.  We then have
 $f(t)g(t)=abt^{d+e}+\text{lower terms}$, and $ab\neq 0$ by
 Lemma~\ref{lem-domain}, so $f(t)g(t)\neq 0$ and
 $\deg(f(t)g(t))=d+e$.  The claim about the monic case is also clear
 now. 
\end{proof}

\begin{proposition}\lbl{prop-poly-division}
 Let $f(t)$ and $g(t)$ be polynomials over a field $K$, with
 $f(t)\neq 0$.  Then there is a unique pair of polynomials
 $(q(t),r(t))$ such that  
 \begin{itemize}
  \item $g(t)=f(t)q(t)+r(t)$
  \item Either $r(t)=0$ or $\deg(r(t))<\deg(f(t))$.
 \end{itemize}
\end{proposition}

We can rephrase this result as saying that $q(t)$ and $r(t)$ are the
quotient and remainder when $g(t)$ is divided by $f(t)$.  One way to
prove it would be to explain and analyse the whole process of long
division of polynomials.  The proof below is essentially equivalent to
that, but arranged a little differently.  We will only analyse the
first step of long division explicitly, and the remaining steps will
be handled implicitly by the inductive structure of the argument.

\begin{proof}[Proof of Proposition~\ref{prop-poly-division}]
 First suppose we have pairs $(q_1(t),r_1(t))$ and $(q_2(t),r_2(t))$
 that both have the stated properties.  We then have 
 \[ f(t)q_1(t) + r_1(t) = g(t) = f(t)q_2(t) + r_2(t), \]
 which can be rearranged to give
 \[ f(t)(q_1(t)-q_2(t)) = r_2(t)-r_1(t). \]
 Suppose that $q_1(t)-q_2(t)\neq 0$.  It follows that the left hand
 side is nonzero, with degree at least as large as $\deg(f(t))$, but
 the right hand side is either zero or has degree less than
 $\deg(f(t))$, which is a contradiction.  We must therefore have
 $q_1(t)-q_2(t)=0$, and thus $r_1(t)-r_2(t)=-f(t)(q_1(t)-q_2(t))=0$,
 so $(q_1,r_1)=(q_2,r_2)$.  Thus, the pair $(q,r)$ is unique if it
 exists.  In the case $g(t)=0$ we have $q(t)=r(t)=0$. 

 From now on we assume that $g(t)\neq 0$, and work by induction on the
 degree of $g(t)$.  Put $m=\deg(f(t))$.  If $\deg(g(t))<m$ then we can
 take $q(t)=0$ and $r(t)=g(t)$; this starts the induction.  Now
 suppose that $\deg(g(t))=n\geq m$.  We then have $g(t)=at^n+\text{
  lower terms }$ and $f(t)=bt^m+\text{ lower terms }$ for some nonzero
 constants $a,b\in K$.  Put $q_0(t)=ab^{-1}t^{n-m}$ and
 $g_1(t)=g(t)-q_0(t)f(t)$.  The coefficient of $t^n$ in $g_1(t)$ is
 $a-ab^{-1}b=0$, so $g_1(t)$ is zero or has degree less than $n$.  By
 induction, we can write $g_1(t)=f(t)q_1(t)+r(t)$ for some $q_1(t)$
 and $r_1(t)$, where $r(t)$ is zero or has degree less than $m$.
 Now put $q(t)=q_0(t)+q_1(t)$ and observe that $g(t)=f(t)q(t)+r(t)$ as
 required. 
\end{proof}

\begin{proposition}\lbl{prop-poly-subfield}
 Let $L$ be a field and let $K$ be a subfield.  Suppose we have
 polynomials $f(t)\in K[t]\sm\{0\}$ and $g(t)\in L[t]$ such that
 $f(t)g(t)\in K[t]$.  Then $g(t)\in K[t]$ also.
\end{proposition}

We will give two proofs of this.  The first just considers the
coefficients directly: 
\begin{proof}
 The claim is clear if $g(t)=0$, so we may assume that $g(t)\neq 0$.
 Put $h(t)=f(t)g(t)\in K[t]$.   We can write  
 \begin{align*}
  f(t) &= \sum_{i\geq 0} a_i x^i \\
  g(t) &= \sum_{j\geq 0} b_j x^j \\
  h(t) &= \sum_{k\geq 0} c_k x^k,
 \end{align*}
 where $a_i\in K$ and $b_j\in L$ and $c_k\in K$.  The relation
 $f(t)g(t)=h(t)$ reduces to $c_k=\sum_{i+j=k}a_ib_j$.  Let $m$ be the
 smallest integer such that $a_m\neq 0$.  We then find that
 $c_0=\dotsb=c_{m-1}=0$ and 
 \begin{align*}
  c_m &= a_mb_0 \\
  c_{m+1} &= a_{m+1}b_0+a_mb_1 \\
  c_{m+2} &= a_{m+2}b_0+a_{m+1}b_1+a_mb_2 
 \end{align*}
 and so on.  This can be rearranged as
 \begin{align*}
  b_0 &= c_m/a_m \\
  b_1 &= (c_{m+1}-a_{m+1}b_0)/a_m \\
  b_2 &= (c_{m+2}-a_{m+2}b_0-a_{m+1}b_1)/a_m 
 \end{align*}
 and so on.  As $a_m,c_m\in K$ the first line shows that $b_0\in K$.
 This means that everything appearing on the right on the second line
 is in $K$, so $b_1\in K$.  This means that everything appearing on
 the right on the third line is in $K$, so $b_2\in K$.  By continuing
 in the same way, we see that $b_j\in K$ for all $j$, so
 $g(t)\in K[t]$ as claimed.
\end{proof}

Another approach is to compare the division algorithm in $K[t]$ with
the division algorithm in $L[t]$ and argue that they must give the
same answer.  Details are as follows:
\begin{proof}[Alternative proof]
 Put $h(t)=f(t)g(t)\in K[t]$.  By the proposition (applied to $K[t]$),
 there is a unique pair $(q(t),r(t))$ of polynomials in $K[t]$ with
 $h(t)=f(t)q(t)+r(t)$ and $r(t)=0$ or $\deg(r(t))<\deg(f(t))$.  As we
 also have $h(t)=f(t)g(t)$ we see that $f(t)(g(t)-q(t))=r(t)$.  If
 $g(t)-q(t)$ were nonzero then we would have
 $\deg(r(t))=\deg(g(t)-q(t))+\deg(f(t))\geq\deg(f(t))$, contrary to
 assumption.  So we must have $g(t)-q(t)=0$, so $g(t)=q(t)$.  By
 construction $q(t)\in K[t]$, so $g(t)\in K[t]$ as claimed.
\end{proof}

\begin{proposition}\lbl{prop-Kx-pid}
 Let $K$ be a field, and let $I$ be an ideal in $K[x]$.  Then $I$ is
 principal.  More precisely, we either have $I=\{0\}$ or there is a
 unique monic polynomial $f(x)$ such that $I=K[x].f(x)$.
\end{proposition}

%%% End of Lecture 4

\begin{proof}
 If $I=\{0\}$ then there is nothing more that we need to say, so
 suppose that $I\neq\{0\}$.  Then $I$ contains some nonzero
 polynomials, each of which has a well-defined degree.  Let $\tf(x)$
 be a nonzero polynomial in $I$ whose degree is as small as possible.
 Put $d=\deg(\tf(x))$, so $\tf(x)=ax^d+\text{lower terms}$ for some
 nonzero element $a\in K$.  Put $f(x)=a^{-1}\tf(x)$, so $f(x)$ is a
 monic polynomial of degree $d$.  The constant polynomial $a^{-1}$ is
 an element of $K[x]$, and $\tf(x)\in I$, so Axiom~(c) tells us that
 $f(x)\in I$.  It also follows using Axiom~(c) that every multiple of
 $f(x)$ lies in $I$, so $K[x].f(x)\sse I$.  Conversely, let $g(x)$ be
 an arbitrary element of $I$.  By Proposition~\ref{prop-poly-division}
 we have $g(x)=f(x)q(x)+r(x)$ for some $q(x),r(x)\in K[x]$ with
 $r(x)=0$ or $\deg(r(x))<d$.  Now $r(x)=g(x)+(-q(x)).f(x)$.  Using
 Axiom~(c) we see that $(-q(x)).f(x)\in I$, and also $g(x)\in I$ by
 assumption, so $r(x)\in I$ by Axiom~(b).  Now $f(x)$ was chosen to
 have minimal degree among the nonzero elements of $I$, so we cannot
 have $\deg(r(x))<d$, so we must have $r(x)=0$.  The equation
 $g(x)=f(x)q(x)+r(x)$ therefore reduces to $g(x)=f(x)q(x)$, so
 $g(x)\in K[x].f(x)$.  This shows that $I\sse K[x].f(x)$ and we have
 already proved the reverse inclusion, so $I=K[x].f(x)$ as claimed.

 All that is left is to prove that $f(x)$ is the \emph{unique} monic
 polynomial that generates $I$.  Suppose that we also have
 $I=K[x].g(x)$ for some monic polynomial $g(x)$, with $\deg(g(x))=e$
 say.  Then certainly $g(x)\in I$, so as above we have $g(x)=f(x)q(x)$
 for some polynomial $q(x)$.  By Lemma~\ref{lem-deg-prod} we have
 $e-d=\deg(q(x))\geq 0$, so $e\geq d$.  Similarly, we have
 $f(x)\in I=K[x].g(x)$, so we must have $f(x)=g(x)p(x)$ for some
 polynomial $p(x)$.  By Lemma~\ref{lem-deg-prod} again we have
 $d-e=\deg(p(x))\geq 0$, so $d\geq e$.  It now follows that $d=e$ and
 $\deg(p(x))=\deg(q(x))=0$, so $p$ and $q$ are constants.  As $f(x)$
 is monic and $p.f(x)=g(x)$ is also monic, we must have $p=1$, so
 $f(x)=g(x)$ as required.
\end{proof}


\begin{definition}\lbl{defn-gcd}
 Let $K$ be a field, and let $f(x)$ and $g(x)$ be nonzero polynomials
 in $K[x]$.
 \begin{itemize}
  \item[(a)] The \emph{least common multiple} of $f(x)$ and $g(x)$ is
   the monic generator of the ideal $K[x].f(x)\cap K[x].g(x)$.  We
   write $\lcm(f(x),g(x))$ for this polynomial.
  \item[(b)] The \emph{greatest common divisor} of $f(x)$ and $g(x)$
   is the monic generator of the ideal $K[x].f(x)+K[x].g(x)$.  We
   write $\gcd(f(x),g(x))$ for this polynomial.
 \end{itemize}
 (Proposition~\ref{prop-ideal-ops} shows that the sets considered
 really are ideals.)
\end{definition}

\begin{proposition}\lbl{prop-gcd}
 Let $f(x)$ and $g(x)$ be as above.
 \begin{itemize}
  \item[(a)] The polynomial $\lcm(f(x),g(x))$ is divisible by both
   $f(x)$ and $g(x)$.  Moreover, is $h(x)$ is another polynomial that
   is divisible by both $f(x)$ and $g(x)$, then $h(x)$ is also
   divisible by $\lcm(f(x),g(x))$.
  \item[(b)] Both $f(x)$ and $g(x)$ are divisible by
   $\gcd(f(x),g(x))$.  Moreover, if $k(x)$ is another polynomial such
   that both $f(x)$ and $g(x)$ are divisible by $k(x)$, then
   $\gcd(f(x),g(x))$ is divisible by $k(x)$.
  \item[(c)] If we let $\ov{f}(x)$ and $\ov{g}(x)$ be the polynomials
   such that $f(x)=\ov{f}(x)\gcd(f(x),g(x))$ and
   $g(x)=\ov{g}(x)\gcd(f(x),g(x))$, then 
   \[ \lcm(f(x),g(x))=\ov{f}(x)\ov{g}(x)\gcd(f(x),g(x))
       = \ov{f}(x)g(x) = f(x)\ov{g}(x).
   \]
 \end{itemize}
\end{proposition}
\begin{proof}
 For brevity we will write $p=\lcm(f,g)$ and $q=\gcd(f,g)$.  

 By the definition of $p$ we have $K[x]f\cap K[x]g=K[x]p$.  In
 particular, we have $p\in K[x]f\cap K[x]g$, so we can write $p=sf=tg$
 for some $s,t\in K[x]$.  Moreover, if $h$ is also divisible by both
 $f$ and $g$ then $h\in K[x]f\cap K[x]g=K[x]p$ so $h$ is divisible by
 $p$.  This proves~(a).

 Next, we also have $q\in K[x]q=K[x]f+K[x]g$, so we can write
 $q=mf+ng$ for some $m,n\in K[x]$.  Moreover, as
 $f=f+0\in K[x]f+K[x]g=K[x]q$, we have $f=\ov{f}q$ for some polynomial
 $\ov{f}\in K[x]$.  Similarly, we have $g=\ov{g}q$ for some
 $\ov{g}\in K[x]$.

 Now suppose we have another polynomial $k$ such that both $f$ and $g$
 are divisible by $k$, say $f=uk$ and $g=vk$.  We then have
 $q=mf+ng=muk+nvk=(mu+nv)k$, so $q$ is divisible by $k$.  This
 proves~(b). 

 Note also that we have $q=mf+ng=m\ov{f}q+n\ov{g}q$, so
 $(m\ov{f}+n\ov{g}-1)q=0$.  As $q\neq 0$ we can deduce (using
 Lemma~\ref{lem-deg-prod}) that $m\ov{f}+n\ov{g}-1=0$, so
 $m\ov{f}+n\ov{g}=1$.  We can also rewrite the equations $p=sf=tg$ as
 $p=s\ov{f}q=t\ov{g}q$. 

 Now consider the polynomial $r=\ov{f}\ov{g}q=\ov{f}g=f\ov{g}$.  This
 is visibly a common multiple of $f$ and $g$, so it must be a multiple
 of $p$.  Now multiply the equation $1=m\ov{f}+n\ov{g}$ by $p$ and use
 $p=s\ov{f}q=t\ov{g}q$ to get
 \[ p = m\ov{f}p+n\ov{g}p = m\ov{f}t\ov{g}q+n\ov{g}s\ov{f}q = 
     (mt+ns)\ov{f}\ov{g}q = (mt+ns)r.
 \]
 In particular, we see that $p$ is a multiple of $r$.  As $p$ and $r$
 are monic polynomials and are multiples of each other, they must be
 the same.  This proves~(c).
\end{proof}

\begin{remark}\label{rem-euclid-algo}
 The gcd of two polynomials $f_0(x)$ and $f_1(x)$ can be calculated by
 the following procedure, called the \emph{Euclidean algorithm}.  We
 may assume that $\deg(f_1(x))\leq\deg(f_0(x))$ (otherwise just
 exchange the two polynomials) and that both polynomials are monic
 (otherwise just multiply by suitable constants).  Suppose that we
 have defined $f_0(x),\dotsc,f_m(x)$, and $f_m(x)\neq 0$.  We then
 write $f_{m-1}(x)=f_m(x)q(x)+r(x)$, with $r(x)=0$ or
 $\deg(r(x))<\deg(f_m(x))$.  If $r(x)\neq 0$ then we define
 $f_{m+1}(x)$ to be $r(x)$ divided by its top coefficient (so that
 $f_{m+1}(x)$ is monic).  This ensures that the ideal generated by
 $f_{m+1}(x)$ and $f_m(x)$ is the same as the ideal generated by
 $f_m(x)$ and $f_{m-1}(x)$.  We then continue the procedure in the
 same way.  On the other hand, if $r(x)=0$ then the required gcd is
 just $f_m(x)$.
\end{remark}

\begin{definition}\lbl{defn-irreducible}
 Let $K$ be a field.  A nonconstant polynomial $p(x)\in K[x]$ is
 \emph{reducible over $K$} if it can be written as
 $p(x)=f(x)g(x)$ with $\deg(f(x))>0$ and $\deg(g(x))>0$.  If not, we
 say that $p(x)$ is \emph{irreducible over $K$}.  We write
 $\CP_K$ (or just $\CP$, if $K$ is understood from the context) for
 the set of all irreducible monic polynomials over $K$.
\end{definition}
\begin{remark}\lbl{rem-irreducible-monic}
 Suppose that $p(x)$ is a monic polynomial of degree $d$, and that
 $p(x)=f(x)g(x)$.  If the leading term of $f(x)$ is $ax^k$, then the
 leading term of $g(x)$ must be $a^{-1}x^{d-k}$.  It follows that the
 polynomials $\ov{f}(x)=a^{-1}f(x)$ and $\ov{g}(x)=ag(x)$ are both
 monic, and they satisfy $p(x)=\ov{f}(x)\ov{g}(x)$.  Conversely, if
 $p(x)$ has no factorisation $p(x)=\ov{f}(x)\ov{g}(x)$ with
 $\ov{f}(x)$ and $\ov{g}(x)$ monic and nonconstant, then $p(x)$ is
 irreducible. 
\end{remark}

\begin{example}\lbl{eg-linear-irreducible}
 Any polynomial $p(x)=ax+b$ of degree one is irreducible.  Indeed, if
 $\deg(f(x))\geq 1$ and $\deg(g(x))\geq 1$ then $f(x)g(x)$ has degree
 at least two and so cannot be equal to $p(x)$.
\end{example}

\begin{example}\lbl{eg-misc-irreducible}
 The polynomial $p(x)=x^2+1$ is reducible over $\C$, because it can be
 factored as $p(x)=(x+i)(x-i)$.  However, we claim that $p(x)$ is
 irreducible over $\R$.  Indeed, by
 Remark~\ref{rem-irreducible-monic}, it is enough to show that there
 is no factorisation $p(x)=(x+a)(x+b)$ with $a,b\in\R$.  If there
 were such a factorisation, we would have $p(-a)=(-a+a)(-a+b)=0$, but
 also $p(-a)=(-a)^2+1=a^2+1$, so we would have $a^2+1=0$, which is
 impossible for $a\in\R$.  Thus $p(x)$ is irreducible after all.
\end{example}

We next discuss Eisenstein's criterion, which is a useful test for
irreducibility of polynomials over $\Q$.

\begin{definition}\lbl{defn-eisenstein}
 Let $p$ be a prime number.  An \emph{Eisenstein polynomial} for $p$
 is a polynomial $q(x)=a_0+a_1x+\dotsb+a_{d-1}x^{d-1}+x^d$ such that 
 \begin{itemize}
  \item[(a)] All the coefficients $a_0,\dotsc,a_{d-1}$ are integers,
   and are divisible by $p$.
  \item[(b)] $a_0$ is not divisible by $p^2$.
 \end{itemize}
\end{definition}

\begin{proposition}\lbl{prop-eisenstein}
 If $q(x)$ is an Eisenstein polynomial for some prime $p$, then $q(x)$
 is irreducible over $\Q$.
\end{proposition}

Before proving this, we will need some preliminary definitions and
auxiliary results.  Note that the proposition makes it easy to
generate many examples of irreducible polynomials over $\Q$.  For
example $x^{11}+10x^2-25x+35$ is Eisenstein for $p=5$ and so is
irreducible over $\Q$.

\begin{remark}\lbl{rem-eisenstein-shift}
 For $c\in K$ and $f(x)\in K[x]$, it is easy to see that $f(x)$ is
 reducible if and only if $f(x+c)$ is irreducible.

 The polynomial $f(x)=x^4+x^3+x^2+x+1$ does not satisfy Eisenstein's
 criterion at any prime, but the polynomial
 $f(x+1)=x^4+5x^3+10x^2+10x+5$ satisfies the criterion at $p=5$. It
 follows that $f(x+1)$ is irreducible over $\Q$, so $f(x)$ is
 irreducible.  This trick is often useful.
\end{remark}

\begin{definition}\lbl{defn-primitive}
 Consider a polynomial $f(x)=\sum_{i=0}^da_ix^i\in\Z[x]$.  We say that
 $f(x)$ is \emph{primitive} if the greatest common divisor of
 $a_0,\dotsc,a_d$ is equal to one, or equivalently, there is no prime
 that divides all these coefficients.
\end{definition}
\begin{remark}\lbl{rem-primitive}
 We can reduce the elements $a_i$ modulo $p$ to get elements
 $\pi_p(a_i)\in\F_p$.  We then define
 $\pi_p(f)(x)=\sum_i\pi_p(a_i)x^i\in\F_p[x]$.  This will be zero if
 and only if all the original coefficients $a_i$ are divisible by
 $p$.  Thus, we see that $f$ is primitive if and only if
 $\pi_p(f)\neq 0$ for all $p$.
\end{remark}
\begin{lemma}\lbl{lem-primitive-product}
 Suppose that $f(x),g(x)\in\Z[x]$ are both primitive.  Then so is
 $f(x)g(x)$.  
\end{lemma}
\begin{proof}
 Consider a prime $p$.  By the above remark we have $\pi_p(f)\neq 0$
 and $\pi_p(g)\neq 0$.  We also know from
 Proposition~\ref{prop-Zn-field} that $\F_p$ is a field, so
 $\pi_p(f)\pi_p(g)\neq 0$ by Lemma~\ref{lem-deg-prod}.  Moreover, it
 is clear that $\pi_p(fg)=\pi_p(f)\pi_p(g)$, so $\pi_p(fg)\neq 0$.  As
 this holds for all $p$ we deduce that $fg$ is primitive, as claimed. 
\end{proof}
\begin{proposition}\lbl{prop-gauss}
 Suppose that $q(x)$ is a monic polynomial in $\Z[x]$, and that there
 is a factorisation $q(x)=f(x)g(x)$ with $f$ and $g$ monic polynomials
 in $\Q[x]$.  Then in fact $f$ and $g$ lie in $\Z[x]$.
\end{proposition}
\begin{proof}
 Let $u$ be the least common multiple of the denominators of the
 coefficients of $f$, or equivalently the smallest positive integer
 such that the polynomial $\ov{f}(x)=uf(x)$ lies in $\Z[x]$.  We claim
 that $\ov{f}$ is primitive.  Indeed, if it were not primitive, there
 would be a prime $p$ that divides all the coefficients of $\ov{f}$, and then
 $(u/p).f$ would also be in $\Z[x]$, contradicting the definition of
 $u$.  So $\ov{f}$ must be primitive after all.  Similarly, we can
 find an integer $v>0$ such that the polynomial $\ov{g}(x)=vg(x)$ is
 integral and primitive.  Now put $\ov{q}(x)=\ov{f}(x)\ov{g}(x)$, and
 note from Lemma~\ref{lem-primitive-product} that $\ov{q}(x)$ is
 primitive.  On the other hand, we have 
 $\ov{q}(x)=uvf(x)g(x)=uvq(x)$, with $uv\in\N$ and $q(x)\in\Z[x]$.  It
 follows that any prime dividing $uv$ divides all the coefficients of
 $\ov{q}(x)$, which is impossible because $\ov{q}(x)$ is primitive.
 It follows that there cannot be any primes dividing $uv$, so we must
 have $u=v=1$.  Thus $f(x)=\ov{f}(x)\in\Z[x]$ and
 $g(x)=\ov{g}(x)\in\Z[x]$ as claimed.
\end{proof}

\begin{lemma}\lbl{lem-monomial-factors}
 Let $K$ be a field, and let $f(x)$ and $g(x)$ be polynomials over $K$
 such that $f(x)g(x)=x^d$ for some $d\geq 0$.  Then we have
 $f(x)=ax^k$ and $g(x)=a^{-1}x^{d-k}$ for some $a$ and $k$ with
 $a\in K^\tm$ and $0\leq k\leq d$.  In particular, if $f(x)$ is monic
 then $f(x)=x^k$ and $g(x)=x^{d-k}$.
\end{lemma}
\begin{proof}
 Let $ax^k$ be the highest nonzero term in $f(x)$, and let $a'x^{k'}$
 be the lowest one.  Let $bx^j$ be the highest nonzero term in $g(x)$,
 and let $b'x^{j'}$ be the lowest one.  Then Lemma~\ref{lem-deg-prod}
 tells us that the highest term in $f(x)g(x)$ is $abx^{k+j}$, and
 a similar argument shows that the lowest one is $a'b'x^{k'+j'}$.  As
 $f(x)g(x)$ has only the single term $x^d$, we must have $ab=a'b'=1$
 and $j+k=j'+k'$.  As $j\geq j'$ and $k\geq k'$ this implies that
 $j=j'$ and $k=k'$, and thus that $f(x)=ax^k$ and $g(x)=bx^j$.  It is
 now clear that we must have $0\leq k\leq d$ and $j=d-k$ and
 $b=a^{-1}$.   
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop-eisenstein}]
 Let $q(x)$ be an Eisenstein polynomial for the prime $p$, of degree
 $d$ say.  Suppose that $q(x)=f(x)g(x)$, where $f(x)$ and $g(x)$ are
 monic polynomials in $\Q[x]$, with $\deg(f(x))=k>0$ and
 $\deg(g(x))=d-k>0$.  We see from Proposition~\ref{prop-gauss} that
 $f(x),g(x)\in\Z[x]$.  We can therefore consider the mod $p$
 reductions $\pi_p(f),\pi_p(g)\in\F_p[x]$.  These are monic
 polynomials of degrees $k$ and $d-k$ respectively.  They satisfy
 $\pi_p(f)\pi_p(g)=\pi_p(fg)=\pi_p(q)$, and from
 Definition~\ref{defn-eisenstein} it is clear that $\pi_p(q)=x^d$.  We
 can thus invoke Lemma~\ref{lem-monomial-factors} to see that
 $\pi_p(f)=x^k$ and $\pi_p(g)=x^{d-k}$.  In particular, we see that
 the constant terms $f(0)$ and $g(0)$ are divisible by $p$.  It
 follows that the constant term $q(0)=f(0)g(0)$ is divisible by $p^2$,
 which contradicts the definition of an Eisenstein polynomial.  It
 follows that $q(x)$ must be irreducible as claimed.
\end{proof}

\begin{proposition}\lbl{prop-irreducibles-prime}
 Let $K$ be a field, and let $q(x)$ be an irreducible monic polynomial
 over $K$.  Let $f(x)$ and $g(x)$ be polynomials in $K[x]$ that are
 not divisible by $q(x)$.
 \begin{itemize}
  \item[(a)] There exist polynomials $a(x)$ and $b(x)$ with
   $a(x)f(x)+b(x)q(x)=1$.  
  \item[(b)] The product $f(x)g(x)$ is again not divisible by $q(x)$.   
 \end{itemize}
\end{proposition}
\begin{proof}
 For part~(a), put $u(x)=\gcd(f(x),q(x))$.  We know from
 Proposition~\ref{prop-gcd} that $u(x)$ can be written in the form
 $u(x)=a(x)f(x)+b(x)q(x)$, so it will be enough to show that $u=1$.
 We also know from the same proposition that $u(x)$ divides both
 $q(x)$ and $f(x)$.  As $q(x)$ is irreducible, its only monic divisors
 are $1$ and $q(x)$ itself, so either $u(x)=q(x)$ or $u(x)=1$.  We
 also know that $u(x)$ divides $f(x)$ but $q(x)$ does not divide
 $f(x)$, so we must have $u(x)=1$ as required.

 By the same argument, there exist polynomials $c(x)$ and $d(x)$ such
 that $c(x)g(x)+d(x)q(x)=1$.  We can multiply the equation $af+bq=1$
 by $cg+dq=1$ to get $acfg+(adf+bcg+bdq)q=1$.  Now suppose for a
 contradiction that $fg$ is divisible by $q$, say $fg=eq$.  We could
 then rewrite the previous equation as $(ace+adf+bcg+bdq)q=1$.
 This means that the polynomial $v=ace+adf+bcg+bdq$ is nonzero and
 satisfies $\deg(v)+\deg(q)=0$ so $\deg(v)=\deg(q)=0$.  This is
 impossible because $q$ is irreducible and therefore (by definition)
 not constant.
\end{proof}
\begin{corollary}\lbl{cor-prime-multi}
 Suppose that $q(x)$ is monic and irreducible and that none of
 $f_1(x),\dotsc,f_k(x)$ is divisible by $q(x)$; then the product
 $f(x)=\prod_{i=1}^kf_i(x)$ is also not divisible by $q(x)$.
\end{corollary}
\begin{proof}
 We can argue by induction on $k$.  The case $k=1$ is obvious, and the 
 case $k=2$ is just part~(b) above.  More generally, part~(b) can be
 used to deduce the case $k=m$ from the case $k=m-1$.
\end{proof}
\begin{corollary}\lbl{cor-quotient-field}
 If $q(x)$ is monic and irreducible then the quotient ring
 $L=K[x]/(K[x].q(x))$ is a field.
\end{corollary}
\begin{proof}
 Put $I=K[x].q(x)$, and let $\pi\:K[x]\to L$ be the quotient map, as
 usual.  Suppose that $F$ is a nonzero element of $L$.  We can then
 find $f(x)\in K[x]$ such that $F=\pi(f)$.  As $F$ is not the zero
 element we see that $f\not\in I$.  Part~(a) of
 Proposition~\ref{prop-irreducibles-prime} tells us that there exist
 polynomials $a$ and $b$ such that $af+bq=1$.  We can apply $\pi$ to
 this to get $\pi(a)\pi(f)+\pi(b)\pi(q)=\pi(1)$, but $q\in I$ so
 $\pi(q)=0$, so we get $\pi(a)F=\pi(1)$.  Here $\pi(1)$ is the
 multiplicative identity element for the quotient ring $L$, so we see
 that $\pi(a)$ is an inverse for $F$.  This shows that all nonzero
 elements of $L$ are invertible.  Moreover, as $q(x)$ is irreducible
 it is nonconstant and so does not divide $1_{K[x]}$, so $1\neq 0$ in
 $L$.  This means that $L$ is a field as claimed.
\end{proof}

\begin{proposition}\lbl{prop-ufd}
 Let $K$ be a field, let $\CM$ be the set of monic polynomials in
 $K[x]$, and let $\CP$ be the subset of irreducible polynomials (as
 before).  Then every element of $\CM$ can be written in a unique way
 as a product of powers of elements of $\CP$.  More precisely, let
 $\CN$ be the set of functions $v\:\CP\to\N$ such that
 $\{q\in\CP\st v(q)>0\}$ is finite.  Then there is a bijection
 $\mu\:\CN\to\CM$ given by $\mu(v)=\prod_{q\in\CP}q^{v(q)}$, with
 inverse $\lm\:\CM\to\CN$ given 
 \[ \lm(f)(q) = \max\{n\in\N\st f \text{ is divisible by } q^n\}. \]
\end{proposition}
\begin{proof}
 First consider a polynomial $f\in\CM$.  We will prove by induction on
 $\deg(f)$ that $f=\mu(v)$ for some $v$.  If $\deg(f)=0$ then we must
 have $f=1$ (because $f$ is monic) and so $f=\mu(0)$.  This starts the
 induction.  Now suppose that $\deg(f)=d>0$, and that the statement is
 true for all monic polynomials of degree less than $d$.  If $f$ is
 reducible then we can write $f=gh$ with $\deg(g)<d$ and $\deg(h)<d$.
 By the induction hypothesis there are elements $t,u\in\CN$ with
 $\mu(t)=g$ and $\mu(u)=h$, and it follows that $\mu(t+u)=gh=f$ as
 required.  On the other hand, if $f$ is irreducible, we have
 $f\in\CP$.  We can therefore define $v\in\CN$ by $v(f)=1$ and
 $v(q)=0$ for all $q\neq f$, and we find that $\mu(v)=f$.  This
 completes the induction step, so we see that $\mu$ is surjective.  

 Now suppose that $q\in\CP$ and $v\in\CN$ and that $v(q)=0$.  We claim
 that $\mu(v)$ is not divisible by $q$.  Indeed, by the definition of
 $\CN$ there is a finite set $r_1,\dotsc,r_k$ of distinct irreducibles
 such that $v(r_i)>0$ for all $i$, and $v(s)=0$ for all other
 irreducibles, so $\mu(v)=\prod_{i=1}^kr_i^{v(r_i)}$.  As $v(r_i)>0$
 and $v(q)=0$ we have $r_i\neq q$.  As $r_i$ and $q$ are both monic
 irreducibles, it follows that $r_i$ cannot be divisible by $q$.  It
 follows using Corollary~\ref{cor-prime-multi} that $\mu(v)$ is not
 divisible by $q$ either.

 We now claim that for any $v$ we have $\lm(\mu(v))=v$.  Equivalently,
 we claim that $\mu(v)$ is divisible by $q^{v(q)}$, but not by any
 higher power of $q$.  To see this, define $w\in\CN$ by $w(q)=0$, and
 $w(r)=v(r)$ for all $r\neq q$.  From this it is clear that
 $\mu(v)=q^{v(q)}\mu(w)$, so $\mu(v)$ is certainly divisible by
 $q^{v(q)}$.  Suppose that $\mu(v)$ is in fact divisible by
 $q^{v(q)+1}$, say $\mu(v)=q^{v(q)+1}f$.  We then have
 $q^{v(q)}(\mu(w)-qf)=0$, so $\mu(w)=qf$.  This is impossible by the
 previous paragraph, because $w(q)=0$.  It follows that
 $\lm(\mu(v))=v$ as claimed.

 Finally we claim that $\mu(\lm(f))=f$ for all $f\in\CM$.  Indeed, we
 have already seen that $f=\mu(v)$ for some $v$.  It follows that
 $\lm(f)=\lm(\mu(v))$, which is equal to $v$ by the last paragraph.
 We can substitute $\lm(f)=v$ back into the equation $f=\mu(v)$ to get
 $f=\mu(\lm(f))$ as claimed.  This shows that $\mu$ is a bijection
 with inverse $\lm$, as claimed. 
\end{proof}

\begin{definition}\lbl{defn-root}
 Let $K$ be a field, let $f(x)$ be a polynomial in $K[x]$, and let
 $\al$ be an element of $K$.  We say that $\al$ is a \emph{root} of
 $f$ if $f(\al)=0$.
\end{definition}

\begin{proposition}\lbl{prop-root}
 The element $\al$ is a root of $f(x)$ if and only if $f(x)$ is
 divisible in $K[x]$ by $x-\al$.
\end{proposition}
\begin{proof}
 If $f(x)$ is divisible by $x-\al$ then $f(x)=g(x)(x-\al)$ for some
 polynomial $g(x)\in K[x]$.  It follows that
 $f(\al)=g(\al)(\al-\al)=0$ as required.

 Conversely, suppose that $f(\al)=0$.
 Proposition~\ref{prop-poly-division} tells us that we can write
 $f(x)=q(x)(x-\al)+r(x)$, where either $r(x)=0$ or
 $\deg(r(x))<\deg(x-\al)=1$.  This means that $r(x)$ is a constant,
 say $r(x)=c\in K$, so $f(x)=q(x)(x-\al)+c$.  Now put $x=\al$ to get
 $0=f(\al)=q(\al)(\al-\al)+c=0+c$, so $c=0$.  We can substitute this
 back in to see that $f(x)=q(x)(x-\al)$, which is divisible by $x-\al$
 as claimed.
\end{proof}

\begin{proposition}\lbl{prop-several-roots}
 Suppose that $\al_1,\dotsc,\al_k$ are distinct roots of a polynomial
 $f(x)$.  Then there exists a polynomial $g(x)$ such that
 $f(x)=g(x)\prod_{i=1}^k(x-\al_i)$.   In particular, if $f(x)$ is
 monic and $\deg(f(x))=k$ then $f(x)=\prod_{i=1}^k(x-\al_i)$.
\end{proposition}
\begin{proof}
 We argue by induction on $k$, noting that Proposition~\ref{prop-root}
 covers the case $k=1$.  For general $k$, we may assume inductively
 that $f(x)=h(x)\prod_{i=1}^{k-1}(x-\al_i)$ for some polynomial
 $h(x)$.  We then have 
 \[ h(\al_k)\prod_{i=1}^{k-1}(\al_k-\al_i)= f(\al_k) = 0. \]
 By hypothesis the roots $\al_j$ are distinct, so $\al_k-\al_i\neq 0$
 for $1\leq i\leq k-1$, so $\prod_{i=1}^{k-1}(\al_k-\al_i)\neq 0$.  It
 follows that we must instead have $h(\al_k)=0$.  We can now apply
 Proposition~\ref{prop-root} to $h(x)$ to get a factorisation
 $h(x)=g(x)(x-\al_k)$.  We can then combine this with 
 $f(x)=h(x)\prod_{i=1}^{k-1}(x-\al_i)$ to get 
 $f(x)=g(x)\prod_{i=1}^k(x-\al_i)$ as required.

 Now suppose that $\deg(f(x))=k$.  It follows that we must have
 $\deg(g(x))=0$, so $g(x)$ is constant.  If $f(x)$ is also monic then
 by considering the coefficient of $x^k$ we see that $g(x)=1$ and so
 $f(x)=\prod_{i=1}^k(x-\al_i)$.
\end{proof}
\begin{corollary}\lbl{cor-num-roots}
 If $f(x)$ is a nonzero polynomial of degree $d$, then $f(x)$ has at
 most $d$ roots. \qed
\end{corollary}

\begin{theorem}[The Fundamental Theorem of Algebra]\lbl{thm-fta}
 If $f(x)\in\C[x]$ and $\deg(f(x))>0$ then $f(x)$ has a root in $\C$.
\end{theorem}
\begin{remark}\lbl{rem-alg-cl}
 A field $K$ is said to be \emph{algebraically closed} if it has the
 property mentioned above, that every nonconstant polynomial in $K[x]$
 has a root in $K$.  Thus, the theorem says that $\C$ is algebraically
 closed. 
\end{remark}
\begin{proof}[Sketch proof]
 Despite the traditional name, this is really a theorem in analysis,
 so we will only outline the argument.  After dividing through by a
 constant, we can assume that $f(x)$ is monic, of degree $d\geq 1$
 say.  We can write $f(x)=\sum_{k=0}^da_kx^k$, with $a_d=1$.  

 Suppose for a contradiction that $f(x)$ has no roots.  It follows
 that the formula $g(x)=1/f(x)$ defines a continuous function
 $g\:\C\to\C$.  (In fact, this function is even analytic, and we could
 shortcut some of the following steps by using some further theory of
 analytic functions.)  Next, for $r\geq 0$ we define
 \[ h(r) = \int_{t=0}^{2\pi} g(re^{it})\,dt. \]
 Using some standard lemmas from analysis, we see that $h$ is
 continuously differentiable, with derivative given by differentiating
 under the integral sign:
 \[ h'(r)
     = \frac{\partial}{\partial r}\int_{t=0}^{2\pi} g(re^{it})\,dt
     = \int_{t=0}^{2\pi} \frac{\partial}{\partial r} g(re^{it})\,dt
     = \int_{t=0}^{2\pi} e^{it} g'(re^{it})\,dt.
 \]
 On the other hand, we also have 
 \[ \frac{\partial}{\partial t} g(re^{it}) = 
     ire^{it} g'(re^{it}),
 \]
 so we can rewrite the above as 
 \[ h'(r) =
    \tfrac{1}{ir}
     \int_{t=0}^{t=2\pi} \tfrac{\partial}{\partial t} g(re^{it})\,dt 
    = \tfrac{1}{ir}\left[ g(re^{it})\right]_{t=0}^{2\pi}
    = (g(1)-g(1))/(ir) = 0.
 \]
 It follows that $h(r)$ is constant, so $h(r)=h(0)$ for all $r$.  It
 is clear from the formula that $h(0)=2\pi g(0)=2\pi/f(0)\neq 0$.  Now
 suppose that $|x|$ is very large, and in particular, much larger than
 any of the coefficients $a_0,\dotsc,a_{d-1}$.  Then the term $x^d$ in
 $f(x)$ will be much larger than any of the other terms, so $|f(x)|$
 will be approximately $|x|^d$, and $|g(x)|$ will be approximately
 $|x|^{-d}$.  It follows that when $r$ is very large we have 
 \[ |h(r)| = \left|\int_{t=0}^{2\pi}g(re^{it})\,dt\right| \leq
     \int_{t=0}^{2\pi}|g(re^{it})|\,dt \simeq
     \int_{t=0}^{2\pi}r^{-d}\,dt = 2\pi r^{-d}.
 \]
 It follows that $h(r)\to 0$ as $r\to\infty$.  This is inconsistent
 with the fact that $h$ is constant, and $h(0)\neq 0$.  It follows
 that $f(x)$ has a root after all.
\end{proof}
\begin{corollary}\lbl{cor-fta}
 Let $f(x)$ be a monic polynomial of degree $d$ over $\C$.  Then
 $f(t)=\prod_{k=1}^d(x-\al_k)$ for some list $\al_1,\dotsc,\al_d$ of
 elements of $\C$.
\end{corollary}
\begin{proof}
 We argue by induction on $d$.  The case $d=0$ is clear, if we recall
 the standard convention that the product of no terms is equal to
 one.  The case $d=1$ is also clear, because any monic polynomial of
 degree one certainly has the form $f(x)=x-\al_1$ for some
 $\al_1\in\C$.  Consider a general monic polynomial $f(x)$ of degree
 $d>1$.  The thearem tells us that there exists $\al_d\in\C$ with
 $f(\al_d)=0$.  Using Proposition~\ref{prop-root} we see that
 $f(x)=g(x)(x-\al_d)$ for some monic polynomial $g(x)\in\C[x]$ of
 degree $d-1$.  By induction, we may assume that
 $g(x)=\prod_{k=1}^{d-1}(x-\al_k)$ for some list
 $\al_1,\dotsc,\al_{d-1}$ of elements of $\C$.  It follows that
 $f(x)=\prod_{k=1}^{d}(x-\al_k)$, as claimed. 
\end{proof}

It is useful to be able to extend Proposition~\ref{prop-root} to
determine when $f(x)$ is divisible by some higher power $(x-\al)^m$.
For this, we need an algebraic theory of derivatives.

\begin{definition}\lbl{defn-derivative}
 Let $K$ be a field, and let $f(x)=\sum_{i=0}^da_ix^i$ be a polynomial
 in $f(x)$.  The \emph{algebraic derivative} of $f(x)$ is the
 polynomial $f'(x)$ defined by $f'(x)=\sum_{i=1}^da_ix^{i-1}$.  We
 also define $f^{(0)}(x)=f(x)$, $f^{(1)}(x)=f'(x)$,
 $f^{(2)}(x)=f''(x)$ and so on, so in general $f^{(n+1)}(x)$ is the
 algebraic derivative of $f^{(n)}(x)$.
\end{definition}

\begin{remark}\lbl{rem-derivative}
 In the case $K=\R$, the derivative is usually defined by
 $f'(x)=\lim_{h\to 0}(f(x+h)-f(x))/h$, and it is a theorem rather than
 a definition that $f'(x)=\sum_{i=1}^da_ix^{i-1}$.  For a general
 field $K$ (especially when the characteristic is not zero) we may not
 be able to make sense of limits.  However, we can still define
 algebraic derivatives by the above formula, and we will find that
 they still have most of the familiar properties of derivatives as
 used in calculus.
\end{remark}

\begin{lemma}\lbl{lem-derivative}
 In the ring $K[x][y]$ we have 
 \[ f(x+y) = f(x) + f'(x)y+\text{ terms divisible by } y^2. \]
 Moreover, $f'(x)$ is the only polynomial with this property.
\end{lemma}
\begin{proof}
 By the binomial expansion (or by induction on $i$) we have
 $(x+y)^i-x^i=ix^{i-1}y$ plus terms divisible by $y^2$.  If
 $f(x)=\sum_ia_ix^i$, it follows that 
 \begin{align*}
   f(x+y)-f(x) &= 
     \sum_i a_i((x+y)^i-x^i) = 
     \sum_i ia_ix^{i-1}y + \text{ terms divisible by } y^2 \\
    &= f'(x)y + \text{ terms divisible by } y^2 
 \end{align*}
 as claimed.  If we also have $f(x+y)=f(x)+g(x)y$ plus terms divisible
 by $y^2$ then we find that $(f'(x)-g(x))y$ is divisible by $y^2$,
 which easily implies that $f'(x)-g(x)=0$ as required.
\end{proof}

\begin{proposition}\lbl{prop-leibniz}
 If $f(x)=g(x)h(x)$ then $f'(x)=g'(x)h(x)+g(x)h'(x)$.
\end{proposition}
We will give two different proofs.
\begin{proof}[First proof]
 Lemma~\ref{lem-derivative} tells us that for some $r(x,y)$ and
 $s(x,y)$ in $K[x][y]$ we have
 \begin{align*}
  g(x+y) &= g(x) + g'(x)y + r(x,y)y^2 \\
  h(x+y) &= h(x) + h'(x)y + s(x,y)y^2.
 \end{align*}
 We can multiply these and rearrange to get 
 \begin{align*}
  f(x+y) =& (g(x) + g'(x)y + r(x,y)y^2)(h(x) + h'(x)y + s(x,y)y^2) \\
   =& g(x)h(x) + (g'(x)h(x)+g(x)h'(x))y + \\
    &  (g'(x)h'(x)+g(x)s(x,y)+h(x)r(x,y)+g'(x)s(x,y)y+h'(x)r(x,y)y+
       r(x,y)s(x,y)y^2)y^2 \\
   =& f(x) + (g'(x)h(x)+g(x)h'(x))y +
       \text{ terms divisible by } y^2.
 \end{align*}
 We must therefore have $f'(x)=g'(x)h(x)+g(x)h'(x)$ as claimed.
\end{proof}

\begin{proof}[Second proof]
 Suppose that $g(x)=\sum_ib_ix^i$ and $h(x)=\sum_jc_jx^j$.  Then
 $f(x)=\sum_ka_kx^k$, where $a_k=\sum_{i=0}^kb_ic_{k-i}$.  It follows
 that $h'(x)=\sum_kka_kx^{k-1}$.  On the other hand, we have 
 \begin{align*}
  g'(x) &= \sum_i ib_ix^{i-1} \\
  h'(x) &= \sum_j jc_jx^{j-1} \\
  g'(x)h(x) &= \sum_i\sum_j ib_ic_j x^{i+j-1} \\
  g(x)h'(x) &= \sum_i\sum_j jb_ic_j x^{i+j-1} \\
  g'(x)h(x)+g(x)h'(x) 
   &= \sum_i\sum_j (i+j)b_ic_j x^{i+j-1} 
    = \sum_k kx^{k-1}\sum_{i+j=k}b_ic_j  \\
   &= \sum_k ka_kx^{k-1} = h'(x).
 \end{align*}
\end{proof}

\begin{corollary}\lbl{cor-deriv-pow}
 If $f(x)=g(x)^n$ then $f'(x)=ng(x)^{n-1}g'(x)$.
\end{corollary}
\begin{proof}
 This is clear for $n=0$ or $n=1$.  Suppose that the function
 $h(x)=g(x)^k$ satisfies $h'(x)=kg(x)^{k-1}g'(x)$, and we consider
 $f(x)=g(x)^{k+1}=g(x)h(x)$.  Using the proposition we deduce that
 \begin{align*}
  f'(x) &= g'(x)h(x)+g(x)h'(x) 
         = g'(x)g(x)^k + g(x).kg(x)^{k-1}g'(x) \\
        &= g(x)^kg'(x) + kg(x)^kg'(x) = (k+1)g(x)^kg'(x),
 \end{align*}
 so the claim holds for $n=k+1$ as well.  It follows by induction that
 it is true for all $n$.
\end{proof}

\begin{lemma}\lbl{lem-deriv-shift}
 If we put $g(x)=f(x+\al)$, then $g'(x)=f'(x+\al)$.  More generally,
 we have $g^{(n)}(x)=f^{(n)}(x+\al)$ for all $n\geq 0$.
\end{lemma}
\begin{proof}
 We have $f(x+y)=f(x)+f'(x)y+r(x,y)y^2$ for some $r(x,y)\in K[x][y]$.
 It follows that 
 \[ g(x+y)=f(x+\al+y)=f(x+\al)+f'(x+\al)y+r(x+\al,y)y^2
     = g(x)+f'(x+\al)y+\text{ terms divisible by }y^2,
 \]
 so $g'(x)=f'(x+\al)$ as claimed.  The more general statement then
 follows by induction.
\end{proof}

\begin{proposition}\lbl{prop-multiple-roots}
 Let $K$ be a field of characteristic zero, let $f(x)$ be a
 polynomial in $K[x]$, and let $\al$ be an element of $K$.  Then
 $f(x)$ is divisible by $(x-\al)^n$ if and only if
 $f(\al)=f'(\al)=\dotsb=f^{(n-1)}(\al)=0$. 
\end{proposition}
\begin{proof}
 We first consider the case $\al=0$, where the claim is that $f(x)$ is
 divisible by $x^n$ if and only if $f^{(i)}(0)=0$ for all $i<n$.
 Suppose that $f(x)=\sum_ia_ix^i$.  One can then check that 
 \[ f^{(r)}(x) = \sum_{i\geq r} i(i-1)(i-2)\dotsb(i-r+1)a_ix^{i-r}, \]
 and thus $f^{(r)}(0)=r!a_r$.  As $K$ has characteristic zero, we know
 that $r!$ is invertible in $K$ and so $f^{(r)}(0)=0$ if and only if
 $a_r=0$.  It is clear that $f(x)$ is divisible by $x^n$ if and only
 if the coefficients $a_0,\dotsc,a_{n-1}$ are all zero, and we now see
 that this happens if and only if $f^{(i)}(0)=0$ for all $i<n$.

 Now consider the general case where $\al$ need not be zero, and 
 put $g(x)=f(x+\al)$.  Then $f(x)$ is divisible by $(x-\al)^n$ if and
 only if $g(x)$ is divisible by $x^n$.  By our special case, this
 holds if and only if  $g^{(i)}(0)=0$ for all $i<n$.  Using
 Lemma~\ref{lem-deriv-shift} we see that $g^{(i)}(0)=f^{(i)}(\al)$,
 and the proposition now follows.
\end{proof}

\begin{remark}\lbl{rem-multiple-roots}
 The above proposition does not extend to fields of nonzero
 characteristic.  Indeed, in $\F_p[x]$ the polynomial $f(x)=x^p$ has
 $f'(x)=px^{p-1}=0$ and so $f^{(k)}(0)=0$ for all $k>0$, but $f(x)$ is
 not divisible by $x^{p+1}$.
\end{remark}

\begin{proposition}\lbl{prop-distinct-roots}
 Let $L$ be a field of characteristic zero, and let $K$ be a subfield
 of $L$.  Suppose that $f(x)\in K[x]$ is irreducible over $K$ (but not
 necessarily over $L$).  Then there is no $\al\in L$ such that $f(x)$
 is divisible by $(x-\al)^2$ in $L[x]$.
\end{proposition}
\begin{proof}
 Suppose that $\deg(f(x))=d>0$, so $\deg(f'(x))=d-1$.  Let $u(x)$ be
 the greatest common divisor of $f(x)$ and $f'(x)$.  This is a monic
 divisor of the irreducible polynomial $f(x)$, so we must have
 $u(x)=1$ or $u(x)=f(x)$.  However, $u(x)$ must also divide $f'(x)$
 and $f(x)$ cannot divide $f'(x)$ because $\deg(f(x))>\deg(f'(x))$, so
 we cannot have $u(x)=f(x)$.  We must therefore have $u(x)=1$
 instead.  We also know from Proposition~\ref{prop-gcd} that there
 exist polynomials $a(x)$ and $b(x)$ in $K[x]$ with
 $a(x)f(x)+b(x)f'(x)=u(x)=1$.  Now consider an element $\al\in L$, and
 suppose for a contradiction that $f(x)$ is divisible by $(x-\al)^2$.
 By Proposition~\ref{prop-multiple-roots}, this means that
 $f(\al)=f'(\al)=0$.  We can thus substitute $x=\al$ in the equation
 $a(x)f(x)+b(x)f'(x)=1$ to get $0=1$, which is impossible.
\end{proof}

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{which-irreducible}
 Which of the following polynomials are irreducible over $\Q$?
 \begin{align*}
  f_0(x) &= x^4 + 9x + 12 \\
  f_1(x) &= x^3-x^2-x-2 \\
  f_2(x) &= x^2-3x-18 \\
  f_3(x) &= x^5 + 5x^4 + 55x^3 + 555x^2 + 5555x + 55555.
 \end{align*}
\end{exercise}
\begin{solution}
 We first recall Eisenstein's criterion. Suppose we have a monic
 polynomial  
 \[ a_0 + a_1x + \dotsb + a_{d-1}x^{d-1} + x^d \]
 and a prime number $p$ such that
 \begin{itemize}
  \item[(a)] the coefficients $a_0,\dotsc,a_{d-1}$ are all integers
   divisible by $p$; and
  \item[(b)] the constant term $a_0$ is not divisible by $p^2$,
 \end{itemize}
 then $g(x)$ is irreducible over $\Q$.  We find the $f_0(x)$ is
 irreducible by Eisenstein's criterion with $p=3$, and that $f_3(x)$
 is irreducible by Eisenstein's criterion with $p=5$.  On the other
 hand, $f_1(x)=(x-2)(x^2+x+1)$ and $f_2(x)=(x-3)(x+6)$, so neither of
 these is irreducible over $\Q$.
\end{solution}
\begin{exercise}\exlabel{ex-euclid}
 Use the Euclidean algorithm to find $\gcd(f(x),f'(x))$, where
 $f(x)=x^4+2x^3+3x^2+2x+1$.  Use this to factorise $f(x)$. 
\end{exercise}
\begin{solution}
 We start with $f_0(x)=f(x)$ and
 $f_1(x)=f'(x)/4=x^3+\tfrac{3}{2}x^2+\tfrac{3}{2}x+\tfrac{1}{2}$.  By
 long division we have
 \[ f_0(x) = (x+\tfrac{1}{2})f_1(x) +
      (\tfrac{3}{4}x^2+\tfrac{3}{4}x+\tfrac{3}{4}),
 \]
 so $f_2(x)=x^2+x+1$.  We then divide $f_1(x)$ by $f_2(x)$ and obtain 
 \[ f_1(x) = (x+\tfrac{1}{2}) f_2(x) \]
 (with no remainder).  Thus the algorithm stops with
 $\gcd(f(x),f'(x))=x^2+x+1$.  This means that every root of $x^2+x+1$
 is a double root of $f(x)$, so $f(x)$ is divisible by $(x^2+x+1)^2$,
 but these are monic polynomials of the same degree, so
 $f(x)=(x^2+x+1)^2$.  
\end{solution}
\begin{exercise}\exlabel{ex-eisenstein-shift}
 Use the method of Remark~\ref{rem-eisenstein-shift} to show that the
 polynomial $f(x)=x^4-5x^3+9x^2-5x+1$ is irreducible over $\Q$.
\end{exercise}
\begin{solution}
 The polynomial $f(x+2)=x^4+3x^3+3x^2+3x+3$ satisfies Eisenstein's
 criterion at $p=3$, so $f(x+2)$ is irreducible, so $f(x)$ is
 irreducible.  We can also make the same argument using
 $f(x-1)=x^4-9x^3+30x^2-42x+21$ (but $f(x+1)$ does not work).
\end{solution}
\begin{exercise}\exlabel{ex-modular-irreducible}
 Show, by considering all potential factors, that the polynomial
 $x^5+x^2+1$ is irreducible in $\F_2[x]$.  Deduce that it is also
 irreducible in $\Q[x]$
\end{exercise}
\begin{solution}
 First, in $\F_2$ we have $f(0)=1$ and $f(1)=1$, so $f(x)$ has no
 roots, so it has no factors of degree one.  Thus, the only way it
 could factorise would be as an irreducible quadratic times an
 irreducible cubic.  The only quadratics over $\F_2$ are $x^2$,
 $x^2+1=(x+1)^2$, $x^2+x=x(x+1)$ and $x^2+x+1$.  Only the last of
 these is irreducible.  We find by long division over $\F_2$ that 
 \[ f(x) = (x^3+x^2)(x^2+x+1) + 1, \]
 so $f(x)$ is not divisible by $x^2+x+1$.  It is therefore irreducible
 as claimed.  

 Now suppose we have a factorisation $f(x)=g(x)h(x)$ in $\Q[x]$, where
 $g(x)$ and $h(x)$ are monic.  We see from Gauss's Lemma that
 $g(x),h(x)\in\Z[x]$, so it makes sense to reduce everything modulo
 $2$.  We then have $\ov{f}(x)=\ov{g}(x)\ov{h}(x)$ in $\F_2[x]$,
 but $\ov{f}(x)$ is irreducible, so one of the factors must be equal
 to one, say $\ov{g}(x)=1$.  As $g(x)$ is monic, the only way we can
 have $\ov{g}(x)=1$ is if $g(x)=1$.  We deduce that $f(x)$ is
 irreducible in $\Q[x]$, as claimed. 
\end{solution}

\begin{exercise}\exlabel{ex-x-to-the-p}
 Let $p$ be a prime number, and put
 $R=\{f(x)\in \F_p[x]\st f'(x)=0\}$.  What can you say about this set?
\end{exercise}
\begin{solution}
 I claim that $R$ is just the ring $\F_p[x^p]$ of polynomials in
 $x^p$.  To see this, consider an arbitrary element $f(x)\in\F_p[x]$,
 say $f(x)=\sum_{i=0}^Na_ix^i$ for some sequence of coefficients
 $a_i\in\F_p$.  We then have $f'(x)=\sum_{i=0}^N i\,a_i\,x^{i-1}$, so
 $f'(x)=0$ iff $i\,a_i=0$ for all $i$.  If $i$ is divisible by $p$
 then it gives the zero element of $\F_p$ so the equation $i\,a_i=0$
 holds automatically.  However, if $i$ is not divisible by $p$
 then it gives a nonzero element of the field $\F_p$, so we can
 multiply by the inverse to get $a_i=0$.  It follows that $f'(x)=0$
 iff $f(x)$ has the form $\sum_{j=0}^Ma_{jp}x^{jp}$ say, or
 equivalently $f(x)$ is a polynomial function of $x^p$.
\end{solution}

\section{Adjoining roots}
\label{sec-adjoining}

\begin{definition}\lbl{defn-bullet}
 Let $\phi\:R\to S$ be a homomorphism of rings.  We then define
 $\phi_\bullet\:R[x]\to S[x]$ by 
 \[ \phi_\bullet(\sum_ia_ix^i) = \sum_i\phi(a_i)x^i. \]
 We leave it to the reader to check that $\phi_\bullet$ is again a
 ring homomorphism.
\end{definition}

\begin{proposition}\lbl{prop-quotient-basis}
 Let $K$ be a field, let $f(x)$ be a polynomial of degree $d>0$ in
 $K[x]$ and consider the quotient ring $R=K[x]/(K[x].f(x))$.  Then the
 list $\Pi=\pi(1),\pi(x),\dotsc,\pi(x^{d-1})$ is a basis for $R$ over
 $K$, so $\dim_K(R)=d$.
\end{proposition}
\begin{proof}
 Any element $G\in R$ can be written as $G=\pi(g)$ for some polynomial
 $g(x)\in K[x]$.  By Proposition~\ref{prop-poly-division} we can write
 $g(x)=f(x)q(x)+r(x)$ where $q(x)$ and $r(x)$ are polynomials with
 $r(x)=0$ or $\deg(r(x))<d$.  In all cases we can write
 $r(x)=\sum_{i=0}^{d-1}c_ix^i$ for some system of coefficients $c_i$.
 Now we can apply $\pi$ to the relation $g(x)=f(x)q(x)+r(x)$ and
 recall that $\pi(q)=0$ to get
 $G=\pi(g)=\pi(f).0+\pi(r)=\pi(r)=\sum_ia_i\pi(x^i)$.  It follows that
 $\Pi$ spans $R$ over $K$.  Now suppose we have a linear relation
 $a_0\pi(1)+a_1\pi(x)+\dotsb+a_{d-1}\pi(x^{d-1})=0$.  If we put
 $h(x)=\sum_{i=0}^{d-1}a_ix^i$, this can be rewritten as
 $\pi(h(x))=0$, so $h(x)\in K[x].f(x)$.  As $f(x)$ has degree $d$, we
 see that any nonzero multiple of $f(x)$ has degree at least $d$.
 However, $h(x)$ is a multiple of $f(x)$ and has degree less than $d$,
 so it must be zero, so $a_0=\dotsb=a_{d-1}=0$.  This shows that $\Pi$
 is linearly independent, so it is a basis as claimed. 
\end{proof}

\begin{proposition}\lbl{prop-adjoin-root}
 Let $K$ be a field, and let $f(x)$ be a polynomial of degree $d>0$ in
 $K[x]$.  Then there exists a homomorphism $\phi\:K\to L$ such that
 $\phi_\bullet(f)$ has a root in $L$, and $\deg(\phi)\leq d$.
\end{proposition}
\begin{proof}
 Using Proposition~\ref{prop-ufd} (or a more direct argument) we see
 that $f(x)$ has at least one monic irreducible factor.  Let $q(x)$ be
 such a factor.  Put $L=K[t]/(K[t].q(t))$, which is a field by
 Corollary~\ref{cor-quotient-field}.  Let $\pi$ be the usual quotient
 map $K[t]\to L$.  Let $\phi$ be the restriction of $\phi$ to
 $K\subset K[t]$, and put $\al=\pi(t)\in L$.  We claim that $\al$ is a
 root of $\phi_\bullet(q)$.  To see this, suppose that
 $q(t)=\sum_{i=0}^na_it^i$.  We then have
 \begin{align*}
  \phi_\bullet(q(x)) &= \sum_{i=0}^n \pi(a_i)t^i \\
  \phi_\bullet(q(\al)) &= \sum_{i=0}^n \pi(a_i)\pi(t)^i 
    = \pi\left(\sum_{i=0}^na_it^i\right) \\
   &= \pi(q(t)) = 0,
 \end{align*}
 as required.  Note also that Proposition~\ref{prop-quotient-basis}
 gives $\deg(\phi)=\deg(q)\leq\deg(f)=d$.
\end{proof}

\begin{remark}\lbl{rem-adjoin-root}
 If we are willing to identify $K$ with $\phi(K)$ as in
 Remark~\ref{rem-hom-inj}, we obtain the following statement: for any
 nonconstant polynomial $f(x)\in K[x]$, there is an extension field
 $L\supseteq K$ such that $[L:K]\leq\deg(f(x))$ and $f(x)$ has a root
 in $L$.
\end{remark}

\begin{definition}\lbl{defn-algebraic}
 Consider a field $L$, a subfield $K$, and an element $\al\in L$.  We
 write $K(\al)$ for the smallest subfield of $L$ that contains $K$ and
 $\al$.  We also define an ideal $I(\al,K)\sse K[x]$ by 
 \[ I(\al,K) = \{f(x)\in K[x]\st f(\al)=0\in L\}. \]
 \begin{itemize}
  \item[(a)] If $I(\al,K)=\{0\}$ we say that $\al$ is \emph{transcendental}
   over $K$.
  \item[(b)] Suppose instead that $I(\al,K)\neq 0$.  We then say that
   $\al$ is \emph{algebraic} over $K$.  We see from
   Proposition~\ref{prop-Kx-pid} that there is a unique monic
   polynomial $\min(\al,K)\in K[x]$ (called the \emph{minimal
    polynomial} of $\al$) that generates $I(\al,K)$.  The \emph{degree}
   of $\al$ over $K$ is defined to be the degree of the polynomial
   $\min(\al,K)$. 
  \item[(c)] If $K(\al)=L$, we say that $\al$ is a \emph{primitive
    element} for $L$ over $K$.
 \end{itemize}
\end{definition}

\begin{remark}\lbl{rem-algebraic}
 It is sometimes convenient to consider a slightly more general
 situation.  Suppose we have a homomorphism $\phi\:K\to L$, and an
 element $\al\in L$.  We put $K'=\phi(K)$, so $K'$ is a subfield of
 $L$, and $\phi$ can be considered as an isomorphism $K\to K'$.  We
 put 
 \[ I(\al,\phi)=\{f(x)\in K[x]\st(\phi_\bullet f)(\al)=0\}. \]
 If this is nonzero, then we write $\min(\al,\phi)$ for the unique
 monic generator of $I(\al,\phi)$.  This clearly correspond to
 $I(\al,K')$ under the isomorphism $\phi_\bullet\:K[x]\to K'[x]$.  We
 also say that $\al$ is a \emph{primitive element} for $\phi$ if
 $L=K'(\al)$.  
\end{remark}

\begin{remark}\lbl{rem-Q-bar}
 In some sense, almost all complex numbers are transcendental over
 $\Q$.  The simplest way to see this is to use the theory of
 countability.  Put 
 \[ \ov{\Q} = \{z\in\C\st z \text{ is algebraic over } \Q\}
      = \bigcup_{0\neq f(x)\in\Q[x]}\{ \text{ roots of } f(x) \}.
 \]
 Fairly standard methods show that $\Q[x]$ is countable, and it
 follows that $\ov{\Q}$ is countable.  However, $\R$ and $\C$ are both
 uncountable, and so are much bigger than $\ov{\Q}$.  Despite this, it
 is hard work to show that any particular number is transcendantal.
 It is known that both $\pi$ and $e$ are transcendental, but we will
 not discuss the proofs here.
\end{remark}

\begin{proposition}\lbl{prop-simple-algebraic}
 Suppose that $\al$ is algebraic over $K$.  Then the minimal
 polynomial $\min(\al,K)$ is irreducible, and there is a unique
 homomorphism $\ov{\chi}\:K[x]/(K[x].\min(\al,K))\to K(\al)$ that acts
 as the identity on $K$ and sends $x$ to $\al$.  Moreover, this
 homomorphism is an isomorphism, and so
 $[K(\al):K]=\dim_K(K(\al))=\deg(\min(\al,K))$.  In particular, if
 $\al$ is a primitive element for $L$ over $K$, then $L$ itself is
 isomorphic to $K[x]/(K[x].\min(\al,K))$.
\end{proposition}
\begin{proof}
 First put $q(x)=\min(\al,K)(x)$ and let $d$ be the degree of $q(x)$.
 Suppose that $q(x)=u(x)v(x)$, where $u(x)$ and $v(x)$ are both
 nonconstant and so both have degree less than $d$.  This means that
 neither $u(x)$ nor $v(x)$ are divisible by $q(x)$, so they do not lie
 in $I(\al,K)$, so $u(\al)$ and $v(\al)$ are nonzero elements of the
 field $L$.  It follows that $q(\al)=u(\al)v(\al)\neq 0$, which
 contradicts the definition of $q(x)$.  It follows that $q(x)$ has no
 such factorisation, so it is irreducible as claimed.  It then follows
 by Corollary~\ref{cor-quotient-field} that the quotient ring
 $L'=K[x]/(K[x].q(x))=K[x]/I(\al,K)$ is actually a field.

 Now define $\chi\:K[x]\to L$ by $\chi(\sum_ia_ix^i)=\sum_ia_i\al^i$, or
 equivalently $\chi(f(x))=f(\al)$.  This is clearly the unique
 homomorphism that acts as the identity on $K$ and sends $x$ to
 $\al$.  We have $\chi(f(x))=0$ iff $f(\al)=0$ iff $f(x)\in I(\al,K)$, so
 $\ker(\chi)=I(\al,K)=K[x].q(x)$.  We therefore have an induced
 homomorphism $\ov{\chi}\:L'\to L$ as in
 Proposition~\ref{prop-induced-hom}, and a subfield
 $L''=\ov{\chi}(L')\sse L$ as in Proposition~\ref{prop-hom-inj}.  We
 claim that $L''=K(\al)$.  Indeed, it is clear that $L''$ contains $K$
 and $\al$, so it contains $K(\al)$.  Conversely, $K(\al)$ is closed
 under multiplication and contains $K$ and $\al$, so by induction it
 contains all elements of the form $a\,\al^k$.  It is also closed
 under addition, so it contains all elements of the form
 $\sum_{i=0}^na_i\al^i$.  In other words, it contains the image of
 $\chi$, which is the same as the image of $\ov{\chi}$, which is
 $L''$.  We can now regard $\chi$ as a surjective homomorphism
 $K[x]\to K(\al)$ with kernel $I(\al,K)$, so the induced map
 $L'=K[x]/I(\al,K)\to K(\al)$ is an isomorphism as claimed (by
 Proposition~\ref{prop-induced-hom}). 
\end{proof}

We can restate essentially the same fact as follows:
\begin{corollary}\lbl{cor-simple-algebraic}
 Suppose we have a homomorphism $\phi\:K\to L$, and an element
 $\al\in L$ that is algebraic over the subfield $K'=\phi(K)$.  Then
 there is an isomorphism 
 \[ \ov{\chi}\:K[x]/(K[x].\min(\al,\phi))\to K'(\al)\sse L \]
 given by 
 \[ \ov{\chi}(f(x)+K[x].\min(\al,\phi)) = 
     (\phi_\bullet f)(\al),
 \]
 or more explicitly by 
 \[ \ov{\chi}(\sum_ia_ix^i+K[x].\min(\al,\phi)) =
     \sum_i\phi(a_i)\al^i.
 \]
 It follows that $\deg(\phi)=\deg(q(x))$.  In particular, if $\al$ is
 a primitive element for $\phi$ then
 \[ L\simeq K[x]/(K[x].\min(\al,\phi)). \qed \]
\end{corollary}

\begin{proposition}\lbl{prop-finite-algebraic}
 Suppose we have a field $K$ and an extension field $L$ such that
 $[L:K]<\infty$.  Then every element of $L$ is algebraic over
 $K$.  
\end{proposition}
\begin{proof}
 Put $d=[L:K]=\dim_K(L)$.  Consider an element $\al\in L$.  The list
 $\CA=1,\al,\al^2,\dotsc,\al^d$ has length $d+1$, which is larger than
 the dimension of $L$, so $\CA$ must be linearly dependent.  We
 therefore have a linear relation
 $a_0.1+a_1.\al+a_2.\al^2+\dotsb+a_d.\al^d=0$, where not all the
 coefficients $a_i$ are zero.  If we put $f(x)=\sum_ia_ix^i\in K[x]$
 then this means that $f(x)\neq 0$ but $f(\al)=0$.  It follows that
 $f(x)$ is a nonzero element of $I(\al,K)$, as required.
\end{proof}

This is a convenient point to introduce another useful result that
uses a related method.

\begin{proposition}\lbl{prop-subring-subfield}
 Suppose we have a field $K$, and extension $L$, and a subring
 $R\sse L$ such that $K\sse R$ and $\dim_K(R)<\infty$.  Then $R$ is
 actually a subfield of $L$.
\end{proposition}
\begin{proof}
 Suppose that $\al$ is a nonzero element of $R$; we need to show that
 $\al$ has an inverse in $R$.  Just as above we see that the powers of
 $\al$ are linearly dependent, so $I(\al,K)\neq 0$, so we have an
 irreducible monic polynomial $q(x)=\min(\al,K)(x)=\sum_{i=0}^da_ix^i$
 say, with $q(\al)=0$.  We claim that $q(0)\neq 0$.  Indeed, if $q(0)$
 were zero then $x$ would be a nonconstant monic factor of the
 irreducible polynomial $q(x)$, which would mean that $x$ would have
 to equal $q(x)$, so the equation $q(\al)=0$ would give $\al=0$,
 contradicting our assumption that $\al$ is nonzero.  Thus, the
 constant term $a_0=q(0)$ is nonzero, and thus invertible in $K$.  We
 now put $\bt=-\sum_{i=1}^da_0^{-1}a_i\al^{i-1}\in R$.  The equation
 $\sum_{i=0}^da_i\al^i=0$ can then be rearranged to give $\al\bt=1$,
 so $\bt$ is the required inverse to $\al$ in $R$.
\end{proof}

\begin{proposition}\lbl{prop-subfield-join}
 Suppose we have fields $K,L,M,N$ with $K\sse L\sse N$ and
 $K\sse M\sse N$, where $[L:K]<\infty$ and $[M:K]<\infty$.  Put 
 \[ LM = \{x\in M\st 
     x = a_1b_1+\dotsb+a_rb_r \text{ for some }
     a_1,\dotsc,a_r\in L \text{ and } 
     b_1,\dotsc,b_r\in M\}.
 \] 
 Then $LM$ is a subfield of $N$, and it is the smallest subfield that
 contains both $L$ and $M$.  Moreover, we have
 $[LM:K]\leq[L:K][M:K]<\infty$. 
\end{proposition}
\begin{proof}
 For any $b\in L$ we can write $b=b.1$ with $b\in L$ and $1\in M$, so
 $b\in LM$.  This means that $L\sse LM$, and similarly $M\sse LM$.  In
 particular, this means that $LM$ contains $0$ and $1$.

 It is clear by definition that $LM$ is closed under addition.  If we
 have an element $x=\sum_ia_ib_i\in LM$ then $-x=\sum_i(-a_i)b_i$
 which also lies in $LM$.  It follows that $LM$ is also closed under
 subtraction.  Now suppose we have another element $y=\sum_jc_jd_j\in
 LM$, with $c_j\in L$ and $d_j\in M$.  We can thus write $xy$ as a
 finite sum of terms $(a_ic_j)(b_id_j)$, where $a_ic_j\in L$ and
 $b_id_j\in M$.  It follows that $xy\in LM$.  We now see that $LM$ is
 a subring of $N$, but it is not yet clear that it is closed under
 taking inverses.

 Now choose a basis $e_1,\dotsc,e_p$ for $L$ over $K$, and a basis
 $f_1,\dotsc,f_q$ for $M$ over $K$.  Note that $p=[L:K]$ and
 $q=[M:K]$.  Let $V$ be the span over $K$ of the elements $e_if_j$.
 Any element $v\in V$ can be written as a sum of terms $v_{ij}e_if_j$
 with $v_{ij}\in K$, so $v_{ij}e_i\in L$ and $f_j\in M$, so $v\in LM$.
 Conversely, if $a\in L$ and $b\in M$ we can write $a=\sum_ix_ie_i$
 and $b=\sum_jy_jf_j$ for some elements $x_i,y_j\in K$.  It follows
 that $ab=\sum_{ij}x_iy_je_if_j$, with $x_iy_j\in K$.  This means that
 $ab\in V$, and any element of $LM$ is a sum of terms like $ab$, so it
 also lies in $V$.  This proves that $LM=V$, so
 $\dim_K(LM)\leq pq=[L:K][M:K]$.  In particular, we see that $LM$ is a
 subring of $N$ of finite dimension over $K$, so
 Proposition~\ref{prop-subring-subfield} tells us that it is actually
 a subfield.

 We have already seen that $LM$ contains both $L$ and $M$.  Let $F$
 be any other subfield of $N$ that contains both $L$ and $M$.
 Consider an element $x=\sum_ia_ib_i\in LM$.  We then have
 $a_i\in L\sse F$ and $b_j\in M\sse F$ and $F$ is closed under
 multiplication and addition so we must have $x\in F$.  This proves
 that $LM\sse F$, so $LM$ is the \emph{smallest} subfield of $N$ that
 contains both $L$ and $M$.
\end{proof}

\begin{definition}\lbl{defn-split}
 Suppose we have a field $K$, an extension field $L$, and a monic
 polynomial $f(x)\in K[x]$ of degree $d$.  We say that $f(x)$
 \emph{splits over $L$} if there is a list $\al_1,\dotsc,\al_d$
 of elements of $L$ such that $f(x)=\prod_{i=1}^d(x-\al_i)$.  If the
 elements $\al_i$ are all different, we say that $f(x)$ \emph{splits
  properly} over $L$.  Similarly, if we have a homomorphism
 $\psi\:K\to M$, we say that $f(x)$ is \emph{(properly) split by
  $\psi$} if $(\psi_\bullet f)(x)$ splits (properly) in $M$.
\end{definition}

\begin{remark}\lbl{rem-distinct-roots}
 If $K$ has characteristic zero and $f(x)$ is irreducible in $K[x]$
 and $f(x)$ splits over $L$, we see from
 Proposition~\ref{prop-distinct-roots} that the splitting is
 automatically proper.
\end{remark}

\begin{remark}\lbl{rem-fta-split}
 Corollary~\ref{cor-fta} can now be rephrased as saying that every
 monic polynomial in $\C[x]$ actually splits over $\C$.
\end{remark}

We will also use a slightly sharper concept:
\begin{definition}\lbl{defn-splitting-field}
 Suppose we have a field $K$, an extension field $L$, and a monic
 polynomial $f(x)\in K[x]$ of degree $d$.  We say that $L$ is a
 \emph{splitting field for $f(x)$} (or a \emph{minimal splitting
  field}, if emphasis is necessary) if $f(x)$ splits in $L$, and $L$
 is generated over $K$ by the roots of $f(x)$.  Similarly, we say that 
 a homomorphism $\psi\:K\to M$ is a \emph{(minimal) splitting
  homomorphism} for $f(x)$ if $(\psi_\bullet f)(x)$ splits in $M$, and
 $M$ is generated over $\psi(K)$ by the roots of
 $(\psi_\bullet f)(x)$.
\end{definition}

\begin{proposition}\lbl{prop-construct-splitting}
 Suppose that $f(x)$ is a monic polynomial of degree $d$ in $K[x]$.
 Then $f(x)$ has a splitting field of degree at most $d!$ over $K$.
\end{proposition}
\begin{proof}
 We will argue by induction on $d$.  If $d=0$ then $f(x)=1$, which
 splits in $K$ as a product of no factors.  If $d=1$ then $f(x)$ must
 have the form $f(x)=x-\al$ for some $\al\in K$, so again $f(x)$ is
 already split in $K$.  For the general case,
 Remark~\ref{rem-adjoin-root} tells us that there is an
 extension $L\subseteq K$ with $[L:K]\leq d$, and an element
 $\al_d\in L$ with $f(\al_d)=0$.  It
 follows by Proposition~\ref{prop-root} that there is a monic
 polynomial $g(x)\in L[x]$ of degree $d-1$ such that
 $f(x)=g(x)(x-\al_d)$.  By induction we may assume that
 there is a field $M\supseteq L$ with $[M:L]\leq(d-1)!$, and a
 splitting $g(x)=\prod_{i=1}^{d-1}(x-\al_i)$ in $M[x]$.  This in turn
 gives a splitting $f(x)=\prod_{i=1}^d(x-\al_i)$ in $M[x]$, and
 $[M:K]=[M:L][L:K]\leq (d-1)!\tm d=d!$ as required.
\end{proof}

\begin{proposition}\lbl{prop-split-factor}
 Suppose we have a splitting $f(x)=\prod_{i=1}^d(x-\al_i)$ in $K[x]$,
 and also a factorisation $f(x)=g(x)h(x)$ in $K[x]$ (where $g(x)$ and
 $h(x)$ are monic).  Then there is a subset $I\sse\{1,\dotsc,d\}$ such
 that $g(x)=\prod_{i\in I}(x-\al_i)$ and
 $h(x)=\prod_{i\not\in I}(x-\al_i)$.
\end{proposition}

\begin{proof}
 Proposition~\ref{prop-ufd} says that $g(x)$ and $h(x)$ can be written
 as products of irreducible elements, and by combining these we get an
 expression for $f(x)$ as a product of irreducible elements.  On the
 other hand, the equation $f(x)=\prod_{i=1}^d(x-\al_i)$ also factors
 $f(x)$ as a product of irreducible elements, and
 Proposition~\ref{prop-ufd} implies that there is a unique such
 factorisation up to order.  It follows that $g(x)$ must be the
 product of some subset of the terms $(x-\al_i)$, and $h(x)$ must be
 the product of the remaining terms.
\end{proof}

\begin{remark}\lbl{rem-split-factor}
 In the case where the elements $\al_i$ are all different, the proof
 can be simplified.  We can then take $I=\{i\st g(\al_i)=0\}$, and
 $J=\{i\st h(\al_i)=0\}$.  Note that for all $i$ we have
 $g(\al_i)h(\al_i)=f(\al_i)=0$, so either $g(\al_i)=0$ or
 $h(\al_i)=0$.  This means that $I\cup J=\{1,\dotsc,d\}$, and so
 $|I|+|J|=d+|I\cap J|$.  On the other hand, $g(x)$ has $|I|$ distinct
 roots, so $\deg(g(x))\geq |I|$.  Similarly $\deg(h(x))\geq |J|$, and
 so 
 \[ d=\deg(f(x))=\deg(g(x)h(x))=\deg(g(x))+\deg(h(x))\geq
      |I|+|J|=d+|I\cap J|.
 \]
 The only way this can be consistent is if $I\cap J=\emptyset$ and
 $\deg(g(x))=|I|$ and $\deg(h(x))=|J|$.  It follows in turn that
 $g(x)=\prod_{i\in I}(x-\al_i)$ and
 $h(x)=\prod_{j\in J}(x-\al_j)=\prod_{j\not\in I}(x-\al_j)$ as
 claimed. 
\end{remark}

\begin{proposition}\lbl{prop-proper-splitting}
 Let $K$ be a field of characteristic zero.  Suppose that $f(x)$ is a
 monic polynomial in $K[x]$, and that $L\supseteq K$ is a splitting
 field for $f(x)$.  Then there is a polynomial $g(x)\in K[x]$ such
 that $g(x)$ splits properly in $L$ and has the same roots in $L$ as
 $f(x)$.  In particular, $L$ is also a splitting field for $g(x)$.
\end{proposition}
\begin{proof}
 Proposition~\ref{prop-ufd} tells us that $f(x)$ can be written in the
 form 
 \[ f(x) = p_1(x)^{n_1}\dotsb p_r(x)^{n_r}, \]
 where $p_1(x),\dotsc,p_r(x)$ are distinct monic irreducible
 polynomials in $K[x]$, and $n_1,\dotsc,n_r>0$.  Put
 $g(x)=p_1(x)\dotsb p_r(x)$.  This divides $f(x)$ and therefore splits
 over $L$ by Proposition~\ref{prop-split-factor}.  If $g(\al)=0$ then
 $p_i(\al)=0$ for some $i$, so $f(\al)=0$.  Conversely, if $f(\al)=0$
 then $p_i(\al)^{n_i}=0$ for some $i$, and so $p_i(\al)=0$, so
 $g(\al)=0$.  Thus $g(x)$ has the same roots in $L$ as $f(x)$.  All
 that is left is to show that $g(x)$ splits \emph{properly}, so it has
 no repeated roots.  If $i\neq j$ then $p_i(x)$ and $p_j(x)$ are
 distinct monic irreducibles, so their greatest common divisor must be
 $1$, so we have $a(x)p_i(x)+b(x)p_j(x)=1$ for some $a(x),b(x)\in
 K[x]$.  If $p_i(\al)=0$ then we can substitute $x=\al$ to get
 $b(\al)p_j(\al)=1$, so $p_j(\al)\neq 0$.  This means that the roots
 of $p_i(x)$ and $p_j(x)$ are disjoint, so it will suffice to show
 that $p_i(x)$ has no repeated roots.  As $p_i(x)$ is irreducible and
 $K$ has characteristic zero, this follows from
 Proposition~\ref{prop-distinct-roots}.
\end{proof}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-splitting-misc-i}
 Find the splitting fields for the following polynomials over $\Q$.
 \begin{align*}
  f_0(x) &= x^2-2x+1                &
  f_1(x) &= x^4-5x^2+6              \\
  f_2(x) &= x^2-x+1                 &
  f_3(x) &= x^3-2                   \\
  f_4(x) &= x^4-4x^2+1              &
  f_5(x) &= x^4-2                   \\
  f_6(x) &= x^6-1                   &
  f_7(x) &= x^6-8                   
 \end{align*}
\end{exercise}
\begin{solution}
 We will write $K_i$ for the splitting field of $f_i(x)$.
 \begin{itemize}
  \item We can write $f_0(x)$ as $(x-1)^2$, so $K_0=\Q$.
  \item We can factor $f_1(x)$ as $(x^2-2)(x^2-3)$, so the roots are
   $\pm\sqrt{2}$ and $\pm\sqrt{3}$, so the
   $K_1=\Q(\sqrt{2},\sqrt{3})$. 
  \item The roots of $f_2(x)$ are $(1\pm\sqrt{-3})/2$, so
   $K_2=\Q(\sqrt{-3})$.
  \item The roots of $f_3(x)$ are $\al$, $\om\al$ and $\om^2\al$,
   where $\al$ is the real cube root of $2$, and
   $\om=e^{2\pi i/3}=(\sqrt{-3}-1)/2$.  It follows that $K_3$ contains
   $\al$ and $\om\al$, so it also contains $(\om\al)/\al=\om$, so it
   also contains $2\om+1=\sqrt{-3}$.  Form this it follows that
   $K_3=\Q(\al,\om)=\Q(\al,\sqrt{-3})$. 
  \item We can regard $f_4(x)$ as a quadratic function of $x^2$, and
   we find that it vanishes when $x^2=(4\pm\sqrt{12})/2=2\pm\sqrt{3}$,
   so $x=\pm\sqrt{2\pm\sqrt{3}}$.  Thus, one root of $f(x)$ is
   $\al=\sqrt{2+\sqrt{3}}$, and another is $-\al$.  The other two
   roots are $\bt$ and $-\bt$, where $\bt=\sqrt{2-\sqrt{3}}$.
   However, we have
   $\al\bt=\sqrt{(2+\sqrt{3})(2-\sqrt{3})}=\sqrt{1}=1$, so
   $\bt=\al^{-1}$.  It follows that the full list of roots is
   $\al,-\al,1/\al,-1/\al$, so $K_4=\Q(\al)$.
  \item If we let $\al$ denote the positive real fourth root of $2$,
   then the roots of $f_5(x)$ are $\al,i\al,-\al$ and $-i\al$.  It
   follows that $K_5=\Q(\al,i)$.  It follows that $[K_5:\Q]=8$.
  \item The roots of $f_6(x)$ are the $6$th roots of unity, which are
   the powers of $\al=e^{\pi i/3}=(1+\sqrt{-3})/2$, so
   $K_6=\Q(\sqrt{-3})$.
  \item The roots of $f_7(x)$ are the numbers $2\al^k$, where again
   $\al=e^{\pi i/3}=(1+\sqrt{-3})/2$.  It follows that
   $K_7=K_6=\Q(\sqrt{-3})$.
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-splitting-misc-ii}
 Determine the degree over $\Q$ of the splitting fields of the
 following polynomials:
 \begin{itemize}
  \item[(a)] $x^4+1$;
  \item[(b)] $x^4+x^2+1$ (note that this is reducible);
  \item[(c)] $x^6+1$ (and so is this);
  \item[(d)] $x^6+x^3+1$.
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] The roots of $x^4+1$ are the primitive 8th roots of unity.
   One of these is $\al=e^{i\pi/4}=(1+i)/\sqrt{2}$, and the others are
   $\al^3=i\al$, $\al^5=-\al$ and $\al^7=-i\al$.  Note that $i=\al^2$
   and $\sqrt{2}=(1+i)/\al=(1+\al^2)/\al$, so $i,\sqrt{2}\in\Q(\al)$.
   It is also clear that $\al\in\Q(i,\sqrt{2})$, so the relevant
   splitting field is $\Q(i,\sqrt{2})$.  

  \item[(b)] We may observe that $x^4+x^2+1=(x^2+x+1)(x^2-x+1)$, and
   so its roots are just the roots of the two quadratic factors. These
   are 
   \[ \frac{-1\pm\sqrt{-3}}{2} \qquad\mbox{and}\qquad
      \frac{ 1\pm\sqrt{-3}}{2}.
   \]
   It follows that the splitting field is $\Q(\sqrt{-3})$, of degree 2
   over $\Q$. 

  \item[(c)] The roots of $x^6+1$ are the 6th roots of $-1$.  As
   $-1=e^{i\pi}$, one of these roots is 
   \[ \al=e^{i\pi/6}=(\sqrt{3}+i)/2. \]
   The other roots are obtained by multiplying $\al$ by a 6th root of
   $1$, but the 6th roots of $1$ are just the powers of $\al^2$, so
   the roots of $x^6+1$ are $\al,\al^3,\al^5,\al^7,\al^9$ and
   $\al^{11}$.  Thus, the splitting field is just $\Q(\al)$.  Note
   that $\al\in\Q(i,\sqrt{3})$, but $i=e^{i\pi/2}=\al^3\in\Q(\al)$,
   and so $\sqrt{3}=2\al-i\in\Q(\al)$.  It follows that the splitting
   field can also be described as $\Q(i,\sqrt{3})$.  It therefore has
   degree $4$ over $\Q$.

  \item[(d)] Note that $x^9-1=(x^3-1)(x^6+x^3+1)$, so the roots of
   $x^6+x^3+1$ are the primitive 9th roots of unity. One may then
   observe that if $\zt$ is a primitive 9th root of unity, all other
   primitive 9th roots of unity are powers of $\zt$, so that the
   splitting field is just $\Q(\zt)$. Its degree over $\Q$ is just the
   degree of the minimal polynomial of $\zt$, but this is the given
   polynomial $x^6+x^3+1$ as it is irreducible (substitute
   $x\mapsto x+1$ and use Eisenstein with $p=3$). So $[\Q(\zt):\Q]=6$.

   Alternatively, the roots of $y^2+y+1$ are
   $\om=\frac{-1+\sqrt{-3}}{2}\in\Q(\sqrt{-3})$ and
   $\om^{-1}=\om^2=\frac{-1-\sqrt{-3}}{2}\in\Q(\sqrt{-3})$.  The roots
   of $x^6+x^3+1$ are the cube roots of these, so if
   $\al=\om^{\frac{1}{3}}$, then the roots are
   $\al,\om\al,\om^2\al;\al^{-1},\om\al^{-1},\om^2\al^{-1}$. So the
   splitting field is $\Q(\al,\om)$; but $\Q(\om)=\Q(\sqrt{-3})$, so
   has degree 2 over $\Q$. Further, $\al$ satisfies the cubic equation
   $x^3-\om$ with coefficients in $\Q(\om)$, so $\Q(\om,\al)$ has
   degree at most 3 over $\Q(\om)$. Thus the degree of the splitting
   field is at most 6 over $\Q$ (using the Degrees Theorem). On the
   other hand, the polynomial is irreducible (as above), so adjoining
   any root of it gives a field extension of degree 6, and so
   adjoining all the roots gives a field extension of degree at least
   6. Thus the degree equals 6.
 \end{itemize}
\end{solution}


\begin{exercise}\exlabel{ex-transcendental}
 Suppose that $\al\in L\supset K$ and that $\al$ is transcendental
 over $K$.  Let $K(x)$ be the field of rational functions over $K$ (as
 in Example~\ref{eg-fields-rational}).  Show that there is an
 isomorphism $\phi\:K(x)\to K(\al)$ with $\phi(x)=\al$.
\end{exercise}
\begin{solution}
 First define $\chi_0\:K[x]\to L$ by $\chi_0(p(x))=p(\al)$, or more
 explicitly 
 \[ \chi_0(\sum_ia_ix^i) = \sum_ia_i\al^i. \]
 The kernel of this is $I(\al,K)$, which is zero because $\al$ is
 transcendental.  Thus, if $q(x)\neq 0$ we see that $q(\al)$ is a
 nonzero element of $L$, so it has an inverse in $L$.  Thus, given a
 rational function $f(x)=p(x)/q(x)$, we can try to define
 $\chi(f(x))=p(\al)/q(\al)\in L$.  There is a potential ambiguity
 here: what if $f(x)$ can be represented in a different way, say as
 $f(x)=r(x)/s(x)$ for some $r(x),s(x)\in K[x]$ with $s(x)\neq 0$?  By
 the construction of $K(x)$, this means that $p(x)s(x)=r(x)q(x)$ in
 $K[x]$, which implies that $p(\al)s(\al)=r(\al)q(\al)$ in $L$, which
 means that $p(\al)/q(\al)=r(\al)/s(\al)$ in $L$.  We therefore have a
 well-defined function $\chi\:K(x)\to L$ as described.  We know from
 Proposition~\ref{prop-hom-inj} that $\chi(K(x))$ is a subfield of $L$
 and that $\chi$ gives an isomorphism $K(x)\to\chi(K(x))$, so it will
 suffice to show that $\chi(K(x))=K(\al)$.  It is clear that
 $K=\chi(K)\sse\chi(K(x))$  and $\al=\chi(x)\in\chi(K(x))$, and by
 definition $K(\al)$ is the smallest subfield of $L$ containing $K$
 and $\al$, so $K(\al)\sse\chi(K(x))$.  Conversely, as $K(\al)$ is a
 field containing $K$ and $\al$, we see that it must contain all
 powers of $\al$, and then all $K$-linear combinations of powers;
 equivalently, it must contain $q(\al)$ for all $q\in K[x]$.  If
 $q(x)$ is nonzero then $q(\al)\in K(\al)\sm\{0\}=K(\al)^\tm$, so
 $1/q(\al)\in K(\al)$, so $p(\al)/q(\al)\in K(\al)$ for all
 $p(x)\in K[x]$.  This shows that $K(\al)$ contains $\chi(K(x))$, so
 we must have $K(\al)=\chi(K(x))$, as required.
\end{solution}
\begin{exercise}\exlabel{ex-cayley}
 Suppose we have a field $K$, an extension field $L$ such that
 $d=[L:K]<\infty$, and an element $\al\in L$.  By applying the
 Cayley-Hamilton theorem to a suitable $K$-linear endomorphism of $L$,
 give another proof that $\al$ is algebraic over $K$.
\end{exercise}
\begin{solution}
 We can define a function $\mu\:L\to L$ by $\mu(a)=\al a$ for all
 $a\in L$.  This is clearly $K$-linear (or even $L$-linear, but we
 will not use that).  Let $f(t)\in K[t]$ be the characteristic
 polynomial of $\mu$.  More explicitly, we can choose a basis
 $e_1,\dotsc,e_d$ for $L$ over $K$, and note that there must be
 elements $A_{ij}\in K$ with $\mu(e_i)=\al e_i=\sum_jA_{ij}e_j$ for
 all $i$.  This gives a matrix $A\in M_d(K)$, and thus a matrix
 $tI-A\in M_d(K[t])$.  We then have $f(t)=\det(tI-A)$, which is a
 monic polynomial of degree $d$ over $K$, so it can be written as
 $\sum_{i=0}^dc_it^i$ for some coefficients $c_i\in K$.  The
 Cayley-Hamilton theorem then tells us that
 $\sum_{i=0}^dc_i\mu^i=f(\mu)=0$ as a $K$-linear map from $L$ to $L$.
 As $\mu(a)=\al a$ (and so $\mu^2(a)=\mu(\al a)=\al^2 a$, and so on)
 we deduce that $\sum_{i=0}^dc_i\al^ia=\sum_{i=0}^dc_i\mu^i(a)=0$.  In
 particular, we can take $a=1$ and thus deduce that $f(\al)=0$, so
 $f(x)\in I(\al,K)$.  As $f$ is monic we also have $f(x)\neq 0$, so
 $I(\al,K)\neq 0$ as claimed.
\end{solution}
\begin{exercise}\exlabel{ex-Q-bar}
 Let $\ov{\Q}$ denote the set of all numbers $\al\in\C$ such that $\al$
 is algebraic over $\Q$ (as in Remark~\ref{rem-Q-bar}).  
 \begin{itemize}
  \item[(a)] For $\al\in\C$, show that the following are equivalent: 
   \begin{itemize}
    \item[(i)] $\al\in\ov{\Q}$
    \item[(ii)] $[\Q(\al):\Q]<\infty$
    \item[(iii)] There exists a subfield $K\sse\C$ with $\al\in K$ and
     $[K:\Q]<\infty$.
   \end{itemize}
  \item[(b)] Show that $\ov{\Q}$ is a subfield of $\C$.
  \item[(c)] Show that if $\al\in\C$ and $\al$ is algebraic over
   $\ov{\Q}$ then $\al\in\ov{\Q}$.
  \item[(d)] Deduce that $\ov{\Q}$ is algebraically closed.
 \end{itemize}
 (You should use part~(a) to help you with~(b) and~(c).)
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item[(a)] If $\al\in\ov{\Q}$ then
   Proposition~\ref{prop-simple-algebraic} tells us that
   $[\Q(\al):\Q]=\deg(\min(\al,\Q))<\infty$.  If $[\Q(\al):\Q]<\infty$
   then evidently $\Q(\al)$ is an example of a subfield $K\sse\C$ with
   $\al\in K$ and $[K:\Q]<\infty$.  If we are given such a field $K$,
   then Proposition~\ref{prop-finite-algebraic} (applied to the
   extension $\Q\subset K$) tells us that $\al\in\ov{\Q}$.  Thus, the
   three conditions mentioned are all equivalent.
  \item[(b)] First, it is clear that $\ov{\Q}$ contains $\Q$, so
   $0,1\in\ov{\Q}$.  Suppose that $\al,\bt\in\ov{\Q}$.  This means
   that there are subfields $L,M\subset\C$ with $\al\in L$ and
   $\bt\in M$ and $[L:\Q],[M:\Q]<\infty$.  Now
   Proposition~\ref{prop-subfield-join} tells us that $LM$ is a
   subfield of $\C$ containing both $\al$ and $\bt$, such that
   $[LM:\Q]<\infty$.  As (iii) implies (i) above, we see that
   $LM\sse\ov{\Q}$.  Now $\al+\bt$, $\al-\bt$ and $\al\bt$ all lie in
   $LM$, so they lie in $\ov{\Q}$.  Similarly, if $\al\neq 0$ then
   $\al^{-1}\in L\sse LM\sse\ov{\Q}$.  It follows that $\ov{\Q}$ is a
   subfield as claimed.
  \item[(c)] Now suppose that $\al\in\C$ and $\al$ is algebraic over
   $\ov{\Q}$.  We thus have a minimal polynomial
   $f(x)=\min(\al,\ov{\Q})(x)=\sum_{i=0}^da_ix^i$, with $a_d=1$ and
   $a_i\in\ov{\Q}$ for all $i$.  Now part~(a) tells us that there
   exists a field $L_i\subset\C$ with $a_i\in L_i\subset\C$ and
   $[L_i:\Q]<\infty$.  Put $L=L_0L_1\dotsb L_d$, so
   Proposition~\ref{prop-subfield-join} tells us that
   $[L:\Q]<\infty$.  Moreover, as $f(\al)=0$ we see that
   $[L(\al):L]\leq d$, so $[L(\al):\Q]=[L(\al):L][L:\Q]<\infty$.  This
   means that $L(\al)$ is a finite degree extension of $\Q$ containing
   $\al$, so $\al\in\ov{\Q}$ by criterion~(iii) above.
  \item[(d)] Suppose we have a nonconstant polynomial
   $f(x)\in\ov{\Q}[x]$.  We can regard this as a nonconstant polynomial
   over $\C$, so the Fundamental Theorem of Algebra tells us that
   there is a root (say $\al$) in $\C$.  Now the relation $f(\al)=0$
   tells us that $\al$ is algebraic over $\ov{\Q}$, so part~(c) tells
   us that $\al\in\ov{\Q}$.  We therefore see that any nonconstant
   polynomial over $\ov{\Q}$ has a root in $\ov{\Q}$, which means that
   $\ov{\Q}$ is algebraically closed.
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-F-sixteen}
 We have seen that there is a field $\F_4=\F_2(\al)$, where $\al$ has
 minimal polynomial $t^2+t+1$ over $\F_2$.  You may assume that there
 is also a field $\F_{16}=\F_2(\bt)$, where $\bt$ has minimal
 polynomial $t^4+t^3+t^2+t+1$ over $\F_2$.
 \begin{itemize}
  \item[(a)] Write down a basis for $\F_4$ over $\F_2$, and list the
   four elements of $\F_4$.
  \item[(b)] Write down a basis for $\F_{16}$ over $\F_2$, and list the
   sixteen elements of $\F_{16}$.
  \item[(c)] Check that $\bt^5=1$.
  \item[(d)] There are precisely two homomorphisms from $\F_4$ to
   $\F_{16}$.  Find them.
 \end{itemize}
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item[(a)] It is a general fact that if $\tht$ is algebraic over $K$
   and the minimal polynomial has degree $d$, then the set
   $\{1,\tht,\dotsc,\tht^{d-1}\}$ is a basis for $K(\tht)$ over $K$.
   From this it follows that $\{1,\al\}$ is a basis for $\F_4$ over
   $\F_2$.  This means that every element of $\F_4$ can be written as
   $a_0+a_1\al$ for some $a_0,a_1\in\F_2=\{0,1\}$, so 
   \[ \F_4 = \{0,1,\al,1+\al\}. \] 
  \item[(b)] Similarly, as the minimal polynomial of $\bt$ over $\F_2$
   has degree $4$ we see that the set $\{1,\bt,\bt^2,\bt^3\}$ is a
   basis for $\F_{16}$ over $\F_2$.  This gives the following list of
   elements of $\F_{16}$:
   \begin{align*}
     & 0,1,\bt,1+\bt,\bt^2,1+\bt^2,\bt+\bt^2,1+\bt+\bt^2, \\
     & \bt^3,1+\bt^3,\bt+\bt^3,1+\bt+\bt^3,\bt^2+\bt^3,
       1+\bt^2+\bt^3,\bt+\bt^2+\bt^3,1+\bt+\bt^2+\bt^3.
   \end{align*}
  \item[(c)] As the minimal polynomial of $\bt$ is $t^4+t^3+t^2+t+1$,
   we have $\bt^4+\bt^3+\bt^2+\bt+1=0$.  If we multiply by $\bt-1$ and
   cancel we get $\bt^5-1=0$, so $\bt^5=1$.
  \item[(d)] The homomorphisms from $\F_4$ to $\F_{16}$ biject with
   the roots of the minimal polynomial $g(t)=t^2+t+1=0$ in $\F_{16}$.
   As this polynomial has degree two, it can have at most two roots in
   any field.  Thus, if we can find two roots then we need not look
   for any more.  By working through our list of elements of $\F_{16}$
   we find that the required roots are as follows:
   \begin{align*}
    \gm &= \bt^2+\bt^3 \\
    \dl &= 1+\bt^2+\bt^3.
   \end{align*}
   Indeed, we have 
   \[ g(\gm) = 1 + \gm + \gm^2 
       = 1 + \bt^2 + \bt^3 + (\bt^4 + 2\bt^2\bt^3 + \bt^6).
   \]
   We can discard the term $2\bt^2\bt^3$ because $2=0$ in $\F_2$.  We
   also know that $\bt^5=1$, so $\bt^6=\bt$.  Using these the above
   equation simplifies to $g(\gm)=1+\bt+\bt^2+\bt^3+\bt^4$, but this
   is just the minimal polynomial evaluated at $\bt$, so $g(\gm)=0$.
   A similar argument shows that $g(\dl)=0$ as well.  It follows that
   the two homomorphisms $\phi,\psi\:\F_4\to\F_{16}$ are given by 
   \begin{align*}
    \phi(a_0+a_1\al) &= a_0 + a_1\gm = a_0 + a_1\bt^2 + a_1\bt^3 \\
    \psi(a_0+a_1\al) &= a_0 + a_1\dl = a_0 + a_1 + a_1\bt^2 + a_1\bt^3.
   \end{align*}
 \end{itemize}
\end{solution}

\section{Extending homomorphisms}
\label{sec-extensions}

\begin{definition}\lbl{defn-E}
 Suppose we have fields $K$, $L$ and $M$ and homomorphisms
 $\phi\:K\to L$ and $\psi\:K\to M$.  We write $E(\phi,\psi)$ for the
 set of homomorphisms $\tht\:L\to M$ with $\tht\phi=\psi$.  The fields
 and homomorphisms mentioned here can be displayed as follows:
 \[ \xymatrix{
      L \ar@{..>}[rr]^\tht & & M \\
      & K \ulto^\phi \urto_\psi
    }
 \]
 We also put $G(\phi)=E(\phi,\phi)$.  

 In particular, suppose we have a field $F$ with subfields $K$, $L$
 and $M$ such that $K\sse L\cap M$.  We then have inclusion maps
 $\inc_K^L\:K\to L$ and $\inc_K^m\:K\to M$, and we write
 \[ E_K(L,M) = E(\inc_K^L,\inc_K^M) = 
     \{\tht\:L\to M\st \tht|_K=1_K\}.
 \]
 We also write $G(L/K)$ for $E_K(L,L)$.
\end{definition}

\begin{remark}\lbl{rem-E-empty}
 Because $\deg(\tht\phi)=\deg(\tht)\deg(\phi)\geq\deg(\phi)$, we see
 that $E(\phi,\psi)$ can only be nonempty when
 $\deg(\phi)\leq\deg(\psi)$. 
\end{remark}

\begin{proposition}\lbl{prop-galois-group}
 If $\deg(\phi)<\infty$ then $G(\phi)$ is a group under composition.
 In alternative notation, if $[L:K]<\infty$ then $G(L/K)$ is a group
 under composition.  (These groups are called \emph{Galois groups}.)
\end{proposition}
\begin{proof}
 First, if $\tht,\eta\in G(\phi)$ then $\tht\phi=\phi$ and
 $\eta\phi=\phi$ so $(\tht\eta)\phi=\tht(\eta\phi)=\tht\phi=\phi$, so
 $\tht\eta\in G(\phi)$.
 \[ \xymatrix{
     L \rto^\eta & L \rto^\tht & L \\
     & K \ulto^\phi \uto^\phi \urto_\phi 
    }
 \]
 Next, the identity map $1_L$ lies in
 $G(\phi)$ and serves as a two-sided identity element for
 composition.  Finally, if $\deg(\phi)<\infty$ and $\tht\in G(\phi)$
 then we can cancel $\deg(\phi)$ in the identity
 $\deg(\phi)=\deg(\tht\phi)=\deg(\tht)\deg(\phi)$ to see that
 $\deg(\tht)=1$.  It follows from Proposition~\ref{prop-deg-one} that
 $\tht$ is an isomorphism.  We can compose both sides of the identity
 $\phi=\tht\phi$ with $\tht^{-1}$ to see that $\tht^{-1}\phi=\phi$, so
 $\tht^{-1}\in G(\phi)$ and serves there as an inverse for $\tht$. 
\end{proof}

It turns out to be important to understand the size of the sets
$E(\phi,\psi)$.  The most basic fact is as follows:

\begin{proposition}\lbl{prop-E-bound}
 For any $\phi$ and $\psi$ as above, we have
 $|E(\phi,\psi)|\leq\deg(\phi)$.  
\end{proposition}

After some preliminaries, we will give two different proofs, each of
which introduces new concepts that will be useful later.

The following result (or a minor variant) is often called Dedekind's
Lemma:  
\begin{proposition}\lbl{prop-dedekind}
 Let $L$ and $M$ be fields, let $\tht_1,\dotsc,\tht_n\:L\to M$ be
 distinct homomorphisms, and let $b_1,\dotsc,b_n$ be elements of $M$.
 Suppose that for all $a\in K$ we have $\sum_{i=1}^nb_i\tht_i(a)=0$.
 Then $b_1=b_2=\dotsc=b_n=0$.
\end{proposition}
\begin{proof}
 We will argue by induction on $n$.  If $n=1$ then we have
 $b_1\tht_1(a)=0$ for all $a\in K$, and we can take $a=1$ to see that
 $b_1=0$; this starts the induction.  Now suppose that $n>1$.  Fix
 some $t\in L$, and put $c_i=b_i(\tht_i(t)-\tht_n(t))$, so $c_n=0$.
 We claim that $\sum_{i=1}^{n-1}c_i\tht_i(a)=0$ for all $a\in L$.
 Indeed, the relation $\sum_{i=1}^nb_i\tht_i(a)=0$ is valid for all
 $a\in L$, so it works for $ta$ in place of $a$, which give
 $\sum_{i=1}^nb_i\tht_i(t)\tht_i(a)=0$.  On the other hand, we can
 just multiply the relation $\sum_{i=1}^nb_i\tht_i(a)=0$ by
 $\tht_n(t)$ to get $\sum_{i=1}^nb_i\tht_n(t)\tht_i(a)=0$, and then
 subtract this from the previous relation to get
 $\sum_{i=1}^{n-1}c_i\tht_i(a)=0$ as claimed.  We deduce from the
 induction hypothesis that $c_1=\dotsb=c_{n-1}=0$, so
 $b_i(\tht_i(t)-\tht_n(t))=0$ for all $i<n$ (and all $t\in L$, because
 $t$ was arbitrary).  By assumption the homomorphisms $\tht_i$ are all
 different, so for each $i<n$ we can choose $t_i\in L$ with
 $\tht_i(t_i)\neq\tht_n(t_i)$.  We can then take $t=t_i$ in the
 relation $b_i(\tht_i(t)-\tht_n(t))=0$ to get $b_i=0$.  This shows
 that $b_1=\dotsb=b_{n-1}=0$, so the relation
 $\sum_{i=1}^nb_i\tht_i(a)$ reduces to $b_n\tht_n(a)=0$ for all $a$.
 Now take $a=1$ to see that $b_n=0$ as well.
\end{proof}

\begin{proof}[First proof of Proposition~\ref{prop-E-bound}]
 Let $e_1,\dotsc,e_m$ be a basis for $L$ over $\phi(K)$ (so
 $m=\deg(\phi)$).  Let $\tht_1,\dotsc,\tht_n$ be the distinct elements
 of $E(\phi,\psi)$, so $\tht_i\phi=\psi\:K\to M$.  Define
 $v_1,\dotsc,v_n\in M^m$ by $v_i=(\tht_i(e_1),\dotsc,\tht_i(e_m))$.
 We claim that these $n$ vectors are linearly independent over $M$.
 To see this, consider a linear relation $b_1v_1+\dotsb+b_nv_n=0$
 (with $b_1,\dotsc,b_n\in M$).  This means that
 $\sum_{i=1}^nb_i\tht_i(e_j)=0$ for all $j$.  Now consider an
 arbitrary element $a\in L$.  As the elements $e_j$ give a basis for
 $L$ over $\phi(K)$, we can write $a=\sum_{j=1}^m\phi(x_j)e_j$ for
 some $x_1,\dotsc,x_m\in K$.  We can then apply $\tht_i$ to this,
 recalling that $\tht_i\phi=\psi$, to get
 $\tht_i(a)=\sum_{j=1}^m\psi(x_j)\tht_i(e_j)$.  It follows that 
 \[ \sum_{i=1}^n b_i\tht_i(a) = 
    \sum_{i=1}^n\sum_{j=1}^m b_i\psi(x_j)\tht_i(e_j) =
    \sum_{j=1}^m\left(\psi(x_j)\sum_{i=1}^n b_i\tht_i(e_j)\right)
      = 0.
 \]
 Proposition~\ref{prop-dedekind} therefore tells us that
 $b_1=\dotsb=b_n=0$.  We deduce that the vectors $v_1,\dotsc,v_n$ in
 $M^m$ are linearly independent as claimed.  The length of any
 linearly independent list is at most the dimension of the containing
 space, so we have $n\leq m$, or in other words
 $|E(\phi,\psi)|\leq\deg(\phi)$.  
\end{proof}

We next discuss a different approach, which starts by discusing the
case where $\phi$ has a primitive element, and then extends this by
induction.  

\begin{lemma}\lbl{lem-E-bound}
 Suppose we have $\phi$ and $\psi$ as above, and that $\al$ is a
 algebraic primitive element for $\phi$, with minimal polynomial
 $q(x)=\min(\al,\phi)\in K[x]$ say.  Then $E(\phi,\psi)$ bijects with
 the set of roots of $(\psi_\bullet q)(x)$ in $M$, and
 $|E(\phi,\psi)|\leq\deg(q(x))=\deg(\phi)$. 
\end{lemma}
\begin{proof}
 Let $d$ be the degree of $q(x)$, or equivalently the degree of the
 homomorphism $\phi$.  Let $F$ be the set of roots of
 $(\psi_\bullet q)(x)$ in $M$, so Corollary~\ref{cor-num-roots} tells
 us that $|F|\leq d$.  

 We can write $q(x)$ in the form $q(x)=a_0+a_1x+\dotsb+a_dx^d$, where
 $a_d=1$ because $q(x)$ is monic.  By definition we have
 $(\phi_\bullet q)(\al)=0$, or equivalently $\sum_i\phi(a_i)\al^i=0$.
 Suppose that $\tht\in E(\phi,\psi)$, so $\tht\phi=\psi:K\to M$.  We
 can then apply $\tht$ to the above equation to get 
 \[ (\psi_\bullet q)(\tht(\al)) = \sum_i\psi(a_i)\tht(\al)^i = 
     \tht(\sum_ia_i\al^i) = \tht(0) = 0,
 \]
 so $\tht(\al)\in F$.  We can thus define a map $P\:E(\phi,\psi)\to F$
 by $P(\tht)=\tht(\al)$.  

 Now suppose we have two elements $\tht_0,\tht_1\in E(\phi,\psi)$ with
 $P(\tht_0)=P(\tht_1)$, so $\tht_0(\al)=\tht_1(\al)=\bt$ say.  It
 follows from Corollary~\ref{cor-simple-algebraic} that every element
 $\sg\in L$ can be written in the form
 $\sg=\sum_{j=0}^{d-1}\phi(b_j)\al^j$, for some elements $b_j\in K$.
 Using $\tht_i(\phi(b))=\psi(b)$ and $\tht_i(\al)=\bt$ we deduce that
 $\tht_0(\sg)=\sum_j\psi(b_j)\bt^j=\tht_1(\sg)$.  As $\sg$ was
 arbitrary this means that $\tht_0=\tht_1$, so we see that $P$ is
 injective. 

 Finally, consider a general element $\bt\in F$, so $\bt$ is a root of
 $(\psi_\bullet q)(x)$.  We can then define a homomorphism
 $\lm\:K[x]\to M$ by $\lm(f(x))=(\psi_\bullet f)(\bt)$, or more
 explicitly
 \[ \lm(\sum_ib_ix^i) = \sum_i\psi(b_i)\bt^i. \]
 We then have $\lm(q(x))=0$, so $\lm(K[x].q(x))=0$.
 Proposition~\ref{prop-induced-hom} therefore gives us a homomorphism
 \[ \ov{\lm}\:K[x]/(K[x].q(x))\to M, \]
 which we can compose with the inverse of the isomorphism
 $\ov{\chi}\:K[x]/(K[x].q(x))\to L$ to get a homomorphism
 $\tht=\ov{\lm}\circ\ov{\chi}^{-1}\:L\to M$ which clearly satisfies
 $P(\tht)=\bt$.  This means that $P$ is also surjective, so it is a
 bijection, so $|E(\phi,\psi)|=|F|\leq d$.
\end{proof}

\begin{proposition}\lbl{prop-E-comp}
 Suppose we have homomorphisms
 \[ L \xla{\zt} N \xla{\xi} K \xra{\psi} M. \]
 Then $|E(\zt\xi,\psi)|=\sum_{\tht\in E(\xi,\psi)}|E(\zt,\tht)|$.
\end{proposition}
\begin{proof}
 Let $F$ be the set of pairs $(\tht,\eta)$ such that
 $\tht\in E(\xi,\psi)$ and $\eta\in E(\zt,\tht)$.  It is clear that
 $|F|=\sum_{\tht\in E(\xi,\psi)}|E(\zt,\tht)|$, so it will suffice to
 show that $F$ bijects with $E(\zt\xi,\psi)$.  

 If $\eta\in E(\zt\xi,\psi)$ then $\eta\zt\xi=\psi$, so the
 homomorphism $\tht=\eta\zt\:N\to M$ satisfies $\tht\xi=\psi$, so
 $\tht\in E(\xi,\phi)$.  From the definition $\tht=\eta\zt$ we also
 see that $\eta\in E(\zt,\tht)$, so $(\tht,\eta)\in F$.  We can thus
 define $P\:E(\xi\zt,\psi)\to F$ by $P(\eta)=(\eta\zt,\eta)$, and this
 is clearly a bijection with $P^{-1}(\eta)=(\eta\zt,\eta)$.  

 The following diagram may help to follow the argument:
 \[ \xymatrix{ 
   K \dto_\psi \rto^\xi &
   N \rto^\zt \ar@{..>}[d]^\tht & 
   L \ar@{..>}[d]^\eta \\
   M \rto_1 & 
   M \rto_1 &
   M.
 } \] 
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop-E-bound}]
 If $\deg(\phi)=\infty$ then there is nothing to prove, so we may
 assume that $\deg(\phi)<\infty$.  We will argue by induction on
 $\deg(\phi)$.  If $\deg(\phi)=1$ then $\phi$ is an isomorphism (by
 Proposition~\ref{prop-deg-one}) and so
 $|E(\phi,\psi)|=|\{\psi\phi^{-1}\}|=1$ as required.  Now consider the
 general case, where $\deg(\phi)=k>1$ say, and assume inductively that
 the proposition is valid for all homomorphisms of degree less than
 $k$.  Put $K'=\phi(K)$.  As $\phi$ is not an isomorphism, we have
 $K'<L$, so we can choose $\al\in L\sm K'$.  If $K'(\al)=L$ then the
 claim holds by Lemma~\ref{lem-E-bound}.  Otherwise, let $\zt$ be the
 inclusion $K'(\al)\to L$, and let $\xi$ be $\phi$ regarded as a
 homomorphism $K\to K'(\al)$, so $\zt\xi=\phi$.
 Proposition~\ref{prop-E-comp} then gives 
 \[ |E(\phi,\psi)| = |E(\zt\xi,\psi)| =
      \sum_{\tht\in E(\xi,\psi)}|E(\zt,\tht)|.
 \]
 As $\al\not\in K'$ and $K'(\al)\neq L$ we see that
 $\deg(\zt),\deg(\xi)>1$, but $\deg(\zt)\deg(\xi)=\deg(\phi)=k$, so
 $\deg(\zt),\deg(\xi)<k$.  We can thus apply the induction hypothesis
 to see that $|E(\xi,\psi)|\leq\deg(\xi)$ and
 $|E(\zt,\tht)|\leq\deg(\zt)$.  Feeding this into the above equation
 gives 
 \[ |E(\phi,\psi)|\leq \sum_{\tht\in E(\xi,\psi)}\deg(\zt) 
     = |E(\xi,\psi)|\deg(\zt) \leq \deg(\xi)\deg(\zt) = \deg(\phi)
 \]
 as required.
\end{proof}

\begin{definition}\lbl{defn-normal}
 Let $\psi\:K\to M$ be an extension of finite degree.  We say that
 $\psi$ is \emph{normal} if it has the following property: for every
 irreducible polynomial $f(x)\in K[x]$ such that $(\psi_\bullet f)(x)$
 has a root, $f(x)$ is properly split by $\psi$.
\end{definition}

\begin{lemma}\lbl{lem-splitting-ext}
 Suppose we have a field $K$, a monic polynomial $f(x)\in K[x]$, and a
 proper splitting field $L$ for $f(x)$.  Then $|G(L/K)|=d=[L:K]$.
\end{lemma}
\begin{proof}
 We have a splitting $f(x)=\prod_{i=1}^r(x-\al_i)$ in $L[x]$, with all
 the roots $\al_i$ being different.  Put $K_0=K$, and
 $K_i=K_{i-1}(\al_i)$ for $i>0$, so $K_0\sse K_1\sse\dotsb\sse K_r$.
 Moreover, $K_r$ is a subfield of $L$ that contains $K$ and all the
 roots $\al_i$, so it must be all of $L$.  Put $d_i=[K_i:K_{i-1}]$, so
 $d=\prod_{i=1}^rd_i$.  The claim is that there are precisely $d$
 different homomorphisms $\tht\:L\to L$ with $\tht|_K=1$.  More
 generally, we claim that the number of homomorphisms $\tht\:K_i\to L$
 with $\tht|_K=1$ is precisely $\prod_{j=1}^id_j$.  This is true for
 $i=0$ (where the product has no terms and so is equal to one).  It
 will thus be enough to prove the following induction step: given
 $\tht\:K_{i-1}\to L$ with $\tht|_K=1$, there are precisely $d_i$ ways
 to extend it to a homomorphism $\tht'\:K_i\to L$.  To see this, put
 $g_i(x)=\min(\al_i,K_{i-1})$, which is a polynomial of degree $d_i$.
 Lemma~\ref{lem-E-bound} tells us that the extensions of $\tht$ biject
 with the roots of $(\tht_\bullet g_i)(x)$, so it will be enough to
 show that that polynomial is properly split.  Note that $f(x)\in
 K[x]\sse K_{i-1}[x]$ and note that $f(\al_i)=0$, so $f(x)$ must be
 divisible in $K_{i-1}[x]$ by $g_i(x)$, say $f(x)=g_i(x)h_i(x)$.  We
 now apply $\tht_\bullet$ to this equation, noting that $\tht_\bullet
 f=f$ because $f(x)\in K[x]$ and $\tht|_K=1$.  We find that
 $(\tht_\bullet g)(x)(\tht_\bullet h)(x)=f(x)$, so
 Proposition~\ref{prop-split-factor} tells us that
 $(\tht_\bullet g)(x)$ is properly split as required.
\end{proof}

\begin{remark}\lbl{rem-splitting-ext}
 Suppose that $K$ has characteristic zero, and that $L$ is a (not
 necessarily proper) splitting field for some monic polynomial
 $f(x)\in K[x]$.  Remark~\ref{rem-split-factor} tells us that $L$ is a
 proper splitting field for some polynomial $g(x)$ that divides
 $f(x)$, and we can apply the above lemma to $g(x)$ to see that
 $|G(L/K)|=[L:K]$ again.
\end{remark}

\begin{proposition}\lbl{prop-normal}
 Let $\psi\:K\to M$ be a homomorphism of finite degree.  Then the
 following are equivalent:
 \begin{itemize}
  \item[(a)] For every field $L$ and homomorphism $\phi\:K\to L$, we
   have either $|E(\phi,\psi)|=0$ or $|E(\phi,\psi)|=\deg(\phi)$.
  \item[(b)] $|G(\psi)|=\deg(\psi)$.
  \item[(c)] $\psi$ is normal.
  \item[(d)] $\psi$ is a proper splitting extension for some
   polynomial $f(x)\in K[x]$.
 \end{itemize}
\end{proposition}
\begin{proof}
 First suppose that~(a) holds.  Recall that $G(\psi)=E(\psi,\psi)$,
 and this set clearly contains the identity map $1_M$, so it is
 nonempty.  It follows by~(a) that we must have
 $|G(\psi)|=\deg(\psi)$, so~(b) holds.

 Conversely, suppose that~(b) holds.  Suppose we have a homomorphism
 $\phi\:K\to L$ such that $E(\phi,\psi)\neq\emptyset$, so we can
 choose $\tht\in E(\phi,\psi)$, so $\tht\phi=\psi\:K\to M$.  It
 follows from our assumptions and Proposition~\ref{prop-E-comp} that 
 \begin{align*}
   \deg(\phi)\deg(\tht) 
    &= \deg(\psi) =|E(\psi,\psi)| = |E(\tht\phi,\psi)| \\
    &= \sum_{\lm\in E(\phi,\psi)}|E(\tht,\lm)|
     \leq \sum_{\lm\in E(\phi,\psi)}\deg(\tht) = 
     |E(\phi,\psi)|\deg(\tht).
 \end{align*}
 This can be rearranged to give $|E(\phi,\psi)|\geq\deg(\phi)$, and
 Proposition~\ref{prop-E-bound} gives the reverse inequality, so~(b)
 holds.  We now see that~(a) and~(b) are equivalent.

 Now suppose that~(a) and~(b) hold, and consider~(c).  Suppose we have
 an irreducible polynomial $f(x)\in K[x]$, of degree $d$.  Put
 $L=K[x]/(K[x].f(x))$ as in Proposition~\ref{prop-adjoin-root}, so $L$
 is a field equipped with an obvious homomorphism $\phi\:K\to L$ of
 degree $d$.  We let $\al$ denote the image of $x$ in $L$, which is a
 primitive element for $\phi$, with minimal polynomial $f(x)$.  We see
 from Lemma~\ref{lem-E-bound} that the number of roots of
 $(\psi_\bullet f)(x)$ is $|E(\phi,\psi)|$, which is either $0$ or $d$
 by~(b).  Thus, if there is at least one root then there are $d$
 distinct roots, say $\bt_1,\dotsc,\bt_d$.  It follows by
 Proposition~\ref{prop-several-roots} that
 $(\psi_\bullet f)(x)=\prod_{i=1}^d(x-\bt_i)$, so
 $(\psi_\bullet f)(x)$ is split as required.

 Now suppose that~(c) holds, so $\psi$ is normal.  Choose a basis
 $\al_1,\dotsc,\al_d$ for $M$ over $\psi(K)$, and put
 $f_i(x)=\min(\al_i,\psi)$ and $f(x)=\prod_if_i(x)$.  Then
 $(\psi_\bullet f_i)(x)$ has a root $\al_i$ and $\psi$ is normal so
 $(\psi_\bullet f_i)(x)$ must be split.  It follows that
 $(\psi_\bullet f)(x)$ is also split, and the roots include the
 elements $\al_i$, so they certainly generate $M$.  Thus~(d) holds. 

 Finally, Lemma~\ref{lem-splitting-ext} shows that~(d) implies~(b),
 completing the cycle.
\end{proof}

\begin{remark}\lbl{rem-normal-not-transitive}
 Suppose we have fields $K\sse L\sse M$, where $L$ is normal over $K$,
 and $M$ is normal over $L$.  It need not be the case that $L$ is
 normal over $K$.  For an example (which will be revisited as
 Example~\ref{eg-even-quartic}), take $\al=\sqrt{3+\sqrt{7}}$ and
 consider the chain $\Q\sse\Q(\sqrt{7})\sse\Q(\al)$.  Here
 $\Q(\sqrt{7})$ is a splitting field for $x^2-7$ over $\Q(\sqrt{7})$,
 and $\Q(\al)$ is a splitting field for $x^2-3-\sqrt{7}$ over
 $\Q(\sqrt{7})$, so both these extensions are normal.  However, we
 claim that $\Q(\al)$ is not normal over $\Q$.  Indeed, $\al$ is a
 root of the polynomial $f(x)=x^4-6x^2+2$, which is irreducible over
 $\Q$ by Eisenstein's criterion at the prime $2$.  The element
 $\bt=\sqrt{3-\sqrt{7}}$ is another root of $f(x)$ in $\R$.  We will
 show in Example~\ref{eg-even-quartic} that $\bt\not\in\Q(\al)$ (a key
 point being that $\al\bt=\sqrt{2}$).  It follows that $f(x)$ does not
 split in $\Q(\al)[x]$, and thus that $\Q(\al)$ is not normal over
 $\Q$, as claimed.
\end{remark}

\begin{corollary}\lbl{cor-normal-closure}
 Let $\xi\:K\to N$ be a homomorphism of finite degree.  Then there is
 a field $M$ and a homomorphism $\eta\:N\to M$ such that $\eta\xi$ is
 normal.  
\end{corollary}
\begin{proof}
 Choose a basis $e_1,\dotsc,e_n$ for $N$ over $\xi(K)$.  Put
 $f_i(t)=\min(e_i,\xi)$ and $f(t)=\prod_if_i(t)\in K[t]$.  Let
 $\eta\:N\to M$ be a splitting homomorphism for $(\xi_\bullet f)(t)$
 (which is possible by Proposition~\ref{prop-construct-splitting}).
 Let $M'$ be the subfield of $M$ generated by $\eta\xi(K)$ together
 with the roots of the polynomial $g(t)=((\eta\xi)_\bullet f)(t)$.  As
 $(\xi_\bullet f_i)(e_i)=0$ we see that $g(\eta(e_i))=0$, and the
 elements $e_i$ generate $L$ over $\xi(K)$ so the elements $\eta(e_i)$
 generate $\eta(L)$ over $\eta\xi(K)$, so $\eta(L)\sse M'$.  Moreover,
 as $\eta$ is a splitting homomorphism for $(\xi_\bullet f)(t)$ we
 know that the roots of $g(t)$ generate $M$ over $\eta(L)$.  It
 follows that $M=M'$, so $\eta\xi$ is a splitting homomorphism for
 $f(t)$.  It follows that $\eta\xi$ is normal as claimed.
\end{proof}

\begin{proposition}\lbl{prop-top-normal}
 Let $K\xra{\xi}N\xra{\eta}M$ be homomorphisms such that $\eta\xi$ is
 normal.  Then:
 \begin{itemize}
  \item[(a)] $\eta$ is also normal.
  \item[(b)] Suppose we have a homomorphism $\zt\:N\to L$ such that
   $E(\zt\xi,\eta\xi)\neq\emptyset$ (and so
   $|E(\zt\xi,\eta\xi)|=\deg(\zt\xi)=\deg(\zt)\deg(\xi)$).  Then also
   $E(\zt,\eta)\neq\emptyset$ (and so $|E(\zt,\eta)|=\deg(\zt)$). 
 \end{itemize}
\end{proposition}
\begin{proof}
 We start with the second statement.  Let $\xi$, $\eta$ and $\zt$ be
 as in~(b).  We apply Lemma~\ref{prop-E-comp} (with $\psi=\eta\xi$) to
 see that 
 \[ \deg(\zt)\deg(\xi) = |E(\zt\xi,\eta\xi)| =
      \sum_{\tht\in E(\xi,\eta\xi)}|E(\zt,\tht)|.
 \]
 The number of terms in the sum is $|E(\xi,\eta\xi)|\leq\deg(\xi)$,
 and each term $|E(\zt,\tht)|$ is at most $\deg(\zt)$.  Thus, the only
 way that the sum can be equal to $\deg(\zt)\deg(\xi)$ is if all these
 inequalities are actually equalities, so $|E(\xi,\eta\xi)|=\deg(\xi)$
 and $|E(\zt,\tht)|=\deg(\zt)$ for all $\tht\in E(\xi,\eta\xi)$.
 Recall here that $\tht\in E(\xi,\eta\xi)$ just means that
 $\tht\xi=\eta\xi$, so certainly $\eta\in E(\xi,\eta\xi)$.  We can
 thus take $\tht=\eta$ in the previous statement to see that
 $|E(\zt,\eta)|=\deg(\zt)$ as claimed (so in particular
 $E(\zt,\eta)\neq\emptyset$). 

 We now deduce that $\eta$ is normal.  Consider $\zt\:N\to L$ such
 that $E(\zt,\eta)\neq\emptyset$.  This means that there exists
 $\sg\:L\to M$ with $\sg\zt=\eta$.  It follows that
 $\sg\zt\xi=\eta\xi$, so $\sg\in E(\zt\xi,\eta\xi)$, so we can
 apply~(b) to see that $|E(\zt,\eta)|=\deg(\zt)$.  By
 Proposition~\ref{prop-normal}(a), this means that $\eta$ is normal.

 The homomorphisms considered above can be displayed as follows:
 \[ \xymatrix{
     L \ar@{..>}[rr]^\sg & & M \\
     & N \ulto^\zt \urto_{\eta,\tht} \\
     & K \uto_\xi
    }
 \]
\end{proof}
\begin{corollary}\lbl{cor-top-normal-a}
 Let $K\xra{\xi}N\xra{\eta}M$ be homomorphisms such that $\eta\xi$ is
 normal, and let $\zt\:N\to M$ be a homomorphism such that
 $\zt\xi=\eta\xi$.  Then $\eta$ is normal, and there exists
 $\sg\:M\to M$ with $\sg\zt=\eta$.
\end{corollary}
\begin{proof}
 This is a special case of part~(b) of the proposition, where $L=M$
 and $\zt\xi=\eta\xi$.  In this context, the homomorphism $1_M$ is an
 element of $E(\zt\xi,\eta\xi)$, so $E(\zt\xi,\eta\xi)\neq\emptyset$.
 The proposition then tells us that $E(\zt,\eta)\neq\emptyset$, so we
 can choose $\sg\in E(\zt,\xi)$, which means precisely that
 $\sg\zt=\eta$ as claimed.
\end{proof}
\begin{corollary}\lbl{cor-top-normal-b}
 Suppose we have a chain of finite extension $K\sse N\sse M$ such that
 $M$ is normal over $K$.  Then $M$ is also normal over $N$.  Moreover,
 for any homomorphism $\zt\:N\to M$ such that $\zt|_K=1_K$, there is
 an automorphism $\sg$ of $M$ such that $\sg|_N=\zt$.  Also, if
 $\sg'$ is any other automorphism of $M$ with $\sg'|_N=\zt$ then
 $\sg'=\sg\tau$ for some $\tau\in G(M/N)$.
\end{corollary}
\begin{proof}
 The first claim is a special case of the previous corollary, where
 $\xi\:K\to N$ and $\eta\:N\to M$ are just the inclusion maps.  Now
 suppose we have another automorphism $\sg'$ with $\sg'|_N=\zt$.
 Put $\tau=\sg^{-1}\sg'\:M\to M$, so $\sg'=\sg\tau$.  If $a\in N$ then
 $\sg'(a)=\zt(a)=\sg(a)$ and we can apply $\sg^{-1}$ to this equation
 to see that $\tau(a)=a$.  This shows that $\tau\in G(M/N)$ as
 claimed.   
\end{proof}

We next discuss the action of Galois groups on sets of roots.  Suppose
we have a field extension $K\sse L$, and a polynomial $f\in K[x]$.
Put $R=\{\al\in L\st f(\al)=0\}$, the (finite) set of roots of $f$ in
$L$.  We write $\Sg_R$ for the set of permutations of $R$, or in other
words the set of bijective functions $\sg\:R\to R$.

It is more usual to discuss the group $\Sg_n$ of permutations of the
finite set $N=\{1,\dotsc,n\}$, but but it is no harder to consider
permutations of an arbitrary finite set, as we do here.  For example,
suppose we have a set $R=\{\al,\bt,\gm\}$ of size three.  We then have
a transposition $\tau=(\al\;\bt)$, defined by $\tau(\al)=\bt$ and
$\tau(\bt)=\al$ and $\tau(\gm)=\gm$.  We also have a three-cycle
$\rho=(\al\;\bt\;\gm)$, defined by $\rho(\al)=\bt$ and $\rho(\bt)=\gm$
and $\rho(\gm)=\al$.  The full group $\Sg_R$ consists of the identity
permutation, the three-cycles $\rho$ and $\rho^{-1}=(\gm\;\bt\;\al)$,
and the transpositions $\tau=(\al\;\bt)$, $(\bt\;\gm)$ and
$(\gm\;\al)$.  In general, if $|R|=n$ then $\Sg_R$ is isomorphic to
$\Sg_n$.  To see this, we choose a numbering of the elements of $R$,
say $R=\{\al_1,\dotsc,\al_n\}$.  Then for any $\sg\in\Sg_R$ we must
have $\sg(\al_i)=\al_{\ov{\sg}(i)}$ for some index $\ov{\sg}(i)$.  It
is easy to see that $\ov{\sg}$ is then a permutation of
$\{1,\dotsc,n\}$, and the correspondence $\sg\leftrightarrow\ov{\sg}$
gives an isomorphism $\Sg_R\simeq\Sg_n$.

\begin{proposition}\lbl{prop-root-perms}
 Let $R$ be the set of roots in $L$ of a polynomial $f(x)\in K[x]$,
 with $K\leq L$.
 \begin{itemize}
  \item[(a)] If $\sg\in G(L/K)$ and $\al\in R$ then $\sg(\al)\in R$.
   Thus, there is a homomorphism $G(L/K)\to\Sg_R$ given by
   $\sg\mapsto\sg|_R$.
  \item[(b)] If $L$ is a splitting field for $f(x)$ then this
   homomorphism is injective, so $G(L/K)$ can be regarded as a
   subgroup of $\Sg_R$.
  \item[(c)] If $f(x)$ is irreducible then for all $\al,\bt\in R$
   there exists $\sg\in G(L/K)$ such that $\sg(\al)=\bt$.  In other
   words, the group $G(L/K)$ acts transitively on $R$.
 \end{itemize}
\end{proposition}
\begin{proof}
 \begin{itemize}
  \item[(a)] We can write $f(x)=\sum_{i=0}^da_ix^i$, where
   $a_i\in K$.  Suppose that $\al\in R$, so
   $\sum_{i=0}^da_i\al^i=f(\al)=0$.  We can apply $\sg$ to this to get 
   $\sum_{i=0}^d\sg(a_i)\sg(\al)^i=\sg(0)=0$.  However, we have
   $\sg\in G(L/K)$ so $\sg|_K=1_K$, and $a_i\in K$ so $\sg(a_i)=a_i$.
   We therefore have $\sum_{i=0}^da_i\sg(\al)^i=0$, or in other words
   $f(\sg(\al))=0$, so $\sg(\al)\in R$ as claimed.  We can therefore
   restrict $\sg$ to give a map $\sg|_R\:R\to R$.  Now $G(L/K)$ is a
   group, so we have an inverse element $\sg^{-1}\in G(L/K)$, which we
   can also restrict to get another map $\sg^{-1}|_R\:R\to R$.  This
   is easily seen to be inverse to $\sg|_R$, so $\sg|_R$ is a
   bijection and thus an element of $\Sg_R$.  It is also clear that
   restriction is compatible with composition and thus that the map
   $\sg\mapsto\sg|_R$ is a homomorphism $G(L/K)\to\Sg_R$.
  \item[(b)] Now suppose that $L$ is a splitting field for $f(x)$, so
   $L$ is generated over $K$ by $R$, so the only field $L'$ with
   $K\cup R\sse L'\sse L$ is $L$ itself.  Put
   $H=\{\sg\in G(L/K)\st \sg|_R=1_R\}$, which is the kernel of our
   homomorphism $G(L/K)\to\Sg_R$.  Consider the subfield
   \[ L^H=\{a\in L\st \sg(a)=a \text{ for all } \sg\in H\} \]
   (as in Proposition~\ref{prop-fixed-subfield}).  Clearly $R\sse L^H$
   by the definition of $H$.  Moreover, all elements of $G(L/K)$ act
   as the identity on $K$ (by the definition of $G(L/K)$) so
   $K\sse L^H$.  As $L$ is generated over $K$ by $R$, we must have
   $L^H=L$.  This means that for all $\sg\in H$ we have
   $\sg(a)=a$ for all $a\in L$, so $\sg=1_L$.  This shows that
   $H=\{1_L\}$, so our homomorphism $G(L/K)\to\Sg_R$ has trivial
   kernel and is therefore injective.
  \item[(c)] Now suppose that $f(x)$ is irreducible, so
   $\min(\al,K)=f(x)$ for all $\al\in R$.  Consider a pair of roots
   $\al,\bt\in R$.  Note that $\al$ is a primitive element for
   $K(\al)$ and that $\bt$ is a root of $\min(\al,K)$.  It therefore
   follows from Lemma~\ref{lem-E-bound} that there is a unique
   homomorphism $\tht\:K(\al)\to L$ with $\tht|_K=1_K$ and
   $\tht(\al)=\bt$.  Corollary~\ref{cor-top-normal-b} (applied to the
   chain $K\sse K(\al)\sse L$) now tells us that there is an
   automorphism $\sg$ of $L$ such that $\sg|_{K(\al)}=\tht$, and in
   particular $\sg(\al)=\tht(\al)=\bt$ as required.
 \end{itemize}
\end{proof}

\begin{remark}\lbl{rem-generic-galois}
 If $L$ is a splitting field for a randomly generated polynomial
 $f(x)\in K[x]$ (for an infinite field $K$), the most common situation
 is that the map $G(L/K)\to\Sg_R$ is an isomorphism.  However, we will
 mostly consider special cases where the Galois group is smaller than
 $\Sg_R$, as these tend to have a more interesting structure.
\end{remark}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-abelian-transitive}
 Let $A$ be an abelian subgroup of $\Sg_n$ that acts transitively on
 the set $N=\{1,2,\dotsc,n\}$.  Show that if $\sg\in A$ and $\sg(i)=i$
 for some $i\in N$, then $\sg$ is the identity.  (In other words, the
 action is free.)  Deduce that $|A|=n$.
\end{exercise}
\begin{solution}
 Suppose that $\sg(i)=i$.  Transitivity means that for any $j\in N$ we
 can choose $\tau\in A$ with $\tau(i)=j$.  As $A$ is commutative we
 then have
 \[ \sg(j) = \sg(\tau(i)) = \tau(\sg(i)) = \tau(i) = j. \]
 As $j$ was arbitrary, this means that $\sg$ is the identity.  
 Thus the action is free, as claimed.

 Next, as $A$ is transitive we can choose $\sg_i\in A$ (for
 $i=1,\dotsc,N$) such that $\sg_i(1)=i$.  Now let $\tau$ be any
 element of $A$.  Put $i=\tau(1)$, and note that $\tau^{-1}\sg_i$
 sends $1$ to $1$.  As the action is free this means that
 $\tau^{-1}\sg_i=1$, so $\tau=\sg_i$.  This means that
 $A=\{\sg_1,\dotsc,\sg_n\}$, and these elements are all different,
 so $|A|=n$.
\end{solution}
\begin{exercise}\exlabel{ex-root-sqrt}
 Consider a monic polynomial $f(x)\in\Q[x]$ of degree $d>1$.
 \begin{itemize}
  \item[(a)] Show that if $f(x^2)$ is irreducible, then so is $f(x)$.
  \item[(b)] Give an example where $f(x)$ is irreducible but $f(x^2)$
   is not.
  \item[(c)] Suppose that $f(x^2)$ is irreducible.  Let $K$ be the
   splitting field of $f(x)$ in $\C$, and let $L$ be the splitting
   field of $f(x^2)$.  How much can you say about the relationship
   between $K$ and $L$, and the corresponding Galois groups?
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] Suppose that $f(x^2)$ is irreducible.  If $f(x)=u(x)v(x)$
   then $f(x^2)=u(x^2)v(x^2)$, and as $f(x^2)$ is irreducible this
   means that either $u(x^2)$ or $v(x^2)$ is constant, so either
   $u(x)$ or $v(x)$ is constant.  This proves that $f(x)$ is
   irreducible.
  \item[(b)] The polynomial $f(x)=\vph_3(x)=x^2+x+1$ is irreducible,
   but one can check directly that $f(x^2)=f(x)f(-x)$, which shows
   that $f(x^2)$ is reducible.
  \item[(c)] Let $\al_1,\dotsc,\al_d$ be the roots of $f(x)$ in $\C$.
   As $f(x)$ has degree greater than one and is irreducible, it cannot
   be divisible by $x$, so we must have $\al_i\neq 0$ for all $i$.
   Choose a square root $\bt_i$ for $\al_i$.  We then have
   $f(x)=\prod_i(x-\al_i)=\prod_i(x-\bt_i^2)$, so
   \[ f(x^2) = \prod_i(x^2-\bt_i)^2 = \prod_i(x-\bt_i)(x-(-\bt_i)). \]
   It follows that $L=\Q(\bt_1,\dotsc,\bt_d)$ and 
   \[ K = \Q(\al_1,\dotsc,\al_d) =
       \Q(\bt_1^2,\dotsc,\bt_d^2) \sse L.
   \]
   As both $K$ and $L$ are normal over $\Q$, we know that $G(L/K)$ is
   a normal subgroup of $G(L/\Q)$, and that
   $G(L/\Q)/G(L/K)\simeq G(K/\Q)$.  For $\sg\in G(L/K)$ we know that
   $\sg(\bt_i)^2=\al_i=\bt_i^2$, so $\sg(\bt_i)/\bt_i\in\{1,-1\}$.  We
   define $\chi_i(\sg)=\sg(\bt_i)/\bt_i$; it is not hard to check that
   this gives a group homomorphism $\chi_i\:G(L/K)\to\{1,-1\}$.  We
   can put these together to define a map $\chi\:G(L/K)\to\{1,-1\}^d$
   by $\chi(\sg)=(\chi_1(\sg),\dotsc,\chi_d(\sg))$.  As the elements
   $\bt_i$ generate $L$ over $K$, we see that $\chi$ is injective,
   so $G(L/K)$ is an elementary abelian $2$-group.  We cannot say much
   more than this without more information about the polynomial
   $f(x)$.  
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-sqrt-chain}
 Consider the field $K=\Q(\sqrt{111+\sqrt{11+\sqrt{1111}}})$.  This can
 be considered as the top of a chain of extensions 
 \[ \Q = K_0 \subset \Q(\sqrt{1111}) = K_1 \subset 
    \Q(\sqrt{11+\sqrt{1111}}) = K_2 \subset 
    \Q(\sqrt{111+\sqrt{11+\sqrt{1111}}}) = K_3 = K.
 \] 
 \begin{itemize}
  \item[(a)] Analyse all the field homomorphisms $\phi_1\:K_1\to\R$.
  \item[(b)] For each such homomorphism, analyse the possible
   extensions $\phi_2\:K_2\to\R$.
  \item[(c)] For each such extensions, analyse the possible
   extensions $\phi_3\:K_3\to\R$.
  \item[(d)] Deduce the value of $|E_\Q(K,\R)|$ (and observe that it
   is less than $[K:\Q]$, as we proved in lectures).
  \item[(e)] Check in a similar way that $|E_\Q(K,\C)|=[K:\Q]$.
 \end{itemize}
\end{exercise}
\begin{solution}
 Put $\al_1=\sqrt{1111}$ and $\al_2=\sqrt{11+\al_1}$ and
 $\al_3=\sqrt{111+\al_2}$, so $K_i=K_{i-1}(\al_i)$.
 \begin{itemize}
  \item[(a)] Homomorphisms $\phi_1\:K_1\to\R$ biject with roots in
   $\R$ of the polynomial
   $\min(\al_1,K_0)(t)=\min(\sqrt{1111},\Q)(t)=t^2-1111$.  These roots
   are $\al_1\simeq 33.332$ and $-\al_1\simeq -33.332$.  More
   explicitly, there are two possible homomorphisms, namely
   \begin{align*}
    \phi_{11}(u+v\al_1) &= u+v\al_1 \\
    \phi_{12}(u+v\al_1) &= u-v\al_1.
   \end{align*}
  \item[(b)] The minimal polynomial of $\al_2$ over $K_1$ is
   $t^2-11-\al_1$.  If we apply $\phi_{11}$ to the coefficients of this,
   we just get the polynomial $t^2-11-\al_1$ again.  The extensions of
   $\phi_{11}$ biject with the roots in $\R$ of this polynomial, which
   are $\al_2\simeq 6.658$ and $-\al_2\simeq -6.658$.  More
   explicitly, there are two possible extensions of $\phi_{11}$,
   given by
   \begin{align*}
    \phi_{21}(u+v\al_2) &= u+v\al_2 \\
    \phi_{22}(u+v\al_2) &= u-v\al_2
   \end{align*}
   for all $u,v\in K_1$.  Alternatively, we can look back at the proof
   of the degree formula $[K_2:K_0]=[K_2:K_1][K_1:K_0]=2\tm 2=4$ and
   see that the list $1,\al_1,\al_2,\al_1\al_2$ is a basis for $K_2$
   over $\Q$.  In terms of this basis, we have 
   \begin{align*}
    \phi_{21}(u+v\al_1+w\al_2+x\al_1\al_2) &= u+v\al_1+w\al_2+x\al_1\al_2 \\
    \phi_{22}(u+v\al_1+w\al_2+x\al_1\al_2) &= u+v\al_1-w\al_2-x\al_1\al_2
   \end{align*}
   for all $u,v,w,x\in\Q$.  Now consider instead extensions of the
   homomorphism $\phi_{12}$.  These again biject with the roots in
   $\R$ of a certain polynomial.  To find the required polynomial, we
   take $\min(\al_2,K_1)(t)=t^2-11-\al_1$ and apply $\phi_{12}$ to the
   coefficients, giving $t^2-11+\al_1$.  Here $11-\al_1\simeq
   -22.332<0$, so there are no such roots.  This means that
   the homomorphism $\phi_{12}\:K_1\to\R$ cannot be extended over
   $K_2$.  
  \item[(c)] The minimal polynomial of $\al_3$ over $K_2$ is
   $t^2-111-\al_2$.  If we apply $\phi_{21}$ to the coefficients of this,
   we just get the polynomial $t^2-111-\al_2$ again.  The extensions of
   $\phi_{21}$ over $K_3$ biject with the roots in $\R$ of this
   polynomial, which are $\al_3\simeq 10.847$ and $-\al_3\simeq
   -10.847$.  More explicitly, any element $a\in K_3$ can be written as 
   \[ a = a_0 + a_1\al_1 + a_2\al_2 + a_3\al_1\al_2 + 
          a_4\al_3 + a_5\al_1\al_3 + a_6\al_2\al_3 + a_7\al_1\al_2\al_3,
   \]
   and we then have 
   \begin{align*}
    \phi_{31}(a) &= 
          a_0 + a_1\al_1 + a_2\al_2 + a_3\al_1\al_2 + 
          a_4\al_3 + a_5\al_1\al_3 + a_6\al_2\al_3 + a_7\al_1\al_2\al_3\\
    \phi_{32}(a) &=
          a_0 + a_1\al_1 + a_2\al_2 + a_3\al_1\al_2 -
          a_4\al_3 - a_5\al_1\al_3 - a_6\al_2\al_3 - a_7\al_1\al_2\al_3.
   \end{align*}
   Now consider instead extensions of the homomorphism $\phi_{22}$.
   These biject with the roots in $\R$ of the polynomial $t^2-111+\al_2$
   (obtained by applying $\phi_{22}$ to the coefficients of
   $\min(\al_3,K_2)(t)=t^2-111-\al_2$).  Here $111-\al_2\simeq
   104.342>0$ so there are two roots, say $\al'_3\simeq 10.214$ and
   $-\al'_3\simeq -10.214$.  This gives two extensions of $\phi_{22}$:
   \begin{align*}
    \phi_{33}(a) &= 
          a_0 + a_1\al_1 - a_2\al_2 - a_3\al_1\al_2 + 
          a_4\al'_3 + a_5\al_1\al'_3 - a_6\al_2\al'_3 - a_7\al_1\al_2\al'_3\\
    \phi_{34}(a) &=
          a_0 + a_1\al_1 - a_2\al_2 - a_3\al_1\al_2 -
          a_4\al'_3 - a_5\al_1\al'_3 + a_6\al_2\al_3 + a_7\al_1\al_2\al_3.
   \end{align*}
  \item[(d)] We now have
   $E_\Q(K,\R)=\{\phi_{31},\phi_{32},\phi_{33},\phi_{34}\}$ and so
   $|E_\Q(K,\R)|=4$.  On the other hand, we have
   $[K:\Q]=[K_3:K_2][K_2:K_1][K_1:K_0]=2\tm 2\tm 2=8$, so
   $|E_\Q(K,\R)|<[K:\Q]$ as claimed.
  \item[(e)] The same methods show that there are eight different
   homomorphisms from $K$ to $\C$, which can be characterised as
   follows:
   \begin{align*}
    \phi_{31}(\al_3) &= \sqrt{111+\sqrt{11+\sqrt{1111}}} \simeq 10.847 \\
    \phi_{32}(\al_3) &= -\sqrt{111+\sqrt{11+\sqrt{1111}}} \simeq -10.847 \\
    \phi_{33}(\al_3) &= \sqrt{111-\sqrt{11+\sqrt{1111}}} \simeq 10.214 \\
    \phi_{34}(\al_3) &= -\sqrt{111-\sqrt{11+\sqrt{1111}}} \simeq -10.214 \\
    \phi_{35}(\al_3) &= \sqrt{111+\sqrt{11-\sqrt{1111}}} \simeq 10.538+0.224i \\
    \phi_{36}(\al_3) &= -\sqrt{111+\sqrt{11-\sqrt{1111}}} \simeq -10.538-0.224i \\
    \phi_{37}(\al_3) &= \sqrt{111-\sqrt{11-\sqrt{1111}}} \simeq 10.214-0.224i \\
    \phi_{38}(\al_3) &= -\sqrt{111-\sqrt{11-\sqrt{1111}}} \simeq -10.214+0.224i.
   \end{align*}
 \end{itemize}
\end{solution}

\begin{exercise}\exlabel{ex-dedekind-direct}
 Put $L=\Q(\sqrt{p},\sqrt{q})$ where $p$ and $q$ are distinct primes. 
 There are homomorphisms $\tht_0,\dotsc,\tht_3\:L\to L$ given by 
 \begin{align*}
  \tht_0(\sqrt{p}) &=  \sqrt{p} &
  \tht_1(\sqrt{p}) &=  \sqrt{p} &
  \tht_2(\sqrt{p}) &= -\sqrt{p} &
  \tht_3(\sqrt{p}) &= -\sqrt{p} \\
  \tht_0(\sqrt{q}) &=  \sqrt{q} &
  \tht_1(\sqrt{q}) &= -\sqrt{q} &
  \tht_2(\sqrt{q}) &=  \sqrt{q} &
  \tht_3(\sqrt{q}) &= -\sqrt{q}  
 \end{align*}
 Dedekind's Lemma tells us that if $b_0,\dotsc,b_3\in L$ with
 $\sum_ib_i\tht_i=0$ then we must have $b_0=b_1=b_2=b_3=0$.  Give a
 more direct proof of this fact.
\end{exercise}
\begin{solution}
 Suppose we have $\sum_ib_i\tht_i$, or in other words
 $\sum_ib_i\tht_i(a)=0$ for all $a\in L$.  Taking $a=1$ we get 
 \begin{align*}
  b_0+b_1+b_2+b_3 &= 0 \tag{A} \\
  \intertext{Similarly, we can take $a$ to be $\sqrt{p}$, $\sqrt{q}$
   or $\sqrt{pq}$ to get three more equations:}
  b_0\sqrt{p}+b_1\sqrt{p}-b_2\sqrt{p}-b_3\sqrt{p} &= 0 \\
  b_0\sqrt{q}-b_1\sqrt{q}+b_2\sqrt{q}-b_3\sqrt{q} &= 0 \\
  b_0\sqrt{pq}-b_1\sqrt{pq}-b_2\sqrt{pq}+b_3\sqrt{pq} &= 0. \\
  \intertext{After dividing by $\sqrt{p}$, $\sqrt{q}$ and $\sqrt{pq}$
   respectively we get}
  b_0+b_1-b_2-b_3 &= 0 \tag{B} \\
  b_0-b_1+b_2-b_3 &= 0 \tag{C} \\
  b_0-b_1-b_2+b_3 &= 0. \tag{D}
 \end{align*}
 Adding~(A), (B), (C) and~(D) gives $b_0=0$.  We can then add~(A)
 and~(B) to get $b_1=0$.  Similar manipulations then give $b_2=b_3=0$,
 as required.
\end{solution}
\begin{exercise}\exlabel{ex-basis-misc-i}
 Put $\al=2^{1/4}\in\R$ and $K=\Q(\al,i)\sse\C$.  Then $K$ is spanned
 over $\Q(i)$ by $1,\al,\al^2,\al^3$, but it is not completely clear
 that these are linearly independent.  We can check this and prove
 some other facts as follows.
 \begin{itemize}
  \item[(a)] Prove that $[\Q(\al):\Q]=4$.
  \item[(b)] Prove that $[K:\Q(\al)]=2$, and that $[\Q(i):\Q]=2$.
  \item[(c)] Deduce that $[K:\Q(i)]=4$.
  \item[(d)] Prove that $K$ is normal over $\Q(i)$, and that
   $G(K/\Q(i))$ is cyclic of order $4$.
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] Note that $\al$ is a root of the polynomial $f(x)=x^4-2$,
   which is irreducible over $\Q$ by Eisenstein's criterion at the prime $2$.
   It follows that $f(x)$ is the minimal polynomial of $\al$ over
   $\Q$, and so $[\Q(\al):\Q]=\deg(f(x))=4$.
  \item[(b)] Any element of $a\in K$ can be written as $a=x+iy$ with
   $x,y\in\Q(\al)$, and $x$ and $y$ are the real and imaginary part of
   $a$, so they are uniquely determined.  It follows that $1,i$ is a
   basis for $K$ over $\Q(\al)$, so $[K:\Q(\al)]=2$.  We see in the
   same way that $[\Q(i):\Q]=2$.
  \item[(c)] We now have 
   \[ [K:\Q(i)][\Q(i):\Q] = [K:\Q] = [K:\Q(\al)][\Q(\al):\Q]. \]
   After inserting the values obtained in~(a) and~(b) we see that
   $[K:\Q]=8$ and $[K:\Q(i)]=4$.
  \item[(d)] We have $f(x)=(x-\al)(x-i\al)(x-i^2\al)(x-i^3\al)$ in
   $K[x]$, so $K$ is a splitting field for $f(x)$ over $\Q(i)$, so it
   is normal over $\Q(i)$.  Note also that
   $[K:\Q(i)]=[\Q(i,\al):\Q(i)]=4$, so $\min(\al,\Q(i))$ must have
   degree $4$, so it must be the same as $f(x)$.  This means that
   $f(x)$ is still irreducible over $\Q(i)$, so the Galois group acts
   transitively on the roots.  Thus, there is an automorphism
   $\sg\in G(K/\Q(i))$ with $\sg(\al)=i\al$.  Alternatively, we can be
   more concrete as follows.  Every element $a\in K$ can be written in
   a  unique way as $a=a_0+a_1\al+a_2\al^2+a_3\al^3$ with
   $a_0,\dotsc,a_3\in\Q(i)$.  We can thus define a $\Q(i)$-linear map
   $\sg\:K\to K$ by 
   \[ \sg(a_0+a_1\al+a_2\al^2+a_3\al^3) = 
        a_0+ia_1\al+i^2a_2\al^2+i^3a_3\al^3.
   \]
   It is clear that $\sg$ respects addition and sends $0$ to $0$ and
   $1$ to $1$.  Just by expanding everything out, one can also check
   that $\sg(ab)=\sg(a)\sg(b)$, so $\sg$ is a homomorphism.  We now
   find that $1,\sg,\sg^2$ and $\sg^3$ are all different, but that
   $\sg^4=1$.  Thus $\sg$ generates a subgroup of $G(K/\Q(i))$
   isomorphic to $C_4$.  As $|G(K/\Q(i))|=[K:\Q(i)]=4$, this must be
   the whole group.
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-which-normal-cyclic}
 Which of the following extensions are normal? When they are normal,
 say whether the Galois groups are cyclic or not.
 \begin{itemize}
  \item[(a)] $K=\Q$, $L=K(e^{{2\pi i}/{5}})$
  \item[(b)] $K=\Q(e^{{2\pi i}/{5}})$, $L=\Q(e^{{2\pi i}/{25}})$
  \item[(c)] $K=\Q$, $L=K(\sqrt[5]{12})$
  \item[(d)] $K=\Q(e^{{2\pi i}/{5}})$, $L=K(\sqrt[5]{3})$
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] Here $L=\Q(\mu_5)$, so we know from the general
   cyclotomic theory that $L$ is Galois over $\Q$, and the Galois
   group is $(\Z/5\Z)^\tm=\{\ov{-2},\ov{-1},\ov{1},\ov{2}\}$.  As
   $\Z/5\Z$ is a field we know that $(\Z/5\Z)^\tm$ is cyclic.
   Explicitly, we have $\ov{2}^2=\ov{4}=\ov{-1}$, and it follows
   easily from this that the group is generated by $\ov{2}$.

  \item[(b)] Here $K$ and $L$ are both normal over $\Q$, and
   $G(L/\Q)=(\Z/25\Z)^{\tm}$ whereas $G(K/\Q)=(\Z/5\Z)^\tm$.  More
   explicitly, we can put $\zt=e^{2\pi i/25}$, and for each
   $k\in(\Z/25\Z)^\tm$ there is a unique automorphism $\sg_k$ of $L$
   with $\sg_k(\zt)=\zt^k$.  Note that $K=\Q(\zt^5)$, so $\sg_k$ acts
   as the identity on $K$ if and only if $\zt^{5k}=\zt^5$, or
   equivalently $5k=5\pmod{25}$, or equivalently $k=1\pmod{5}$.  This
   means that 
   \[ G(L/K) = \{\sg_1,\sg_6,\sg_{11},\sg_{16},\sg_{21}\} = 
       \{\sg_{1+5i}\st 0\leq i<5\}.
   \]
   Note that $\sg_i$ only depends on $i$ modulo $25$, so 
   \[ \sg_{1+5i}\sg_{1+5j} = \sg_{1+5i+5j+25ij} = \sg_{1+5(i+j)}. \]
   It follows from this that $G(L/K)$ is cyclic of order $5$,
   generated by $\sg_6$.

  \item[(c)] Here the polynomial $f(x)=x^5-12$ is irreducible over
   $\Q$ (by Eisenstein's criterion at the prime $3$) and has a root in
   $L$.  However, we have $L\sse\R$ and $f(x)$ has only one real root
   so $f(x)$ does not split in $L[x]$.  It follows that $L$ is not
   normal over $K$.

  \item[(c)] This is normal, with Galois group $C_5$.  Here is a
   rigorous argument (in practice, you wouldn't necessarily write down
   all these steps):

   Firstly, observe that $[L:\Q]=20$. For we have
   \[ [L:\Q]=[L:K][K:\Q] \]
   and
   \[ [L:\Q]=[L:\Q(\sqrt[5]{3})][\Q(\sqrt[5]{3}):\Q]. \]
   As $[K:\Q]=4$ (by (a)) and $[\Q(\sqrt[5]{3}):\Q]=5$ (the minimal
   polynomial is $x^5-3$, irreducible by Eisenstein with $p=3$), we
   see that $[L:\Q]$ is a multiple of 4 and of 5, so is divisible by
   20. Conversely, $[L:K]=[K(\sqrt[5]{3}):K]\leq 5$, as it is the degree
   of the minimal polynomial of $\sqrt[5]{3}$ over $K$, and this must
   divide $x^5-3$, so be of degree at most 5. As $[L:\Q]=[L:K][K:\Q]$,
   we see $[L:\Q]\leq 20$. Combining these, we get that $[L:\Q]=20$ and
   thus that $[L:K]=5$.

   So $x^5-3$ is the minimal polynomial of $\sqrt[5]{3}$ over
   $K$. Write $\al=\sqrt[5]{3}$ and $\zt=e^{{2\pi i}/{5}}$. The roots
   of the minimal polynomial are $\al$, $\al\zt$, $\al\zt^2$,
   $\al\zt^3$ and $\al\zt^4$. All these roots lie in $K(\al)$, so it
   follows that $|G(K(\al)/K)|=5$, and the extension is Galois.

   As every group with 5 elements is cyclic, this implies that the
   Galois group is $C_5$. Explicitly, however, the 5 automorphisms are
   determined by the their effects on $\al$; $\al$ must be sent to one
   of $\al$, $\al\zt$, $\al\zt^2$, $\al\zt^3$ or $\al\zt^4$. It is
   easy to see that the automorphism sending $\al$ to $\al\zt$
   generates all of the automorphisms (as do any of the non-trivial
   automorphisms).
 \end{itemize}
\end{solution}

\section{Some extensions of small degree}
\label{sec-small}

\begin{proposition}\lbl{prop-quadratic}
 Let $K$ be a field of characteristic not equal to two, and let $L$ be
 an extension of $K$ of degree two.
 \begin{itemize}
  \item[(a)] There is an element $\al\in L\sm K$ such that $L=K(\al)$
   and $\al^2\in K$.
  \item[(b)] The element $\al$ has the following uniqueness property:
   if $L=K(\bt)$ for some other element $\bt\in L\sm K$ with
   $\bt^2\in K$, then $\bt=q\al$ for some $q\in K$.
  \item[(c)] There is an automorphism $\sg\:L\to L$ that acts as the
   identity on $K$ and satisfies $\sg(\al)=-\al$.
  \item[(d)] We have $\sg^2=1$ and $G(L/K)=\{1,\sg\}\simeq C_2$.
 \end{itemize}
\end{proposition}
\begin{proof}
 First choose any element $\lm\in L\sm K$.  We claim that $1$ and
 $\lm$ are linearly independent over $K$.  To see this, consider a
 linear relation $a.1+b\lm=0$ with $a,b\in K$.  If $b\neq 0$ we can
 rearrange to get $\lm=-ab^{-1}\in K$, contrary to assumption.  We
 therefore have $b=0$ so the original relation reduces to $a=0$ as
 required.  As $\dim_K(L)=2$ this means that $1,\lm$ is a basis for
 $L$ over $K$.  We can therefore write $-\lm^2$ in terms of this
 basis, say as $-\lm^2=b\lm+c$, or equivalently $\lm^2+b\lm+c=0$.
 Next, as $K$ does not have characteristic two we know that $2$ is
 invertible in $K$ so we can put $\al=\lm-b/2\in L$ and
 $a=b^2/4-c\in K$.  We find that
 $\al^2=\lm^2-b\lm+b^2/4=b^2/4-c=a$.  By the same logic as for
 $\lm$ we also see that $1,\al$ is a basis for $L$ and so $L=K(\al)$,
 proving~(a). 

 Now suppose we have another element $\bt\in L\sm K$ with
 $\bt^2\in K$.  We can write $\bt=p+q\al$ for some $p,q\in K$.  As
 $\bt\not\in K$ we have $q\neq 0$.  This gives
 $\bt^2=(p^2+q^2a)+2pq\al$, which is assumed to lie in $K$, so we must
 have $2pq=0$.  As $q\neq 0$ and $2$ is invertible this gives $p=0$
 and thus $\bt=q\al$, proving~(b).

 Next, as $1,\al$ is a basis, we can certainly define a $K$-linear map
 $\sg\:L\to L$ by $\sg(x+y\al)=x-y\al$.  This clearly satisfies
 $\sg(\sg(x+y\al))=\sg(x-y\al)=x+y\al$, so $\sg^2=1$.  It also has
 $\sg(0)=0$ and $\sg(1)=1$.  Now consider elements $\mu=u+v\al$ and
 $\nu=x+y\al$ in $L$.  We have 
 \begin{align*}
  \mu\nu &= (ux+vya)+(vx+uy)\al \\
  \sg(\mu\nu) &= (ux+vya)-(vx+uy)\al \\
  \sg(\mu)\sg(\nu) &= (u-v\al)(x-y\al) = (ux+vya)-(vx+uy)\al 
    = \sg(\mu\nu). 
 \end{align*}
 It follows that $\sg$ is an automorphism.  Now let $\tau$ be any
 other automorphism of $L$ with $\tau|_K=1$.  We can apply $\tau$ to
 the equation $\al^2-a=0$ to get $\tau(\al)^2-a=0$, or in other words
 $\tau(\al)^2-\al^2=0$, or in other words
 $(\tau(\al)-\al)(\tau(\al)+\al)=0$, so either $\tau(\al)=\al$ or
 $\tau(\al)=-\al$.  In the first case we have $\tau=1$, and in the
 second case we have $\tau=\sg$.  It follows that $G(L/K)=\{1,\sg\}$
 as claimed.
\end{proof}

\begin{proposition}\lbl{prop-biquadratic}
 Let $p$ and $q$ be distinct prime numbers, put
 $B=\{1,\sqrt{p},\sqrt{q},\sqrt{pq}\}\subset\R$, and let $K$ be the
 span of $B$ over $\Q$.
 \begin{itemize}
  \item[(a)] The set $B$ is linearly independent over $\Q$, so it
   gives a basis for $K$, and $[K:\Q]=4$.
  \item[(b)] $K$ is a splitting field for the polynomial
   $(x^2-p)(x^2-q)\in\Q[x]$.  
  \item[(c)] There are automorphisms $\sg$ and $\tau$ of $K$ given by 
   \begin{align*}
    \sg(w+x\sqrt{p}+y\sqrt{q}+z\sqrt{pq}) 
     &= w-x\sqrt{p}+y\sqrt{q}-z\sqrt{pq} \\
    \tau(w+x\sqrt{p}+y\sqrt{q}+z\sqrt{pq}) 
     &= w+x\sqrt{p}-y\sqrt{q}-z\sqrt{pq}.
   \end{align*}
  \item[(d)] We have $\sg^2=\tau^2=1$ and $\sg\tau=\tau\sg$, and
   $G(K/\Q)=\{1,\sg,\tau,\sg\tau\}\simeq C_2\tm C_2$.
 \end{itemize}
\end{proposition}
\begin{proof}
 For part~(a), consider a nontrivial linear relation
 $w+x\sqrt{p}+y\sqrt{q}+z\sqrt{pq}=0$.  Here $w,x,y,z\in\Q$, but after
 multiplying through by a suitable integer we can clear the
 denominators and so assume that $w,x,y,z\in\Z$.  We can then divide
 through by any common factor and thus assume that $\gcd(w,x,y,z)=1$.
 Now rearrange the relation as $w+x\sqrt{p}=-(y+z\sqrt{p})\sqrt{q}$ and
 square both sides to get 
 \[ (w^2+px^2)+2wx\sqrt{p} = (y^2+pz^2)q + 2yzq\sqrt{p}. \]
 We know that $1$ and $\sqrt{p}$ are linearly independent over $\Q$,
 so we conclude that 
 \begin{align*}
  wx &= yzq \\
  w^2+px^2 &= (y^2+pz^2)q.
 \end{align*}
 From the first of these we see that either $w$ or $x$ is divisible by
 $q$.  In either case we can feed this fact into the second equation
 to see that $w^2$ and $x^2$ are both divisible by $q$, so $w$ and $x$
 are both divisible by $q$, say $w=q\ov{w}$ and $x=q\ov{x}$.  We can
 substitute these in the previous equations and cancel common factors
 to get
 \begin{align*}
  yz &= \ov{w}\ov{x}q \\
  y^2+pz^2 &= (\ov{w}^2+p\ov{x}^2)q.
 \end{align*}
 The same logic now tells us that $y$ and $z$ are both divisible by
 $q$, contradicting the assumption that $\gcd(w,x,y,z)=1$.  It follows
 that there can be no such linear relation, which proves~(a).

 For~(b), the main point to check is that $K$ is actually a subfield
 of $\R$.  To see this, write $e_0=1$, $e_1=\sqrt{p}$, $e_2=\sqrt{q}$
 and $e_3=\sqrt{pq}$.  By a straightforward check of the 16 possible
 cases, we see that $e_ie_j$ is always a rational multiple of $e_k$
 for some $k$ (for example $e_1e_3=pe_2$).  In particular, we have
 $e_ie_j\in K$.  Now suppose we have two elements $x,y\in K$, say
 $x=\sum_{i=0}^3x_ie_i$ and $y=\sum_{j=0}^3y_je_j$.  Then
 $xy=\sum_{i,j}x_iy_je_ie_j$ with $x_iy_j\in\Q$ and $e_ie_j\in K$, and
 $K$ is a vector space over $\Q$, so $xy\in K$.  We therefore see that
 $K$ is a subring of $\R$.  As $K$ is finite-dimensional we can use
 Proposition~\ref{prop-subring-subfield} to see that $K$ is a subfield
 of $\R$.  It is clearly generated by the roots of the polynomial
 \[ f(x) = (x^2-p)(x^2-q) =
     (x-\sqrt{p})(x+\sqrt{p})(x-\sqrt{q})(x+\sqrt{q}),
 \]
 so it is a splitting field for $f(x)$.

 Next, we can regard $K$ as a degree two extension of $\Q(\sqrt{q})$
 obtained by adjoining a square root of $p$.
 Proposition~\ref{prop-quadratic} therefore gives us an automorphism
 $\sg$ of $K$ that acts as the identity on $\Q(\sqrt{q})$, and this is
 clearly described by the formula stated above.  Similarly, we obtain
 the automorphism $\tau$ by regarding $K$ as $\Q(\sqrt{p})(\sqrt{q})$
 rather than $\Q(\sqrt{q})(\sqrt{p})$.  This proves~(c).

 Now let $\tht$ be an arbitrary automorphism of $K$ (which
 automatically acts as the identity on $\Q$).  We must then have
 $\tht(\sqrt{p})^2=\tht(\sqrt{p}^2)=\tht(p)=p$, so
 $\tht(\sqrt{p})=\pm\sqrt{p}$.  Similarly we have 
 $\tht(\sqrt{q})=\pm\sqrt{q}$, and it follows by inspection that there
 is a unique automorphism $\phi\in\{1,\sg,\tau,\sg\tau\}$ that has the
 same effect on $\sqrt{p}$ and $\sqrt{q}$ as $\tht$.  This means that
 the automorphism $\psi=\phi^{-1}\tht$ has $\psi(\sqrt{p})=\sqrt{p}$
 and $\psi(\sqrt{q})=\sqrt{q}$, and therefore also
 $\psi(\sqrt{pq})=\psi(\sqrt{p})\psi(\sqrt{q})=\sqrt{pq}$.  As $B$ is
 a basis for $K$ over $\Q$ and $\psi$ acts as the identity on $B$, we
 see that $\psi=1$, and so $\tht=\phi$.  This proves~(d).
\end{proof}

We next consider two different cubic equations for which the answers
work out quite neatly.  In Section~\ref{sec-cubics} we will see that
general cubics are conceptually not too different, although the
formulae are typically less tidy.

\begin{example}\lbl{eg-nice-cubic}
 We will construct and study a splitting field for the polynomial
 $f(x)=x^3-3x-3\in\Q[x]$.  This is an Eisentstein polynomial for the
 prime $3$, so it is irreducible over $\Q$.  We start by noting that
 $(3+\sqrt{5})/2$ is a positive real number, with inverse
 $(3-\sqrt{5})/2$.  We let $\bt$ denote the real cube root of
 $(3+\sqrt{5})/2$, so that $\bt^{-1}$ is the real cube root of
 $(3-\sqrt{5})/2$.  Then put $\om=(\sqrt{-3}-1)/2\in\C$, so $\om^3=1$
 and $\om^2+\om+1=0$.  Finally, put $\al_i=\om^i\bt+1/(\om^i\bt)$ for
 $i=0,1,2$.  We claim that these are roots of $f(x)$.  Indeed, we have
 \begin{align*}
  \al_i^3 &= (\om^i\bt)^3 + 3(\om^i\bt)^2/(\om^i\bt) +
              3\om^i\bt/(\om^i\bt)^2 + 1/(\om^i\bt)^3 \\
   &= \bt^3 + \bt^{-3} + 3(\om^i\bt+\om^{-i}\bt^{-1}) \\
   &= (3+\sqrt{5})/2 + (3-\sqrt{5})/2 + 3\al_i = 3+3\al_i,
 \end{align*}
 which rearranges to give $f(\al_i)=0$ as claimed.  We also note that
 $\al_0$ is real, whereas $\al_1$ and $\al_2$ are non-real and are
 complex conjugates of each other.  It follows that we have three
 distinct roots of $f(x)$, and thus that
 $f(x)=(x-\al_0)(x-\al_1)(x-\al_2)$, so the splitting field is
 generated by $\al_0$, $\al_1$ and $\al_2$.  We write $K$ for this
 splitting field.

 Next, note that $\ov{\om}$ (the complex conjugate of $\om$) is
 $\om^{-1}$, and so $\ov{\al_1}=\al_2$ and $\ov{\al_2}=\al_1$, whereas
 $\ov{\al_0}=\al_0$ because $\al_0$ is real.  This means that
 conjugation permutes the roots $\al_i$ and so preserves $K$.  We thus
 have an automorphism $\sg\:K\to K$ given by $\sg(a)=\ov{a}$ for all
 $a\in K$.  

 We also claim that there is an automorphism $\rho$ of $K$ with
 $\rho(\al_0)=\al_1$ and $\rho(\al_1)=\al_2$ and $\rho(\al_2)=\al_0$.
 Indeed, part~(c) of Proposition~\ref{prop-root-perms} tells us that
 there is an automorphism $\lm$ such that $\lm(\al_0)=\al_1$.  We
 know that $\lm$ permutes the set $R=\{\al_0,\al_1,\al_2\}$ of roots of
 $f(x)$, so it must either be the three-cycle $(\al_0\;\al_1\;\al_2)$
 or the transposition $(\al_0\;\al_1)$.  In the first case, we can
 just take $\rho=\lm$; in the second, we can take $\rho=\lm\sg$.  It
 is now easy to check that the set
 $\{1,\rho,\rho^2,\sg,\rho\sg,\rho^2\sg\}$ gives all six permutations
 of $R$.  It follows by Proposition~\ref{prop-root-perms} that the
 Galois group $G(L/K)$ is the full group $\Sg_R\simeq\Sg_3$.
\end{example}

\begin{example}\lbl{eg-special-cubic}
 Consider the polynomial $f(x)=x^3+x^2-2x-1$.  We first claim that
 this is irreducible over $\Q$.  Indeed, if it were reducible we would
 have $f(x)=g(x)h(x)$ for some monic polynomials $g(x),h(x)\in\Q[x]$
 with $\deg(g(x))=1$ and $\deg(h(x))=2$.  Proposition~\ref{prop-gauss}
 would then tell us that $g(x),h(x)\in\Z[x]$.  This would mean that
 $g(x)=x-a$ for some $a\in\Z$, and thus $f(a)=0$.  However, we have
 $f(2m)=2(4m^3+2m^2-m)-1$ and $f(2m+1)=2(4m^3+8m^2+3m)-1$ so $f(a)$ is
 odd for all $a\in\Z$, which is a contradiction.  

 Now put 
 \begin{align*}
  \zt &= \exp(2\pi i/7) = \cos(2\pi/7) + i\sin(2\pi/7) \\
  \al &= \zt   + \zt^{-1} = 2\cos(2\pi/7) \\
  \bt &= \zt^2 + \zt^{-2} = 2\cos(4\pi/7) \\
  \gm &= \zt^4 + \zt^{-4} = 2\cos(8\pi/7).
 \end{align*}
 We claim that $\al$, $\bt$ and $\gm$ are roots of $f(x)$.  To see
 this, we start with the observation that $\zt^7=1$, so
 $\zt^4=\zt^{-3}$, so  
 \[ (\zt-1)(\zt^{-3}+\zt^{-2}+\zt^{-1}+1+\zt+\zt^2+\zt^3) = \zt^4-\zt^{-3}=0, \]
 but $\zt-1\neq 0$, so 
 \[ \zt^{-3}+\zt^{-2}+\zt^{-1}+1+\zt+\zt^2+\zt^3 = 0. \]
 On the other hand, 
 \begin{align*}
  \al^3 &= \zt^{-3} + 3\zt^{-1} + 3\zt + \zt^3 \\
  \al^2 &= \zt^{-2} + 2 + \zt^2 \\
  -2\al &= -2\zt^{-1}-2\zt \\
  -1    &= -1.
 \end{align*}
 If we add together the left hand sides we get $f(\al)$, and if we add
 together the right hand sides we get $\sum_{i=-3}^3\zt^i=0$, so
 $f(\al)=0$.  By essentially the same calculation we also have 
 \[ f(\bt)=\sum_{i=-3}^3\zt^{2i} = 
     \zt^{-6}+\zt^{-4}+\zt^{-2}+1+\zt^2+\zt^4+\zt^6.
 \]
 We can rewrite the right hand side using $\zt^6=\zt^{-1}$ and
 $\zt^4=\zt^{-3}$ (so $\zt^{-6}=\zt$ and $\zt^{-4}=\zt^3$).  After
 reordering the terms we just get $\sum_{i=-3}^3\zt^i$ again, which is
 zero.  This shows that $f(\bt)=0$, and similarly $f(\gm)=0$.  This
 gives three distinct roots for the cubic polynomial $f(x)$, so we
 have 
 \[ f(x) = (x-\al)(x-\bt)(x-\gm). \]
 Next, we observe that 
 \begin{align*}
  \al^2-2 &= (\zt^{-2}+2+\zt^2)-2 = \zt^{-2}+\zt^2 = \bt \\
  \bt^2-2 &= (\zt^{-4}+2+\zt^4)-2 = \zt^{-4}+\zt^4 = \gm \\
  \gm^2-2 &= (\zt^{-8}+2+\zt^8)-2 = \zt^{-8}+\zt^8 = \zt^{-1}+\zt = \al.
 \end{align*}
 The first of these shows that $\bt\in Q(\al)$, and so
 $\Q(\bt)\sse\Q(\al)$.  We can also use the other equations to see
 that $\Q(\al)\sse\Q(\gm)\sse\Q(\bt)\sse\Q(\al)$, so 
 \[ \Q(\al) = \Q(\bt) = \Q(\gm) = \Q(\al,\bt,\gm). \]
 It follows that $\Q(\al)$ is a splitting field for $f(x)$.

 Next, Proposition~\ref{prop-root-perms} tells us that there is an
 automorphism $\sg$ of $\Q(\al)$ with $\sg(\al)=\bt$.  Now $\sg$ is a
 homomorphism and $\bt=\al^2-2$ so 
 \[ \sg(\bt)=\sg(\al^2-2)=\sg(\al)^2-2=\bt^2-2=\gm. \]
 By a similar argument we have $\sg(\gm)=\gm^2-2=\al$, so $\sg$
 corresponds to the three-cycle $(\al\;\bt\;\gm)$.  We also know that
 $|G(\Q(\al)/\Q)|=[\Q(\al):\Q]=3$, and it follows that
 $G(\Q(\al)/\Q)=\{1,\sg,\sg^2\}\simeq C_3$.
\end{example}

\begin{example}\lbl{eg-cyclic-quartic}
 Consider the polynomial $f(x)=x^4-10x^2+20$, which is irreducible
 over $\Q$ by Eisenstein's criterion at the prime $5$.  This is a
 quadratic function of $x^2$, so by the usual formula it vanishes when
 $x^2=(10\pm\sqrt{100-4\tm 20})/2=5\pm\sqrt{5}$ (and both of these
 values are positive real numbers).  The roots of $f(x)$ are therefore
 $\al$, $\bt$, $-\al$ and $-\bt$ where $\al=\sqrt{5+\sqrt{5}}$ and
 $\bt=\sqrt{5-\sqrt{5}}$.  It is a special feature of this example
 that $\bt$ can be expressed in terms of $\al$.  To see this, note
 that $\al^2=5+\sqrt{5}$ and so $\al^4=30+10\sqrt{5}$.  Then put
 $\bt'=\half\al^3-3\al$ and note that
 \begin{align*}
   \al\bt' &= \half\al^4-3\al^2 = 
     15+5\sqrt{5}-15-3\sqrt{5} = 2\sqrt{5}  \\
   \al\bt &= \sqrt{(5+\sqrt{5})(5-\sqrt{5})} = 
     \sqrt{5^2 - \sqrt{5}^2} = \sqrt{25-5} = 2\sqrt{5}.
 \end{align*}
 This shows that $\al\bt'=\al\bt$, so
 $\bt=\bt'=\half\al^3-\al\in\Q(\al)$.  This shows that all roots of
 $f(x)$ lie in $\Q(\al)$, so $\Q(\al)$ is a splitting field for $f(x)$
 over $\Q$.   By Proposition~\ref{prop-root-perms} there is an
 automorphism $\sg$ of $\Q(\al)$ with $\sg(\al)=\bt$.  It follows that 
 \[ \sg(\sqrt{5})=\sg(\al^2-5)=\sg(\al)^2-5=\bt^2-5=-\sqrt{5}. \]
 We now apply $\sg$ to the equation $\al\bt=2\sqrt{5}$ to get
 $\bt\sg(\bt)=-2\sqrt{5}$.  We can then divide this by the original
 equation $\al\bt=2\sqrt{5}$ to get $\sg(\bt)/\al=-1$, so
 $\sg(\bt)=-\al$.  Moreover, as $\sg$ is a homomorphism we have
 $\sg(-a)=-\sg(a)$ for all $a$, so $\sg(-\al)=-\bt$ and
 $\sg(-\bt)=\al$.  This shows that $\sg$ corresponds to the four-cycle
 $(\al\;\bt\;-\al\;-\bt)$.  It follows that the automorphisms
 $\{1,\sg,\sg^2,\sg^3\}$ are all different, but
 $|G(\Q(\al)/\Q)|=[\Q(\al):\Q]=4$, so we have 
 \[ G(\Q(\al)/\Q)=\{1,\sg,\sg^2,\sg^3\}\simeq C_4. \]
\end{example}

\begin{example}\lbl{eg-even-quartic}
 Consider the polynomial
 $f(x)=x^4-6x^2+2=(x^2-3-\sqrt{7})(x^2-3+\sqrt{7})$, which is 
 irreducible over $\Q$, by Eisenstein's criterion at the prime $2$.
 The roots are $\al$, $-\al$, $\bt$ and $-\bt$, where
 $\al=\sqrt{3+\sqrt{7}}$ and $\bt=\sqrt{3-\sqrt{7}}$.  Let $K$ be the
 splitting field, which is generated by $\al$ and $\bt$.  Note that
 this contains the elements $\sqrt{7}=\al^2-3$ and $\sqrt{2}=\al\bt$.
 We can draw the set $R$ of roots in a square as follows:
 \[ \xymatrix{ 
   \al & \bt \\
   -\bt & -\al 
 } \]
 We claim that $G(L/\Q)$ can be identified with the group $D_8$ of
 rotations and reflections of this square.  Indeed, we can define a
 permutation $\mu=(\al\;-\al)(\bt\;-\bt)\in\Sg_R$, and we put
 $H=\{\sg\in\Sg_R\st\sg\mu\sg^{-1}=\mu\}$.  One can see that $H$ is a
 proper subgroup of $\Sg_R$ containing $D_8$, so $|H|$ is divisible by
 $|D_8|=8$ and strictly less than $|\Sg_R|=24$, so $|H|=8$ and
 $H=D_8$.  Next, if $\sg\in G(K/\Q)$ then $\sg$ satisfies
 $\sg(-a)=-\sg(a)$ for all $a\in K$, so we have $\sg\mu=\mu\sg$, so
 $\sg\in H=D_8$.  It follows that $G(K/\Q)$ is a subgroup of $D_8$ of
 order equal to $[K:\Q]$, so it will suffice to check that
 $[K:\Q]=8$.  As $f(x)$ is irreducible we certainly have
 $[\Q(\bt):\Q]=[\Q(\al):\Q]=\deg(f(x))=4$ and $K=\Q(\al)(\bt)$ with
 $\bt^2=3-\sqrt{7}\in\Q(\sqrt{7})\sse\Q(\al)$, so $[K:\Q(\al)]$ is
 either $1$ (if $\bt\in\Q(\al)$) or $2$ (if $\bt\not\in\Q(\al)$).  It
 would be an odd coincidence if $\bt$ were already in $\Q(\al)$ and
 the reader may wish to take it on trust that this is not the case.
 However, for completeness we will give a proof below.  Assuming this,
 we have $[K:\Q]=[K\:\Q(\al)][\Q(\al):\Q]=8$ as required. 

 For the proof that $\bt\not\in\Q(\al)$, we first observe that
 $[\Q(\bt):\Q]=4>2=[\Q(\sqrt{7}):\Q]$, so $\bt\not\in\Q(\sqrt{7})$.
 Similarly, we have $\al\not\in\Q(\sqrt{7})$.  We also claim that
 $\bt/\al\not\in\Q(\sqrt{7})$.  Indeed, if it were we could multiply by
 $\al^2=3+\sqrt{7}\in\Q(\sqrt{7})$ to see that
 $\sqrt{2}=\al\bt\in\Q(\sqrt{7})$, which would contradict the case
 $(p,q)=(2,7)$ of Proposition~\ref{prop-biquadratic}.  Now suppose
 (for a contradiction) that $\bt\in\Q(\al)$.  We can then write
 $\bt=u+v\al$ for some $u,v\in\Q(\sqrt{7})$.  As
 $\bt\not\in\Q(\sqrt{7})$ we must have $v\neq 0$, and as
 $\bt/\al\not\in\Q(\sqrt{7})$ we must have $u\neq 0$.  We can now
 square the relation $\bt=u+v\al$ and rearrange to get
 $\al=(\bt^2-u^2-v^2\al^2)/(2uv)$.  As
 $u,v,\al^2,\bt^2\in\Q(\sqrt{7})$ this gives $\al\in\Q(\sqrt{7})$,
 which is the required contradiction. 
\end{example}

For a randomly chosen polynomial of degree $d$, it will usually work
out that the Galois group of the splitting field is the whole
permutation group $\Sg_d$.  However, in any given case, it may not be
so easy to verify this.  We will now consider some examples where it
is not too hard to verify this.

\begin{lemma}\lbl{lem-all-perms}
 Let $p$ be a prime, and let $G$ be a subgroup of $\Sg_p$.  Suppose
 that 
 \begin{itemize}
  \item[(a)] $G$ contains at least one transposition.
  \item[(b)] For all $i,j\in\{1,\dotsc,n\}$ there exists $\sg\in G$
   with $\sg(i)=j$.  (In other words, $G$ is transitive.)
 \end{itemize}
 Then $G$ is all of $\Sg_p$.
\end{lemma}
\begin{proof}
 Put $P=\{1,\dotsc,p\}$, and introduce a relation on $P$ by $i\sim j$
 if $i=j$ or $(i\; j)\in G$.  It is clear that $i\sim i$, and that
 $i\sim j$ if and only if $j\sim i$.  In other words, the relation is
 reflexive and symmetric.  We claim that it is also transitive.  To
 see this, suppose that $i\sim j$ and $j\sim k$.  If either $i=j$ or
 $j=k$ it is immediate that $i\sim k$.  Otherwise, we must have
 $(i\;j)\in G$ and $(j\; k)\in G$.  As $G$ is a subgroup it follows
 that $(j\;k)(i\;j)(j\;k)\in G$, but that composite is equal to
 $(i\;k)$, so we see that $i\sim k$ as required.  This means that
 $\sim$ is an equivalence relation, so we can divide $P$ into
 equivalence classes.  Next, we claim that if $\sg\in G$ and $i\sim j$
 then $\sg(i)\sim\sg(j)$.  Indeed, this is clear if $i=j$.  Moreover,
 if $i\neq j$ we must have $(i\;j)\in G$, and it follows that
 $(\sg(i)\;\sg(j))=\sg(i\;j)\sg^{-1}\in G$, so $\sg(i)\sim\sg(j)$ as
 claimed.  We can also apply the same argument using $\sg^{-1}$ to
 deduce that converse implication, that if $\sg(i)\sim\sg(j)$ then
 $i\sim j$.  Using this we see that the equivalence class of $i$ has
 the same size as the equivalence class of $\sg(i)$.  By transitivity,
 for any $j\in P$ we can choose $\sg\in G$ with $\sg(i)=j$, and using
 this we see \emph{all} the equivalence classes have the same size,
 say $m$.  If there are $n$ equivalence classes this means that
 $mn=p$.  As $G$ contains a transposition we see that there is at
 least one equivalence class of size larger than one, so $m>1$.  As
 $p$ is prime we must thus have $m=p$ and $n=1$.  This means that the
 whole of $P$ is a single equivalence class, so for all $i\neq j$ in
 $P$ we have $(i\;j)\in G$.  On the other hand, it is well known that
 every permutation can be written as a product of transpositions, so
 $G$ is all of $\Sg_p$ as claimed.
\end{proof}

\begin{corollary}\lbl{cor-all-perms}
 Let $p$ be a prime, and let $f(x)$ be an irreducible polynomial in
 $\Q[x]$ that has precisely $p-2$ real roots.  Then the Galois group
 of the splitting field is all of $\Sg_p$.
\end{corollary}
\begin{proof}
 As $f(x)$ is irreducible it has no repeated roots, so there are
 precisely $p$ distinct roots altogether.  We can number them as
 $\al_1,\dotsc,\al_p$ with $\al_1$ and $\al_2$ being non-real and
 $\al_3,\dotsc,\al_p$ being real.  We can take the complex conjugate
 of the equation $f(\al_1)=0$ to see that $f(\ov{\al_1})=0$, so
 $\ov{\al_1}$ is a non-real root different from $\al_1$, so it must be
 $\al_2$.  It follows from this that complex conjugation gives an
 automorphism of the splitting field $K=\Q(\al_1,\dotsc,\al_p)$, which
 exchanges $\al_1$ and $\al_2$, and fixes $\al_k$ for $k>2$.  This
 means that the Galois group $G$ contains the transposition $(1\;2)$,
 and it is transitive by Proposition~\ref{prop-root-perms}(c).  The
 claim now follows from Lemma~\ref{lem-all-perms}.
\end{proof}

\begin{example}\lbl{eg-generic-quintic}
 Consider the quintic $f(x)=x^5-6x+3$, which is irreducible by
 Eisenstein's criterion at the prime three.  Using Maple or a graphing
 calculator we see that there are precisely three real roots, at
 approximately $x\simeq -1.67$, $x\simeq 0.51$ and $x\simeq 1.40$.
 For a more rigorous argument, we note that $f(-2)=-17<0$ and
 $f(0)=3>0$ and $f(1)=-2<0$ and $f(2)=23>0$, so the Intermediate Value
 Theorem tells us that there is at least one root between $-2$ and
 $0$, and another between $0$ and $1$, and another between $1$ and
 $2$.  Moreover, Rolle's theorem tells us that between any two roots
 of $f(x)$ there is at least one root of $f'(x)=5x^4-6$, but $f'(x)$
 has only two real roots (namely $x=\pm(6/5)^{1/4}\simeq\pm 1.0466$),
 so $f(x)$ can only have three real roots.  This verifies the
 hypotheses of Corollary~\ref{cor-all-perms}, so we see that the
 Galois group of the splitting field of $f(x)$ is all of $\Sg_5$.
\end{example}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-two-roots-basis}
 Give a basis for $\Q(\sqrt{2},\sqrt{3})$ over $\Q$.  Express the
 element $1/(2+\sqrt{2}+\sqrt{3})$ as a linear combination of your
 basis elements.
\end{exercise}
\begin{solution}
 The obvious basis is the set $B=\{1,\sqrt{2},\sqrt{3},\sqrt{6}\}$.
 Note that
 \[ \frac{1}{2+\sqrt{2}+\sqrt{3}} = 
    \frac{2+\sqrt{2}-\sqrt{3}}{(2+\sqrt{2}-\sqrt{3})(2+\sqrt{2}+\sqrt{3})} = 
    \frac{2+\sqrt{2}-\sqrt{3}}{(2+\sqrt{2})^2-(\sqrt{3})^2} = 
    \frac{2+\sqrt{2}-\sqrt{3}}{3+4\sqrt{2}}.
 \]
 Here 
 \[ \frac{1}{3+4\sqrt{2}} = 
    \frac{3-4\sqrt{2}}{(3+4\sqrt{2})(3-4\sqrt{2})} = 
    \frac{3-4\sqrt{2}}{3^2-(4\sqrt{2})^2} = 
    \frac{4\sqrt{2}-3}{23}.
 \]
 Putting this together, we get 
 \[ \frac{1}{2+\sqrt{2}+\sqrt{3}} = 
    (2+\sqrt{2}-\sqrt{3})(4\sqrt{2}-3)/23 = 
    \tfrac{2}{23} + \tfrac{5}{23}\sqrt{2} +
     \tfrac{3}{23}\sqrt{3} - \tfrac{4}{23}\sqrt{6}.
 \]
\end{solution}
\begin{exercise}\exlabel{ex-three-five}
 Show directly that $\Q(\sqrt{3},\sqrt{5})=\Q(\sqrt{3}+\sqrt{5})$.
\end{exercise}
\begin{solution}
 Clearly $\Q(\sqrt{3}+\sqrt{5})\subseteq\Q(\sqrt{3},\sqrt{5})$.  But
 if $\al=\sqrt{3}+\sqrt{5}$, then $\al^3=18\sqrt{3}+14\sqrt{5}$,
 so
 \begin{align*}
  \sqrt{3} &= \frac{\al^3-14\al}{4} \\
  \sqrt{5} &= \frac{18\al - \al^3}{4}.
 \end{align*}
 This gives the other inclusion.
\end{solution}

\begin{exercise}\exlabel{ex-biquadratic}
 Let $p$ and $q$ be primes with $p<q$.  You may assume (as shown in
 the notes) that the list $1,\sqrt{p},\sqrt{q},\sqrt{pq}$ is linearly
 independent over $\Q$.  Put 
 \begin{align*}
  f(x) &= x^4 - 2(p+q)x^2 + (p-q)^2 \\
  g(x) &= x^4 - (p+q)x^2 + pq.
 \end{align*}
 Show that $f(x)$ is the minimal polynomial of $\sqrt{p}+\sqrt{q}$
 over $\Q$ (so in particular it is irreducible).  Find all the roots
 of $f(x)$.  Show that $g(x)$ is reducible, and has the same splitting
 field as $f(x)$.
\end{exercise}
\begin{solution}
 Put $\al=\sqrt{p}+\sqrt{q}\in\Q(\sqrt{p},\sqrt{q})$.  Then 
 \begin{align*}
  \al^2    &= p+q+2\sqrt{pq} &
  \al^3    &= (p+3q)\sqrt{p}+(q+3p)\sqrt{q}, 
 \end{align*}
 so 
 \[ \sqrt{p} = \frac{\al^3-(q+3p)\al}{2(q-p)}
    \hspace{4em}
    \sqrt{q} = \frac{\al^3-(p+3q)\al}{2(p-q)}.
 \]
 This shows that $\sqrt{p},\sqrt{q}\in\Q(\al)$,
 $\Q(\al)=\Q(\sqrt{p},\sqrt{q})$.  The assumed linear independence
 statement shows that $[\Q(\sqrt{p},\sqrt{q}):\Q]=4$, so
 $[\Q(\al):\Q]=4$, so the minimal polynomial $\min(\al,\Q)$ must have
 degree $4$.  We saw above that $\al^2=p+q+2\sqrt{pq}$, so
 $(\al^2-(p+q))^2=4pq$, so $\al^4-2(p+q)\al+(p+q)^2-4pq=0$.  As
 $(p+q)^2-4pq=(p-q)^2$, this can be rewritten as $f(\al)=0$.  This
 means that $f(x)$ is divisible by $\min(\al,\Q)$, but both these
 polynomials are monic of degree $4$, so they must be the same.
 One can show in the same way that $f(\pm\sqrt{p}\pm\sqrt{q})=0$, for
 any of the four possible choices of signs.  Alternatively, we can
 perform the following expansion:
 \begin{align*}
   & (x-\sqrt{p}-\sqrt{q}) 
     (x-\sqrt{p}+\sqrt{q}) 
     (x+\sqrt{p}-\sqrt{q}) 
     (x+\sqrt{p}+\sqrt{q}) \\
  =& ((x-\sqrt{p})^2-q)((x+\sqrt{p})^2-q) = 
     (x^2-2\sqrt{p}x+p-q)(x^2+2\sqrt{p}x+p-q) \\
  =& (x^2+p-q)^2 - (2\sqrt{p}x)^2 
      = x^4 - 2(p+q)x^2 + (p-q)^2 = f(x).
 \end{align*}
 Either way, we see that the roots of $f(x)$ are $\sqrt{p}+\sqrt{q}$,
 $\sqrt{p}-\sqrt{q}$, $-\sqrt{p}+\sqrt{q}$ and $-\sqrt{p}-\sqrt{q}$,
 so the splitting field of $f(x)$ is $\Q(\sqrt{p},\sqrt{q})$.  

 On the other hand, we see by inspection that 
 \[ g(x)=(x^2-p)(x^2-q)=
     (x-\sqrt{p})(x+\sqrt{p})(x-\sqrt{q})(x+\sqrt{q}).
 \]
 It is clear from this that the splitting field of $g(x)$ is also
 $\Q(\sqrt{p},\sqrt{q})$. 
\end{solution}
\begin{exercise}\exlabel{ex-galois-i}
 Put $L=\Q(\sqrt[3]{3},\sqrt{-3})$.  Prove that this is normal over
 $\Q$, and describe the group $G(L/\Q)$.
\end{exercise}
\begin{solution}
 Put $\al=\sqrt[3]{3}\in\R$ and $\om=e^{2\pi i/3}=(\sqrt{-3}-1)/2$, so
 $L$ can also be described as $\Q(\al,\om)$.  Put
 $f(t)=t^3-3\in\Q[t]$.  This is irreducible over $\Q$ by Eisenstein's
 criterion at the prime $3$, but it splits over $L$ as
 $(t-\al)(t-\om\al)(t-\om^2\al)$.  It follows that $L$ is the
 splitting field of $f(t)$, so that the Galois group $G=G(L/\Q)$ can
 be regarded as a group of permutations of the set
 $R=\{\al,\om\al,\om^2\al\}$.  This group acts transitively on $R$
 (because $f(t)$ is irreducible), so it must be either the full group
 $\Sg_R$ of all permutations, or the subgroup $A_R$ of even
 permutations.  However, complex conjugation restricts to give an
 automorphism of $L$ corresponding to the transpositon that exchanges
 $\om\al$ and $\om^2\al$.  This shows that $G(L/K)\not\sse A_R$, so we
 must have $G(L/K)=\Sg_R\simeq\Sg_3$.
\end{solution}
\begin{exercise}\exlabel{ex-galois-ii}
 Find all automorphisms of the field $L=\Q(\sqrt[3]{3},i)$.  Deduce
 that $L$ is normal over $\Q(\sqrt[3]{3})$, but not over $\Q$.
\end{exercise}
\begin{solution}
 There is an automorphism $\sg$ of $L$ given by $z\mapsto\ov{z}$.  We
 claim that this is the only nontrivial automorphism.  To see this,
 write $\al=\sqrt[3]{3}$, so $L=\Q(\al,i)$ and
 \[ L\cap\R = \Q(\al) = \{a+b\al+c\al^2\st a,b,c\in\Q\}. \]
 We will need to know that $\sqrt{3}$ does not lie in $L$.  It
 certainly does not appear to lie in $L$, but there could in principle
 be a strange coincidence, so we should check rigorously.  As
 $\sqrt{3}$ is real, if it lay in $L$ we would have
 $\sqrt{3}=a+b\al+c\al^2$ for some $a,b,c\in\Q$.  Squaring this gives 
 \[ (a^2+6bc) + (2ab+3c^2)\al + (2ac+b^2)\al^2 = 3, \]
 so 
 \begin{align*}
  a^2+6bc  &= 3 \\
  2ab+3c^2 &= 0 \\
  2ac+b^2  &= 0.
 \end{align*}
 If either of $b$ or $c$ is zero then the first equation gives
 $a^2=3$, which is impossible as $a$ is rational.  We may thus assume
 that $b$ and $c$ are nonzero, and rearrange the second and third
 equations as $3c^2/b=-2a=b^2/c$, and thus $3=(b/c)^3$.  This is again
 impossible, as $b/c$ is rational.  Thus, we have $\sqrt{3}\not\in L$,
 as expected.  Now consider $\om=e^{2\pi i/3}=(\sqrt{3}i-1)/2$.  If
 this were in $L$, then $(2\om+1)/i=\sqrt{3}$ would also be in $L$,
 which is false.  So $\om\not\in L$, and similarly
 $\om^{-1}\not\in L$, so the only cube root of unity in $L$ is $1$.

 Now let $\rho$ be any automorphism of $L$.  Then
 $\rho(i)^2+1=\rho(i^2+1)=\rho(0)=0$, so $\rho(i)=\pm i$.  Similarly
 $(\rho(\al)/\al)^3=\rho(\al^3)/\al^3=\rho(3)/3=1$, so $\rho(\al)/\al$ 
 is a cube root of unity in $L$.  By the previous paragraph we
 therefore have $\rho(\al)=\al$.  It follows that $\rho$ is either the
 identity (if $\rho(i)=i$) or $\sg$ (if $\rho(i)=-i$).

 As $1$ and $\sg$ both act as the identity on $\al$, we see that
 $G(L/\Q(\al))=G(L/\Q)=\{1,\sg\}$.  Now
 $[L:\Q(\al)]=2=|G(L/\Q(\al))|$, so $L$ is normal over $\Q(\al)$.  On
 the other hand, $[L:\Q]=4>2=|G(L/\Q)|$, so $L$ is not normal over
 $\Q$.  Explicitly, the polynomial $f(t)=t^3-3\in\Q[t]$ has a root in
 $L$ but does not split in $L$.
\end{solution}
\begin{exercise}\exlabel{ex-galois-iii}
 Put $L=\Q(\sqrt[4]{3},i)$.  Find all the automorphisms of $L$, and
 show that $L$ is normal over $\Q$.
\end{exercise}
\begin{solution}
 Put $\al=\sqrt[4]{3}$ and 
 \[ f(t) = (t-\al)(t+\al)(t-i\al)(t+i\al). \]
 We find that $(t-\al)(t+\al)=t^2-\sqrt{3}$, but
 $(t-i\al)(t+i\al)=t^2+\sqrt{3}$, so $f(t)=t^4-3$.  It follows easily
 that $L=\Q(\al,i)$ is a splitting field for $f(t)$ over $\Q$, so $L$
 is normal over $\Q$.  The set $R=\{\al,i\al,-\al,-i\al\}$ of roots is
 the set of vertices of a square in the complex plane.  We claim that
 the group $G(L/\Q)$ is just the dihedral group of rotations and
 reflections of this square.  Indeed, complex conjugation gives an
 automorphism $\sg$ which reflects the square across the real axis.
 Next, we can use Eisenstein's criterion at the prime $3$ to see that
 $f(t)$ is irreducible, so $G(L/\Q)$ acts transitively on $R$.  It
 follows that there is an automorphism $\phi$ with $\phi(\al)=i\al$.
 Now $\phi(i)$ must be a square root of $-1$, so $\phi(i)=\pm i$.  If
 $\phi(i)=i$ then we put $\rho=\phi$, otherwise we put
 $\rho=\phi\sg$.  Either way we find that $\rho(i)=i$ and
 $\rho(\al)=i\al$.  This implies that $\rho(i^m\al)=i^{m+1}\al$ for
 all $m$, so $\rho$ is a quarter turn of the square.  This means that
 $\rho$ and $\sg$ generate $D_8$, so $|G(L/\Q)|\geq|D_8|=8$.  On the
 other hand, the set  
 \[ B = \{1,\al,\al^2,\al^3,i,i\al,i\al^2,i\al^3\} \]
 clearly spans $L$ over $\Q$, so $[L:\Q]\leq |B|=8$, and for any
 extension we have $|G(L/\Q)|\leq [L:\Q]$.  It follows that all these
 inequalities must be equalities, so $G(L/\Q)=D_8$ and $B$ is a basis.
 \begin{center}
  \begin{tikzpicture}[scale=1.5]
   \draw[blue] (1.32,0) -- (0,1.32) -- (-1.32,0) -- (0,-1.32) -- cycle;
   \fill ( 0.00, 0.00) circle(0.05);
   \fill ( 1.32, 0.00) circle(0.05);
   \fill ( 0.00, 1.32) circle(0.05);
   \fill (-1.32, 0.00) circle(0.05);
   \fill ( 0.00,-1.32) circle(0.05);
   \draw ( 1.54, 0.00) node{$\al$};
   \draw ( 0.00, 1.54) node{$i\al$};
   \draw (-1.59, 0.00) node{$-\al$};
   \draw ( 0.00,-1.54) node{$-i\al$};
   \draw[red,ultra thick,<->] (1.7,-0.3) -- (1.7,0.3);
   \draw[red,ultra thick,->] (0,0) +(0:0.3) arc(0:90:0.3);
   \draw[red] (1.85,0) node{$\sg$};
   \draw[red] (0.4,0.4) node{$\rho$};
  \end{tikzpicture}
 \end{center}
\end{solution}

\begin{exercise}\exlabel{ex-galois-iv}
 Consider the polynomial $f(x)=x^4+x^2+4$.  This is irreducible over
 $\Q$; you can either prove that, or just assume it and continue with
 the rest of the question.  Put 
 \[ \al=\sqrt{-\frac{1}{2}+\frac{1}{2}\sqrt{-15}}. \]
 \begin{itemize}
  \item[(a)] Show that the roots of $f(x)$ are $\pm\al$ and
   $\pm\frac{2}{\al}$, so $\Q(\al)$ is a splitting field for $f(x)$. 
  \item[(b)] Compute $G(\Q(\al)/\Q)$. What well-known group is it?
 \end{itemize}
\end{exercise}
\begin{solution}
 We will do~(a) and~(b) first, and then check that $f(x)$ is
 irreducible. 
 \begin{itemize}
  \item[(a)] From the definition we have $2\al^2+1=\sqrt{-15}$, and
   squaring again gives $4\al^4+4\al^2+16=0$, so $f(\al)=0$.  As
   $f(x)$ only involves even powers of $x$ we have $f(-x)=f(x)$ and so
   $f(-\al)=0$.  Now 
   \[ f(2/\al) = \frac{16}{\al^4} + \frac{4}{\al^2} + 4 = 
       \frac{4}{\al^4}(4+\al^2+\al^4) = \frac{4}{\al^4}f(\al)= 0,
   \]
   and similarly $f(-2/\al)=0$.  Numerically we have
   $\al\simeq 0.87+0.12i$, and from that one can check that
   $\al,-\al,2/\al$ and $-2/al$ are all distinct.  We must therefore
   have 
   \[ f(x) = (x-\al)(x+\al)(x-2/\al)(x+2/\al). \]

  \item[(b)] We have a normal extension of degree $4$, so the Galois
   group $G$ must have order $4$.  We know that $G$ acts transitively
   on the roots, so there are automorphisms $\sg$ and $\rho$ with
   $\sg(\al)=-\al$ and $\rho(\al)=2/\al$.  These satisfy
   $\sg^2(\al)=\sg(-\al)=-\sg(\al)=\al$ and
   $rho^2(\al)=\rho(2/\al)=2/\rho(\al)=\al$, so $\sg^2=\rho^2=1$.  We
   also have $\sg(\rho(\al))=\rho(\sg(\al))=-2/\al$.  It follows that 
   \[ G = \{1,\sg,\rho,\sg\rho\}, \]
   and this is isomorphic to $C_2\tm C_2$.
 \end{itemize} 

 We now prove that $f(x)$ is irreducible.  It is clear that $f(x)>0$
 for all $x\in\R$, so there are no roots in $\Q$.  This means that the
 only way $f(x)$ could factor would be as the product of two
 quadratics, say $f(x)=(x^2+ax+b)(x^2+cx+d)$ for some $a,b,c,d\in\Q$.
 By looking at the term in $x^3$, we see that $c=-a$.  After
 substituting this, expanding and comparing the remaining coefficients
 we obtain
 \begin{align*}
  b+d-a^2 &= 1 \\
  a(d-b) &= 0 \\
  bd &= 4.
 \end{align*}
 If $a=0$ we quickly obtain $b=(1\pm\sqrt{-3})/2$, which is impossible
 as $b\in\Q$.  Thus $a\neq 0$, so the second equation above gives
 $d=b$, so the last equation gives $b=\pm 2$.  The first equation then
 becomes $a^2=\pm 4-1$, which is impossible for $a\in\Q$.
\end{solution}
\begin{exercise}\exlabel{ex-galois-v}
 Put $f(x)=x^4+8x^2-2\in\Q[x]$, and $\al=\sqrt{3\sqrt{2}-4}$, and
 $M=\Q(\al,\sqrt{-2})$.  
 \begin{itemize}
  \item[(a)] Show that $f(x)$ is irreducible over $\Q$.
  \item[(b)] Show that $f(x)$ has roots $\pm\al,\pm\sqrt{-2}/\al$, so
   that $M$ is a splitting field for $f(x)$.
  \item[(c)] Show that $\Q(\al)=M\cap\R\neq M$, and deduce that
   $[M:\Q]=8$.
  \item[(d)] Show that there exist automorphisms
   $\phi,\psi\in G(M/\Q)$ such that $\phi$ has order 4, $\psi$ has
   order 2, and $G(M/\Q)=\langle\phi,\psi\rangle$.
  \item[(e)] Write $\psi\phi\psi^{-1}$ in the form $\phi^i\psi^j$. To
   what well-known group is $G(M/\Q)$ isomorphic?
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] As $f(x)=x^4\pmod{2}$ and $f(0)\neq 0\pmod{4}$ we can use
   Eisenstein's criterion to see that $f(x)$ is irreducible.
  \item[(b)] Note that $\al^2+4=3\sqrt{2}=\sqrt{18}$, and squaring
   again shows that $\al^4+8\al^2+16=18$, so $f(\al)=0$.  As $f(x)$
   only involves even powers of $x$ we have $f(-x)=f(x)$ and so
   $f(-\al)=0$.  Now put $\bt=\sqrt{-3\sqrt{2}-4}$; the same argument
   shows that $f(\pm\bt)=0$.  We also have
   $(\al\bt)^2=(3\sqrt{2}-4)(-3\sqrt{2}-4)=-2$, so
   $\bt=\pm\sqrt{-2}/\al$.  (With the standard conventions for square
   roots we have $\al>0$, and $\bt$ and $\sqrt{-2}$ are positive
   multiples of $i$, and it follows that $\bt=\sqrt{-2}/\al$.)  It
   follows that the roots of $f(x)$ are as described, so the splitting
   field is $\Q(\al,\bt)=\Q(\al,\al\bt)=\Q(\al,\sqrt{-2})=M$ as
   claimed.
  \item[(c)] We have $3\sqrt{2}-4\simeq 0.24>0$ so $\al$ is real, so
   $\Q(\al)\sse M\cap\R$.  As $f(x)$ is irreducible, it must be the
   minimal polynomial for $\al$, and so $[\Q(\al):\Q]=\deg(f(x))=4$.
   As $\Q(\al)\sse\R$ and $\sqrt{-2}$ is purely imaginary we see that
   $1,\sqrt{-2}$ is a basis for $M$ over $\Q(\al)$, so
   $M\cap\R=\Q(\al)$ and $[M:\Q]=[M:\Q(\al)][\Q(\al):\Q]=2\tm 4=8$.
  \item[(d)] First let $\psi\:M\to M$ be given by complex conjugation,
   so $\psi(\sqrt{-2})=-\sqrt{-2}$ and $\psi(\al)=\al$.  It is clear
   that $\psi^2=1$.  Next, the Galois group of the splitting field of
   an irreducible polynomial always acts transitively on the roots, so
   we can find $\sg\in G(M/\Q)$ with $\sg(\al)=\sqrt{-2}/\al$.  Now
   $\sg$ must permute the roots of $x^2+2$, so
   $\sg(\sqrt{-2})=\pm\sqrt{-2}$.  If the sign is positive we put
   $\phi=\sg\psi$, otherwise we put $\phi=\sg$.  In either case we
   then have $\phi(\al)=\sqrt{-2}/\al=\bt$ and
   $\phi(\sqrt{-2})=-\sqrt{-2}$.  This means that 
   \[ \phi^2(\al)=\phi(\sqrt{-2}/\al)=\phi(\sqrt{-2})/\phi(\al) = 
       -\sqrt{-2}/(\sqrt{-2}/\al) = -\al
   \]
   and $\phi^2(\sqrt{-2})=\sqrt{-2}$.  It follows in turn that
   $\phi^4=1$.  We now have various different automorphisms, whose
   effect we can tabulate as follows:
   \[ \renewcommand{\arraystretch}{1.5}
      \begin{array}{|c||c|c|c|c|c|c|c|c|} \hline
       & 1 & \phi & \phi^2 & \phi^3 &
         \psi & \phi\psi & \phi^2\psi & \phi^3\psi \\ \hline
       \al & \al & \bt & -\al & -\bt & \al & \bt & -\al & -\bt \\ \hline
       \bt & \bt & -\al & -\bt & \al & -\bt & \al & \bt & -\al \\ \hline
       \sqrt{-2} & \sqrt{-2} & -\sqrt{-2} & \sqrt{-2} & -\sqrt{-2} &
                   -\sqrt{-2} & \sqrt{-2} & -\sqrt{-2} & \sqrt{-2}. \\
       \hline
      \end{array}
   \]
   We see that the eight automorphisms listed are all different, but
   $|G(M/\Q)|=[M:\Q]=8$, so we have found all the automorphisms.
  \item[(e)] We can read off from the above table that
   $\psi\phi\psi^{-1}=\phi^3=\phi^{-1}$.  This means that $G(M/\Q)$ is
   the dihedral group $D_8$, with $\phi$ corresponding to a rotation
   through $\pi/2$, and $\psi$ to a reflection.
 \end{itemize}
\end{solution}


\section{Cyclotomic extensions}
\label{sec-cyclotomic}

\begin{definition}\lbl{defn-cyclotomic}
 For any $n>0$ we put 
 \[ \mu_n = \{z\in\C\st z^n=1\} = 
     \{\exp(2\pi ik/n) \st k=0,1,\dotsc,n-1\}.
 \]
 If $z\in\mu_n$ for some $n$, then the \emph{order} of $z$ is the
 smallest $d>0$ for which $z^d=1$; this is a divisor of $n$.  We write
 $\mu_n^\tm$ for the subset of $\mu_n$ consisting of numbers of order
 precisely $d$.  We also define
 \[ \vph_n(t) = \prod_{z\in\mu_n^\tm}(t-z) \in \C[t], \]
 and call this the \emph{$n$'th cyclotomic polynomial}.  We write
 $\Q(\mu_n)$ for the subfield of $\C$ generated by $\mu_n^\tm$, and
 call this the \emph{$n$'th cyclotomic field}.  This is evidently a
 splitting field for $\vph_n(t)$.
\end{definition}

\begin{remark}\lbl{rem-cyclotomic}
 If $\xi=\exp(2\pi ik/n)\in\mu_n$, then $\xi=\zt_1^k$, where
 $\zt_1=\exp(2\pi i/n)\in\mu_n^\tm$.  By definition we have
 $\zt_1\in\Q(\mu_n)$ and $\Q(\mu_n)$ is a subfield so it is closed
 under multiplication, so $\zt_1^k=\xi\in\Q(\mu_n)$.  This shows that
 $\Q(\mu_n)$ does indeed contain $\mu_n$ as suggested by the
 notation. 
\end{remark}

\begin{proposition}\lbl{prop-cyclotomic-product}
 The polynomial $\vph_n(t)$ is actually in $\Z[t]$, and satisfies
 \[ t^n-1 = \prod_{d|n} \vph_d(t). \]
\end{proposition}
\begin{proof}
 Firstly, for each divisor $d$ of $n$, we note that
 $\mu_d^\tm\sse\mu_d\sse\mu_n$.  Every element $z\in\mu_n$ lies in
 precisely one of the sets $\mu_d^\tm$, so we see that
 \[ \prod_{z\in\mu_n}(t-z) = 
    \prod_{d|n} \prod_{z\in\mu_d^\tm}(t-z) =
    \prod_{d|n} \vph_d(t).
 \] 
 On the other hand, the elements of $\mu_n$ are precisely the roots of
 $x^n-1$, and there are $n$ of them, so we see from
 Proposition~\ref{prop-several-roots} that
 $t^n-1=\prod_{z\in\mu_n}(t-z)=\prod_{d|n}\vph_d(t)$ as claimed.  

 We will now prove by induction that $\vph_n(t)\in\Z[t]$ for all $n$.
 To start the induction, note that $\mu_1^\tm=\{1\}$ so
 $\vph_1(t)=t-1\in\Z[t]$.  Now suppose that $\vph_d(t)\in\Z[t]$ for
 all $d<n$.  Let $f(t)$ be the product of all the polynomials
 $\vph_d(t)$ where $d|n$ and $d<n$.  From the above we then see that
 $t^n-1=f(t)\vph_n(t)$.  Moreover, the induction hypothesis implies
 that $f(t)\in\Z[t]\sse\Q[t]$, and it is visible that
 $t^n-1\in\Z[t]\sse\Q[t]$.  We therefore see from
 Corollary~\ref{prop-poly-subfield} that $\vph_n(t)\in\Q[t]$.  As
 $f(t)$ and $\vph_n(t)$ are monic and $f(t)\vph_n(t)\in\Z[t]$ it then
 follows from Proposition~\ref{prop-gauss} that $\vph_n(t)\in\Z[t]$.
\end{proof}

\begin{example}\lbl{eg-cyclotomic-p}
 We claim that when $p$ is prime we have
 $\vph_p(t)=1+t+\dotsb+t^{p-1}$.  Indeed, as the only divisors of $p$
 are $1$ and $p$, the proposition tells us that
 $t^p-1=\vph_1(t)\vph_p(t)$.  It is clear from the definitions that
 $\vph_1(t)=t-1$, so $\vph_p(t)=(t^p-1)/(t-1)$, which is
 $1+t+\dotsb+t^{p-1}$ by the standard geometric progression formula.
\end{example}

\begin{example}\lbl{eg-cyclotomic}
 One can also check that 
 \begin{align*}
  \vph_1(t) &= t-1 \\
  \vph_2(t) &= t+1 \\
  \vph_3(t) &= t^2+t+1 \\
  \vph_4(t) &= t^2+1 \\
  \vph_5(t) &= t^4+t^3+t^2+t+1 \\
  \vph_6(t) &= t^2-t+1 \\
  \vph_7(t) &= t^6+t^5+t^4+t^3+t^2+t+1 \\
  \vph_8(t) &= t^4+1 \\
  \vph_9(t) &= t^6+t^3+1 \\
  \vph_{10}(t) &= t^4-t^3+t^2-t+1.
 \end{align*}
 To see this, let $\psi_1(t),\dotsc,\psi_{10}(t)$ be the polynomials
 listed above, so the claim is that $\vph_n(t)=\psi_n(t)$ for
 $n=1,\dotsc,10$.  One can check directly that for these $n$ we have
 $t^n-1=\prod_{d|n}\psi_d(t)$, and for all $n$ we have
 $t^n-1=\prod_{d|n}\vph_d(t)$.  If we know that $\vph_d(t)=\psi_d(t)$
 for all $d<n$, one can easily deduce from this that
 $\vph_n(t)=\psi_n(t)$.  It therefore follows inductively that
 $\vph_n(t)=\psi_n(t)$ for $n\leq 10$ as claimed. 

 To explain the case $n=6$ in more detail, note that 
 \begin{align*}
  \psi_1(t)\psi_2(t)\psi_3(t)\psi_6(t) 
   &= (t-1)(t+1)(t^2+t+1)(t^2-t+1) \\
   &= (t^2-1)(t^4+t^2+1) = t^6-1.
 \end{align*}
 On the other hand, Proposition~\ref{prop-cyclotomic-product} tells
 us that $\vph_1(t)\vph_2(t)\vph_3(t)\vph_6(t)=t^6-1$.  It is clear
 that $\vph_1(t)=t-1=\psi_1(t)$, and using
 Example~\ref{eg-cyclotomic-p} we see that $\vph_2(t)=\psi_2(t)$ and
 $\vph_3(t)=\psi_3(t)$.  We can therefore cancel the factor
 $\vph_1(t)\vph_2(t)\vph_3(t)=\psi_1(t)\psi_2(t)\psi_3(t)$ in the
 equation
 \[ \vph_1(t)\vph_2(t)\vph_3(t)\vph_4(t) =
     t^6-1 = 
    \psi_1(t)\psi_2(t)\psi_3(t)\psi_4(t)
 \]
 to see that $\vph_4(t)=\psi_4(t)$ as claimed.
\end{example}

\begin{proposition}\lbl{prop-phi-irreducible}
 The polynomial $\vph_n(t)$ is irreducible over $\Q$.
\end{proposition}
The proof will follow after some preliminary results.

\begin{lemma}\lbl{lem-F-additive}
 If $p$ is prime then $(x+y)^p=x^p+y^p\pmod{p}$, and $n^p=n\pmod{p}$
 for all $n\in\Z$.
\end{lemma}
\begin{proof}
 First, we have the binomial expansion
 \[ (x+y)^p = \sum_{k=0}^p \bcf{p}{k} x^ky^{p-k} 
     = x^p+y^p+\sum_{k=1}^{p-1} \bcf{p}{k} x^ky^{p-k}.
 \]
 It will therefore be enough to show that $\bcf{p}{k}=0\pmod{p}$ for
 $0<k<p$.  From the definitions we have $k!(p-k)!\bcf{p}{k}=p!$, which
 is divisible by $p$.  This means that $p$ must divide $k!$ or
 $(p-k)!$ or $\bcf{p}{k}$.  However, as $k<p$ and $k!=1.2.3\dotsb k$
 we see that $k!$ is not divisible by $p$.  Moreover, $(p-k)!$ is also
 not divisible by $p$, for the same reason.  It follows that $p$ must
 divide $\bcf{p}{k}$, and we deduce that $(x+y)^p=x^p+y^p\pmod{p}$ as
 claimed.  

 Now suppose that $n^p=n\pmod{p}$.  By taking $x=n$ and $y=1$ in our
 previous congruence we obtain $(n+1)^p=n^p+1^p=n+1\pmod{p}$.  It
 follows by induction that $n^p=n\pmod{p}$ for all $n\in\N$.  We also
 have $n^p+(-n)^p=(n+(-n))^p=0^p=0\pmod{p}$, so
 $(-n)^p=-(n^p)=-n\pmod{p}$ for all $n\in\N$.  It follows that
 $m^p=m\pmod{p}$ for all $m\in\Z$.
\end{proof}
\begin{corollary}\lbl{cor-F-additive}
 If $g(t)\in\Z[t]$ then $g(t^p)=g(t)^p\pmod{p}$.
\end{corollary}
\begin{proof}
 We can write $g(t)=\sum_{i=0}^da_it^i$ with $a_i\in\Z$.  The lemma
 tells us that the $p$'th power operation commutes with addition
 modulo $p$, so $g(t)^p=\sum_{i=0}^da_i^pt^{ip}\pmod{p}$.  The lemma
 also tells us that $a_i^p=a_i\pmod{p}$, so
 $g(t)^p=\sum_{i=0}^da_it^{ip}\pmod{p}$, and this is just the same as
 $g(t^p)$.  
\end{proof}

\begin{lemma}\lbl{lem-zeta-p}
 Let $\zt$ be an element of $\mu_n^\tm$, and put $f(t)=\min(\zt,\Q)$.
 Let $p$ be a prime that does not divide $n$.  Then $f(\zt^p)=0$.
\end{lemma}
\begin{proof}
 As $\zt$ is a root of $t^n-1$ we see that $f(t)$ divides $t^n-1$, say
 $t^n-1=f(t)g(t)$ for some (necessarily monic) polynomial
 $g(t)\in\Q[t]$.  We see from Proposition~\ref{prop-gauss} that in
 fact $f(t),g(t)\in\Z[t]$.  

 Next, we can use the equation $\zt^n=1$ to see that
 $(\zt^p)^n-1=0$, or equivalently $f(\zt^p)g(\zt^p)=0$.  If we can
 show that $g(\zt^p)\neq 0$ then we conclude that $f(\zt^p)=0$ as
 required.  

 We therefore assume that $g(\zt^p)=0$, and try to derive a
 contradiction.  Note that $g(t^p)$ is a polynomial in $\Z[t]$ that is
 zero when $t=\zt$.  It therefore follows from the definition of
 $f(t)=\min(\zt,\Q)$ that $g(t^p)$ is divisible by $f(t)$, say
 $g(t^p)=f(t)h(t)$.  We can again use Proposition~\ref{prop-gauss} to
 see that $h(t)\in\Z[t]$.

 We next need to work temporarily modulo $p$.  For any polynomial
 $m(t)\in\Z[t]$, we will write $\ov{m}(t)$ for the image of $m(t)$ in
 $\F_p[t]$.  The equation $g(t^p)=f(t)h(t)$ in conjunction with
 Corollary~\ref{cor-F-additive} tells us that
 $\ov{g}(t)^p=\ov{f}(t)\ov{h}(t)$.  Now let $\ov{k}(t)$ be any
 monic irreducible factor of $\ov{f}(t)$ in $\F_p[t]$.  We then see that
 $\ov{k}(t)$ divides $\ov{g}(t)^p$, so (by irreducibility) it must
 divide $\ov{g}(t)$.  It follows that $\ov{k}(t)^2$ divides
 $\ov{f}(t)\ov{g}(t)=t^n-1$, say $t^n-1=\ov{k}(t)^2\ov{m}(t)$ for some
 $\ov{m}(t)\in\F_p[t]$.  We then take the algebraic derivative to see that
 \[ n\,t^{n-1} = 
     2\ov{k}(t)\ov{k}'(t)\ov{m}(t) + \ov{k}(t)^2\ov{m}'(t) =
     (2\ov{k}'(t)\ov{m}(t) + \ov{k}(t)\ov{m}'(t))\ov{k}(t)
 \]  
 so in particular $\ov{k}(t)$ divides $n\,t^{n-1}$.  Note here that
 $n\neq 0$ in $\F_p$ (because we assumed that $p$ does not divide $n$)
 and that $\ov{k}(t)$ was assumed to be monic and irreducible.  It is
 clear from this that we must have $\ov{k}(t)=t$, so $\ov{k}(0)=0$.
 We can thus put $t=0$ in the equation $t^n-1=\ov{k}(t)^2\ov{m}(t)$ to
 get $-1=0\pmod{p}$, which is the required contradiction.
\end{proof}
\begin{corollary}\lbl{cor-cyclotomic-roots}
 Let $\zt$ be an element of $\mu_n^\tm$, and put $f(t)=\min(\zt,\Q)$.
 Let $k$ be any integer that is coprime to $n$.  Then
 $f(t)=\min(\zt^k,\Q)$ (and so $f(\zt^k)=0$). 
\end{corollary}
\begin{proof}
 If $k$ is prime, then the lemma tells us that $f(\zt^k)=0$.  It
 follows that $\min(\zt^k,\Q)$ is a non-constant monic divisor of the
 irreducible polynomial $f(t)$, so it must just be equal to $f(t)$ as
 required. 

 Now suppose that $k=pq$ for some primes $p$ and $q$ (which cannot
 divide $n$, because $k$ is coprime to $n$).  By the prime
 case (applied to $\zt$ and $p$) we see that $f(t)=\min(\zt^p,\Q)$.
 We can therefore apply the prime case again to $\zt^p$ and $q$ to see
 that $f(t)=\min(\zt^{pq},\Q)=\min(\zt^k,\Q)$.  In general, if $k>0$
 and $k$ is coprime to $n$ then we can write $k=p_1p_2\dotsb p_r$ for
 some primes $p_1,\dotsc,p_r$ (not necessarily distinct) that do not
 divide $n$.  We then see that $f(t)=\min(\zt^k,\Q)$ by an obvious
 extension of the argument for the case $k=pq$.  Finally, if $k<0$ and
 $(k,n)=1$ then we can choose $j$ such that the number $k'=k+jn$ is
 positive (and still coprime to $n$).  We then see that
 $f(t)=\min(\zt^{k'},\Q)$ but $\zt^{k'}=(\zt^n)^j\zt^k=\zt^k$ so
 $f(t)=\min(\zt^k,\Q)$ as claimed.
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop-phi-irreducible}]
 Put $\zt=\exp(2\pi i/n)\in\mu_n^\tm$, and $f(t)=\min(\zt,\Q)$.  As
 $\vph_n(\zt)=0$ we see that $f(t)$ divides $\vph_n(t)$.  On the other
 hand, the roots of $\vph_n(t)$ are precisely the elements of
 $\mu_n^\tm$, or in other words the powers $\zt^k$ with $0\leq k<n$
 and $(k,n)=1$.  Corollary~\ref{cor-cyclotomic-roots} tells us that
 these are also roots of $f(t)$, so $\vph_n(t)$ divides $f(t)$ by
 Proposition~\ref{prop-several-roots}.  As $f(t)$ and $\vph_n(t)$ are
 monic polynomials that divide each other, we must have
 $\vph_n(t)=f(t)$.  As $f(t)$ is irreducible by definition, we see
 that $\vph_n(t)$ is irreducible as claimed.
\end{proof}

\begin{proposition}\lbl{prop-cyclotomic-galois}
 For each $k\in\Z$ that is coprime to $n$ there is a unique
 automorphism $\sg_k$ of $\Q(\mu_n)$ such that $\sg_k(\zt)=\zt^k$ for all
 $\zt\in\mu_n$.  Moreover, the rule $k+n\Z\mapsto\sg_k$ gives an
 isomorphism of groups $(\Z/n\Z)^\tm\to G(\Q(\mu_n)/\Q)$.
\end{proposition}
\begin{proof}
 Put $\zt_1=\exp(2\pi i/n)\in\mu_n^\tm$; we have seen that
 $\vph_n(x)=\min(\zt_1,\Q)$.  Now suppose we have $k\in\Z$ such that
 $(k,n)=1$.  Then $\zt_1^k\in\mu_n^\tm$, so $\vph_n(\zt_1)=0$.  It
 then follows from Proposition~\ref{prop-root-perms}(c) that there is
 an automorphism $\sg_k\in G(\Q(\mu_n)/\Q)$ with $\sg_k(\zt_1)=\zt_1^k$.
 Any other element $\zt\in\mu_n$ has the form $\zt=\zt_1^m$ for some
 $m$, and as $\sg_k$ is a homomorphism we deduce that 
 \[ \sg_k(\zt)=\sg_k(\zt_1^m)=\sg_k(\zt_1)^m=(\zt_1^k)^m=
     (\zt_1^m)^k=\zt^k.
 \]
 Next, part~(b) of Proposition~\ref{prop-root-perms} tells us that any
 automorphism of $\Q(\mu_n)$ is determined by its effect on the set
 $\mu_n^\tm$ of roots of $\vph_n(t)$.  It follows that $\sg_k$ is the
 \emph{unique} automorphism such that $\sg_k(\zt)=\zt^k$ for all
 $\zt\in\mu_n$.  In particular, if $j$ is another element of $\Z$ that
 is coprime to $n$, we see that 
 \[ \sg_j(\sg_k(\zt))=\sg_j(\zt^k)=\sg_j(\zt)^k=\zt^{jk}=\sg_{jk}(\zt).
 \]
 It therefore follows from the above uniqueness statement that
 $\sg_j\sg_k=\sg_{jk}$.  Similarly, if $j=k\pmod{n}$ then
 $\zt^j=\zt^k$ for all $\zt\in\mu_n$ so $\sg_j$ and $\sg_k$ give the
 same permutation of roots, so $\sg_j=\sg_k$.  We now see that there
 is a well-defined map $S\:(\Z/n\Z)^\tm\to G(\Q(\mu_n)/\Q)$ given by
 $S(k)=\sg_k$.  If $\sg_k$ is the identity then we must have
 $\zt_1^k=\zt_1$, so $\zt_1^{k-1}=1$, so $k=1\pmod{n}$.  It follows
 that $\ker(S)=\{1\}$ and so $S$ is injective.  Finally, suppose that
 $\tau\in G(\Q(\mu_n)/\Q)$.  We then see that $\tau(\zt_1)$ must be a root
 of $\vph_n(t)$, and so $\tau(\zt_1)=\zt_1^k$ for some $k$ that is
 coprime to $n$.  Just as above we deduce that $\tau(\zt)=\zt^k$ for
 all $\zt\in\mu_n$, and so $\tau=\sg_k$.  This proves that $S$ is
 surjective and so is an isomorphism.
\end{proof}

We will state without proof the following result of Kronecker and
Weber: 
\begin{theorem}\lbl{thm-kronecker-weber}
 Let $K$ be a subfield of $\C$ that is normal and of finite degree
 over $\Q$, such that $G(K/\Q)$ is abelian.  Then $K\sse\Q(\mu_n)$ for
 some $n$.
\end{theorem}

The proof uses ideas far beyond the scope of these notes.  However, we
will prove an interesting special case.

\begin{proposition}\lbl{prop-root-p}
 For any prime $p>2$ we have $\sqrt{p}\in\Q(\mu_{4p})$.  More
 precisely, if $\xi=\exp(\pi i/(2p))$ is the standard generator of
 $\mu_{4p}$ then 
 \[ \sqrt{p} = \prod_{k=1}^{(p-1)/2} (\xi^{p-2k}-\xi^{p+2k}) = 
     \xi^{(p-1)^2/4} \prod_{k=1}^{(p-1)/2} (1-\xi^{4k}).
 \]
 (Note here that $(p-1)/2$ and $(p-1)^2/4$ are integers, because $p$
 is odd.)
\end{proposition}

\begin{example}\lbl{eg-five}
 Before discussing the general case we will look at the example where
 $p=5$.  There we have $\xi=\exp(\pi i/10)$ and the claim is that
 \[ \sqrt{5} = (\xi^3-\xi^7)(\xi-\xi^9) = \xi^4(1-\xi^4)(1-\xi^8). \]
 Put
 \begin{align*}
  \lm &= (\xi^3-\xi^7)(\xi-\xi^9) \\
  \mu &= \xi^4(1-\xi^4)(1-\xi^8),
 \end{align*}
 so the claim is that $\lm=\mu=\sqrt{p}$.  If we start with $\lm$ and
 extract a factor of $\xi^3$ from the first bracket and a factor of
 $\xi$ from the second bracket then we end up with $\mu$, so $\lm=\mu$
 as claimed.  It will be convenient to rewrite $\mu$ in terms of
 $\zt=\xi^4=\exp(2\pi i/5)$, which is a primitive $5$th root of
 unity.  This satisfies 
 \[ (1+\zt+\zt^2+\zt^3+\zt^4)(1-\zt)=1-\zt^5=0 \]
 and $1-\zt\neq 0$ so we must have $1+\zt+\zt^2+\zt^3+\zt^4=0$.

 Note that 
 \[ \mu = \zt(1-\zt)(1-\zt^2) = \zt-\zt^2-\zt^3+\zt^4. \]
 If we square this and collect terms in the most obvious way, we get 
 \begin{align*}
  \mu^2 &= \zt^2+\zt^4+\zt^6+\zt^8
            -2\zt^3-2\zt^4+2\zt^5+2\zt^5-2\zt^6-2\zt^7 \\
        &= \zt^2-2\zt^3-\zt^4+4\zt^5-\zt^6-2\zt^7+\zt^8.
 \end{align*}
 If we now use the identity $\zt^5=1$ (so $\zt^6=\zt$ and so on) we
 get 
 \begin{align*}
  \mu^2 &= \zt^2-2\zt^3-\zt^4+4-\zt-2\zt^2+\zt^3 \\
   &= 4-\zt-\zt^2-\zt^3-\zt^4.
 \end{align*}
 Finally, we can combine this with the identity 
 $1+\zt+\zt^2+\zt^3+\zt^4=0$ to get $\mu^2=5$, so $\mu=\pm\sqrt{5}$.
 It is not hard to check that the factors $\xi^3-\xi^7$ and
 $\xi-\xi^9$ are positive real numbers, so $\mu>0$, so $\mu=\sqrt{5}$;
 we will explain this in more detail when we discuss the general case.
\end{example}	

\begin{lemma}\lbl{lem-root-p-xi}
 With $p$ and $\xi$ as above we have
 $\prod_{k=1}^{p-1}(1-\xi^{4k})=p$. 
\end{lemma}
\begin{proof}
 The powers $\xi^{4k}$ for $k=0,\dotsc,p-1$ are precisely the $p$'th
 roots of unity, so we have
 \[ t^p-1 = \prod_{k=0}^{p-1} (t-\xi^{4k}). \]
 The $k=0$ term on the right hand side is just $t-1$.  We can move
 this to the left hand side and use the standard geometric progression
 formula to get
 \[ 1 + t + \dotsb + t^{p-1} = \frac{t^p-1}{t-1} = 
     \prod_{k=1}^{p-1} (t-\xi^{4k}).
 \]
 Now set $t=1$.  On the left hand side we have $p$ terms which all
 become $1$, and on the right we have $\prod_{k=1}^{p-1}(1-\xi^{4k})$
 so $\prod_{k=1}^{p-1}(1-\xi^{4k})=p$ as claimed.
\end{proof}

\begin{corollary}\lbl{cor-norm}
 We have $|\prod_{k=1}^{(p-1)/2}(1-\xi^{4k})|=\sqrt{p}$.
\end{corollary}
\begin{proof}
 Put $\kp=\prod_{k=1}^{(p-1)/2}(1-\xi^{4k})$.  We then have
 $\ov{\kp}=\prod_{k=1}^{(p-1)/2}(1-\xi^{-4k})$, and $\xi^{4p}=1$ so we
 can rewrite $\xi^{-4k}$ as $\xi^{4p-4k}$ or as $\xi^{4(p-k)}$.  Now,
 as $k$ runs from $1$ to $(p-1)/2$ we find that $p-k$ runs through the
 numbers from $(p+1)/2$ to $p-1$ (in reverse order), so the numbers
 $k$ and $p-k$ together cover all the numbers from $1$ to $p-1$ (each
 number exactly once).  Thus 
 \[ \kp\ov{\kp} =
      \prod_{k=1}^{(p-1)/2}(1-\xi^{4k})
      \prod_{k=1}^{(p-1)/2}(1-\xi^{4(p-k)}) =
      \prod_{j=1}^{p-1}(1-\xi^{4j}) = p.
 \]
 (The last step here is just the previous lemma.)  On the other hand,
 we have $\kp\ov{\kp}=|\kp|^2$, so $|\kp|=\sqrt{p}$ as claimed.
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop-root-p}]
 Put 
 \begin{align*}
  \lm &= \prod_{k=1}^{(p-1)/2} (\xi^{p-2k}-\xi^{p+2k}) \\ 
  \mu &= \xi^{(p-1)^2/4} \prod_{k=1}^{(p-1)/2} (1-\xi^{4k}),
 \end{align*}
 so the claim is that $\lm=\mu=\sqrt{p}$.  First, combine
 Corollary~\ref{cor-norm} with the fact that $|\xi|=1$ to get
 \[ |\mu| = |\xi|^{(p-1)^2/4}
      \left|\prod_{k=1}^{(p-1)/2}(1-\xi^{4k})\right| = 
       1^{(p-1)^2/4} \sqrt{p} = \sqrt{p}. 
 \]

 Next, note that
 \[ \xi^{p-2k}(1-\xi^{4k}) = \xi^{p-2k} - \xi^{p+2k}. \]
 Take the product for $k=1,\dotsc,(p-1)/2$ to get 
 \[ \xi^N \prod_{k=1}^{(p-1)/2} (1-\xi^{4k}) = \lm, \]
 where $N=\sum_{k=1}^{(p-1)/2}(p-2k)$.  This is the sum of $(p-1)/2$
 equally spaced terms from $p-2$ down to $1$, so the average term is
 $\half((p-2)+1)=(p-1)/2$ and the total is the number of terms times
 the average, which gives $N=(p-1)^2/4$.  Given this, the displayed
 equation tells us that $\mu=\lm$, so $|\lm|=|\mu|=\sqrt{p}$.

 Next, note that $\xi^p=i$ and 
 \begin{align*}
  \xi^{2k}  &= \exp( k\pi i/p) = \cos(k\pi/p) + i\sin(k\pi/p) \\
  \xi^{-2k} &= \exp(-k\pi i/p) = \cos(k\pi/p) - i\sin(k\pi/p)
 \end{align*}
 so 
 \[ \xi^{p-2k}-\xi^{p+2k} =
     i(\cos(k\pi/p) - i\sin(k\pi/p)) -
     i(\cos(k\pi/p) + i\sin(k\pi/p)) = 2\sin(k\pi/p).
 \]
 Moreover, when $1\leq k\leq (p-1)/2$ we have $0<k\pi/p<\pi/2$ so
 $\sin(k\pi/p)>0$.  It follows that $\lm$ is a positive real number,
 so $\lm=|\lm|=\sqrt{p}$.
\end{proof}

\begin{corollary}\lbl{cor-mquad-cyclotomic}
 For any field of the form $K=\Q(\sqrt{p_1},\dotsc,\sqrt{p_m})$ (where
 the $p_i$ are odd primes) there exists $N$ such that $K\sse\Q(\mu_N)$.
\end{corollary}
\begin{proof}
 Put $N=4\prod_ip_i$.  For each $i$ we see that $4p_i$ divides $N$ and
 so $\sqrt{p_i}\in\Q(\mu_{4p_i})\sse\Q(\mu_N)$.  It follows that
 $K\sse\Q(\mu_N)$ as claimed.
\end{proof}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-cyclotomic-twenty}
 Find the cyclotomic polynomial $\vph_{20}(x)$.
\end{exercise}
\begin{solution}
 Recall the key fact that 
 \[ x^n-1 = \prod_{d|n} \vph_d(x). \]
 In particular, we have
 \begin{align*}
  x-1 &= \vph_1(x) \\
  x^2-1 &= \vph_1(x)\vph_2(x) \\
  x^4-1 &= \vph_1(x)\vph_2(x)\vph_4(x) \\
  x^5-1 &= \vph_1(x)\vph_5(x) \\
  x^{10}-1 &= \vph_1(x)\vph_{2}(x)\vph_5(x)\vph_{10}(x) \\
  x^{20}-1 &= \vph_1(x)\vph_{2}(x)\vph_4(x)
              \vph_5(x)\vph_{10}(x)\vph_{20}(x).
 \end{align*}
 Dividing the second and third of these gives
 \[ \vph_4(x) = \frac{x^4-1}{x^2-1} = x^2+1. \]
 On the other hand, we can divide the last two equations to give
 \[ \vph_{20}(x)\vph_4(x) = 
     \frac{x^{20}-1}{x^{10}-1} = x^{10}+1.
 \]
 Putting these together, we get
 \[ \vph_{20}(x) = 
     \frac{x^{10}+1}{x^2+1} = x^8-x^6+x^4-x^2+1.
 \]
 (The calculation can also be arranged in various other ways, but this
 is probably the most efficient.)
\end{solution}

\begin{exercise}\exlabel{ex-phi-CC}
 What is $\vph_{200}(x)$?
\end{exercise}
\begin{solution}
 We have
 \begin{align*}
  x^{200}-1 &=
   \vph_{200}(x)\vph_{100}(x)\vph_{50}(x)\vph_{40}(x)
   \vph_{25}(x)\vph_{20}(x)\vph_{10}(x)\vph_8(x)\vph_5(x)
   \vph_4(x)\vph_2(x)\vph_1(x)\\
  x^{100}-1 &=
   \vph_{100}(x)\vph_{50}(x)\vph_{25}(x)\vph_{20}(x)
   \vph_{10}(x)\vph_5(x)\vph_4(x)\vph_2(x)\vph_1(x)\\
  x^{40}-1  &=
   \vph_{40}(x)\vph_{20}(x)\vph_{10}(x)\vph_8(x)
   \vph_5(x)\vph_4(x)\vph_2(x)\vph_1(x)\\
  x^{20}-1  &=
   \vph_{20}(x)\vph_{10}(x)\vph_5(x)\vph_4(x)\vph_2(x)\vph_1(x)
 \end{align*}
 and it follows that
 \[ \vph_{200}(x) =
     \frac{(x^{200}-1)(x^{20}-1)}{(x^{100}-1)(x^{40}-1)} = 
     \frac{x^{100}+1}{x^{20}+1} =
      x^{80}-x^{60}+x^{40}-x^{20}+1.
 \]
\end{solution}

\begin{exercise}\exlabel{ex-mu-seven}
 Explicitly compute a polynomial $f(t)\in\Q[t]$ of degree six with
 $e^{3\pi i/7}+1$ as a root.  Prove that this polynomial is
 irreducible over $\Q$, using Eisenstein's criterion.
\end{exercise}
\begin{solution}
 Put $\zt=e^{3\pi i/7}=(e^{2\pi i/14})^3$ and
 $\al=\zt+1$.  As $3$ and $14$ are coprime, we see that $\zt$ is a
 primitive 14th root of unity, and so is a root of the cyclotomic
 polynomial $\vph_{14}(t)$.  We know that
 \begin{align*}
  t^{14}-1 &= \vph_{14}(t)\vph_7(t)\vph_2(t)\vph_1(t) \\
  t^7 - 1  &= \vph_7(t)\vph_1(t) \\
  t+1      &= \vph_2(t).
 \end{align*}
 We can divide the first of these by the second and the third to give
 \[ \vph_{14}(t) = 
    \frac{t^7+1}{t+1} = t^6-t^5+t^4-t^3+t^2-t+1.
 \]
 Now put $f(t)=\vph_{14}(t-1)$.  This is again a polynomial of degree
 $6$ over $\Q$, and we have
 $f(\al)=\vph_{14}(\al-1)=\vph_{14}(\zt)=0$.  More explicitly, we can
 use the expression $\vph_{14}(t)=(t^7+1)/(t+1)$ to get
 \[ f(t) = \frac{(t-1)^7+1}{t-1+1} = 
     ((t-1)^7+1)/t = \sum_{i=0}^6 (-1)^i\bcf{7}{i} t^{6-i} =
      t^6-7t^5+21t^4-35t^3+35t^2-21t+7.
 \]
 This reduces to $t^6$ modulo $7$, either by inspecting the
 coefficients directly, or by recalling that
 $(t-1)^7=t^7-1^7\pmod{7}$.  Moreover, the constant term is $7$, which
 is not divisible by $7^2$.  Thus Eisenstein's criterion is
 applicable, and we see that $f(t)$ is irreducible.
\end{solution}

\begin{exercise}\exlabel{ex-mu-fifteen}
 Describe the automorphisms of $\Q(\mu_{15})$.  Find two cyclic
 subgroups $A$ and $B$ such that $G(\Q(\mu_{15})/\Q)=A\tm B$.
\end{exercise}
\begin{solution}
 Put $\zt=e^{2\pi i/15}$ and $K=\Q(\zt)=\Q(\mu_{15})$.  The general
 theory tells us that for each integer $k$ that is coprime to $15$,
 there is a unique automorphism $\sg_k$ of $K$ with
 $\sg_k(\zt)=\zt^k$, and that the rule $k+15\Z\mapsto\sg_k$ gives a
 well-defined isomorphism $(\Z/15\Z)^\tm\to G(K/\Q)$.  Every element
 of $\Z/15\Z$ has a unique representative lying between $-7$ and $7$,
 and the integers in that range that are coprime to $15$ form the set
 \[ U = \{-7,-4,-2,-1,1,2,4,7\}, \]
 so we can identify this set with $(\Z/15\Z)^\tm$.  Put $A=\{1,-1\}$,
 which is a cyclic subgroup of $U$ of order $2$.  Note that
 $2^3=8=-7\pmod{15}$ and $2^4=16=1\pmod{15}$.  It follows that the set
 $B=\{1,2,4,-7\}$ is a cyclic subgroup of $U$ of order $4$, and we see
 directly that $U=A\tm B$.
\end{solution}

\begin{exercise}\exlabel{ex-cyclotomic-real}
 Let $\zt$ be a primitive $n$th root of unity, where $n\geq 3$, and write 
 $\bt=\zt+\zt^{-1}$.
 \begin{itemize}
  \item[(a)] Show that $\zt$ satisfies a quadratic equation over
   $\Q(\bt)$ and deduce that $[\Q(\zt):\Q(\bt)]\leq 2$.
  \item[(b)] Show that $\Q(\bt)\subset\R$, and deduce that
   $\zt\not\in\Q(\bt)$.  Deduce that $[\Q(\zt):\Q(\bt)]=2$.
  \item[(c)] Prove by induction that for all $m$, 
   $\zt^m+\zt^{-m}\in\Q(\bt)$.
  \item[(d)] Express $\zt^5+\zt^{-5}$ as a polynomial in $\bt$.
 \end{itemize}

 [{\sl Hint for (c) and (d): if $\zt^m+\zt^{-m}=p_m(\bt)$, show that
 $\zt^{m+1}+\zt^{-m-1}=\bt p_m(\bt)-p_{m-1}(\bt)$.}]
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] Put $f(x)=x^2-\bt x+1\in\Q(\bt)[x]$.  As
   $\bt=\zt+\zt^{-1}$, we see that $\bt\zt=\zt^2+1$, so $f(\zt)=0$.
   Thus, $\zt$ satisfies a quadratic equation over $\Q(\bt)$, as
   claimed.  The minimal polynomial $\min(\zt,\Q(\bt))$ must divide
   $f(x)$, so it has degree one (if $\zt\in\Q(\bt)$) or two (if
   $\zt\not\in\Q(\bt)$).  Thus, we have $[\Q(\zt):\Q(\bt)]\leq 2$.

  \item[(b)] We next observe that $\zt^n=1$ so $|\zt|>0$ and
   $|\zt|^n=1$, so $|\zt|=1$.  If $\zt$ is real this means that
   $\zt=\pm 1$, so $\zt^2=1$, but this contradicts the assumption that
   $\zt$ is a primitive $n$th root for some $n\geq 3$.  Thus, we see
   that $\zt\not\in\R$.  On the other hand, as $|\zt|=1$ we see that
   $\zt^{-1}=\ov{\zt}$, so $\bt=\zt+\ov{\zt}=2\text{Re}(\zt)\in\R$.
   It follows that $\Q(\bt)\sse\R$ and so $\zt\not\in\Q(\bt)$.  In
   conjunction with~(a) this means that $[\Q(\zt):\Q(\bt)]=2$.

  \item[(c)] We claim that $\zt^m+\zt^{-m}=p_m(\bt)$ for some
   polynomial $p_m(x)$.  Indeed, we can put $p_0(x)=2$ and $p_1(x)=x$,
   and then define $p_m(x)$ recursively for $m>1$ by
   $p_{k+1}(x)=x\,p_k(x)-p_{k-1}(x)$.  We claim that
   $p_k(\bt)=\zt^k+\zt^{-k}$.  This is clear for $k\in\{0,1\}$.  If
   the claim holds for all $k\leq m$, we have 
   \begin{align*}
    p_{m+1}(\bt) &= 
     \bt p_m(\bt) - p_{m-1}(\bt) \\
     &= (\zt+\zt^{-1})(\zt^m+\zt^{-m}) - (\zt^{m-1}+\zt^{1-m}) \\
     &= (\zt^{m+1}+\zt^{1-m}+\zt^{m-1}+\zt^{-m-1}) - 
         (\zt^{m-1}+\zt^{1-m}) \\
     &= \zt^{m+1}+\zt^{-m-1}.
   \end{align*}
   The claim therefore holds for all $m$, by induction.
  
  \item[(d)] The first few steps of the recursive scheme are as
   follows:
   \begin{align*}
    p_0(x) &= 2 \\
    p_1(x) &= x \\
    p_2(x) &= x\,p_1(x) - p_0(x) = x^2-2 \\
    p_3(x) &= x\,p_2(x) - p_1(x) = x^3-3x \\
    p_4(x) &= x\,p_3(x) - p_2(x) = x^4-4x^2+2 \\
    p_5(x) &= x\,p_4(x) - p_3(x) = x^5-5x^3+5x.
   \end{align*}
   Thus, we have $\zt^5+\zt^{-5}=\bt^5-5\bt^3+5\bt$.
 \end{itemize} 
\end{solution}


\begin{exercise}\exlabel{ex-shift-irr}
 Show that if $f(t)\in K[t]$ and $a\in K$ and the polynomial
 $g(t)=f(t+a)$ is irreducible, then $f(t)$ itself is also
 irreducible.  Apply this together with Eisenstein's criterion to give
 an alternative proof that $\vph_p(t)$ is irreducible (for any prime
 $p$).  
\end{exercise}
\begin{solution}
 Suppose that $g(t)=f(t+a)$ is irreducible as above.  Suppose we have
 a factorisation $f(t)=p(t)q(t)$, where $p(t)$ and $q(t)$ are
 nonconstant polynomials in $K[t]$.  We then have nonconstant
 polynomials $r(t)=p(t+a)$ and $s(t)=q(t+a)$ with $g(t)=r(t)s(t)$.
 This is impossible, because $g(t)$ is assumed to be irreducible.
 This means that no such factorisation $f(t)=p(t)q(t)$ can exist, so
 $f(t)$ must be irreducible.

 Now take $f(t)=\vph_p(t)=(t^p-1)/(t-1)$ and $a=1$.  We then have 
 \[ g(t) = \frac{(t+1)^p-1}{(t+1)-1} = 
     t^{-1}((t+1)^p-1) = \sum_{i=0}^{p-1}\bcf{p}{i+1}t^i.
 \]
 This is monic, and using Lemma~\ref{lem-F-additive} we see that
 $g(t)=t^{p-1}\pmod{p}$, so the coefficients of $t^0,\dotsc,t^{p-2}$
 are all divisible by $p$.  Moreover, the constant term is $g(0)=p$,
 which is not divisible by $p^2$.  Eisenstein's criterion therefore
 tells us that $g(t)=f(t+1)$ is irreducible, so we can use the first
 paragraph above to see that $f(t)$ is also irreducible.
\end{solution}
\begin{exercise}\exlabel{ex-phi-two-power}
 Prove that $\vph_{2^{k+1}}(t)=t^{2^k}+1$. 
\end{exercise}
\begin{solution}
 Put $s=t^{2^k}$.  As the divisors of $2^k$ are just the powers $2^j$
 for $j\leq k$, we have $s-1=\prod_{j=0}^k\vph_{2^j}(t)$.  We also
 have $s^2=t^{2\tm 2^k}=t^{2^{k+1}}$, so
 $s^2-1=\prod_{j=0}^{k+1}\vph_{2^j}(t)$.  By dividing these two
 equations we get $\vph_{2^{k+1}}(t)=(s^2-1)/(s-1)=s+1=t^{2^k}+1$ as
 claimed. 

 Alternatively, if $\zt$ is a $2^{k+1}$th root of unity, then
 $\zt^{2^k}$ cannot be equal to $1$ (by primitivity) but
 $(\zt^{2^k})^2=\zt^{2^{k+1}}=1$.  We must therefore have
 $\zt^{2^k}=-1$.  It follows that the primitive $2^{k+1}$th roots of
 unity are precisely the same as the roots of $t^{2^k}+1$.  This
 polynomial is monic and coprime with its derivative, so there are no
 repeated roots.  It follows that $t^{2^k}+1$ is the product of
 $t-\zt$ as $\zt$ runs over the roots, which is $\vph_{2^{n+1}}(t)$.
\end{solution}

\begin{exercise}\exlabel{ex-phi-families}\ \\
 \begin{itemize}
  \item[(a)] Prove that $\zt$ is a primitive $m$th root of unity if
   and only if $\ov{\zt}$ is a primitive $m$th root of unity.  Deduce
   that if $m>2$ then $\vph_n(x)$ has even degree.
  \item[(b)] Let $n\geq 6$ be even, but not divisible by $4$.  Prove
   that $\zt$ is a primitive $n$th root of 1 if and only if $-\zt$ is
   a primitive $(n/2)$th root of 1.  Deduce that
   $\vph_n(x)=\vph_{n/2}(-x)$. 
  \item[(c)] Suppose that $n$ is divisible by $p^2$ for some prime
   $p$.  Show that $\zt$ is a primitive $n$th root of $1$ if and only
   if $\zt^p$ is a primitive $(n/p)$th root of $1$.  Deduce that
   $\vph_n(x)=\vph_{n/p}(x^p)$.
  \item[(d)] Recall that $\vph_1(x)=x-1$, and that
   $\vph_p(x)=1+x+\dotsb+x^{p-1}$ when $p$ is prime.  How many
   cyclotomic polynomials can you calculate using these facts together
   with~(b) and~(c)?
  \item[(e)] For small $n$ one observes that all coefficients in
   $\vph_n(x)$ are $0$, $1$ or $-1$, but this pattern does not persist
   for ever.  Let $N$ be the smallest number such that $\vph_N(x)$ has
   a coefficient not in $\{0,1,-1\}$.  What do~(b) and~(c) tell you
   about $N$?
  \item[(f)] Use~(e) to find $N$, with help from Maple if
   necessary.  (Start by entering
   \verb+with(numtheory):+; then you can use the notation
   \verb+cyclotomic(n,x)+ for $\vph_n(x)$.) 
 \end{itemize}
\end{exercise}
\begin{solution}
 We will write $\mu_k$ for the set of all $k$th roots of unity, and
 $\mu_k^\tm$ for the subset of primitive roots.
 \begin{itemize}
  \item[(a)] Note that $\zt^k=1$ if and only if $\ov{\zt}^k=1$, so
   $\zt$ and $\ov{\zt}$ have the same order.  In other words, $\zt$ is
   a primitive $m$th root of unity if and only if $\ov{\zt}$ is a
   primitive $m$th root of unity.  Now suppose that $m>2$.  The only
   roots of unity on the real axis are $+1$ (of order $1$) and $-1$
   (of order $2$), so all primitive $m$th roots of unity have nonzero
   imaginary part.  Our first observation shows that the roots with
   positive imaginary part biject with those of negative imaginary
   part, so the total number of roots is even.  This number is the
   same as the degree of $\vph_m(x)$.
  \item[(b)] We can write $n=2m$, where $m$ is odd.  Suppose that
   $\zt\in\mu_n^\tm$, so $\zt^k=1$ if and only if $n|k$.  This means
   that $\zt^m\neq 1$, but $(\zt^m)^2=\zt^n=1$, so we must have
   $\zt^m=-1$.  This means that $(-\zt)^m=(-1)^m\zt^m=(-1)^{m+1}$,
   which is $1$ because $m$ is odd.  On the other hand, if
   $(-\zt)^k=1$ then $\zt^{2k}=(-\zt)^{2k}=1^2=1$, so $2k$ must be
   divisible by $n=2m$, so $k$ must be divisible by $m$.  This proves
   that $-\zt\in\mu_m^\tm$.

   Conversely, suppose that $-\zt\in\mu_m^\tm$.  As $m$ is odd we then
   have $\zt^m=(-1)^m(-\zt)^m=-1$, and thus $\zt^n=(\zt^m)^2=1$, so
   $\zt\in\mu_n$.  On the other hand, if $\zt^k=1$ then
   $(-\zt)^{2k}=(\zt^k)^2=1$, so $2k$ is divisible by $m$.  As $m$ is
   odd this can only happen if $k$ is divisible by $m$, say $k=mj$.
   This means that $\zt^k=(\zt^m)^j=(-1)^j$, but we also assumed that
   $\zt^k=1$, so $j$ must be even.  As $k=mj$ this means that $k$ is
   divisible by $2m=n$.  This shows that $\zt\in\mu_n^\tm$.

   Next, $\vph_m(x)$ is the product of the terms $x-\zt$ for
   $\zt\in\mu_m^\tm$, so $\vph_m(-x)$ is the product of the
   corresponding terms $-x-\zt$.  The number of terms here is
   $|\mu_m^\tm|$, which is even, by part~(a).  It therefore does not
   matter if we change all the signs, so $\vph_m(x)$ is the product of
   the terms $x+\zt$.  Now $x+\zt=x-(-\zt)$, and
   $\{-\zt\st\zt\in\mu_m^\tm\}=\mu_n^\tm$, so we see that
   $\vph_m(-x)=\vph_n(x)$.

  \item[(c)] We can write $n=p^2m$ for some $m$, so $n/p=mp$.  
   Suppose that $\zt\in\mu_n^\tm$.   Then
   $(\zt^p)^{mp}=\zt^n=1$.  On the other hand, if
   $(\zt^p)^k=\zt^{pk}=1$, then $pk$ must be divisible by $p^2m$, so
   $k$ must be divisible by $pm$.  It follows that
   $\zt^p\in\mu_{pm}^\tm$.  

   Conversely, suppose that $\zt^p\in\mu_{mp}^\tm$.  It is then clear
   that $\zt^n=(\zt^p)^{mp}=1$, so $\zt\in\mu_n$.  On the other hand,
   suppose that $\zt^k=1$.  Then $(\zt^p)^k=1$, so $k$ is divisible by
   $mp$, say $k=mpj$.  Now the original relation $\zt^k=1$ can be
   written as $(\zt^p)^{mj}=1$, so $mj$ must be divisible by $mp$, say
   $mj=mpi$.  It follows that $k=mpj=p.mj=mp^2i=ni$, so $k$ is
   divisible by $n$.  This shows that $\zt\in\mu_n^\tm$ as claimed.

   Now note that $\vph_{n/p}(x^p)$ is the product of the terms
   $x^p-\xi$ for $\xi\in\mu^\tm_{n/p}$.  Here $x^p-\xi$ can be
   rewritten as the product of the terms $x-\zt$, as $\zt$ runs over
   the $p$th roots of $\xi$.  Thus, $\vph_{n/p}(x^p)$ is the product
   of all terms $x-\zt$ for which $\zt^p\in\mu_{n/p}^\tm$, or
   equivalently (by what we just proved) $\zt\in\mu_n^\tm$.  This
   means that $\vph_{n/p}(x^p)=\vph_n(x)$.

  \item[(d)] If we start with $\vph_p(x)$ and apply~(c) repeatedly we
   can find $\vph_{p^k}(x)$ for all $k$ (and any prime $p$).  If $p$
   is odd we can then use~(b) to find $\vph_{2p^k}(x)$, and then we
   can use method~(c) at the prime $2$ to find $\vph_{4p^k}(x)$,
   $\vph_{8p^k}(x)$ and so on.  Eventually this gives
   $\vph_{2^ip^j}(x)$ for all $i$ and $j$.  If $p$ and $q$ are
   distinct odd primes, then we cannot find $\vph_{pq}(x)$ by this
   method.  In particular, the first case that we do not cover is
   $\vph_{15}(x)$.  However, if we compute $\vph_{pq}(x)$ by some
   other method then using~(b) and~(c) we can find
   $\vph_{2^ip^jq^k}(x)$.  

  \item[(e)] Let $N$ be the smallest number such that $\vph_N(x)$ has
   a coefficient not in $\{0,1,-1\}$.  If $N$ is divisible by $p^2$
   for some prime $p$, then $\vph_N(x)=\vph_{N/p}(x^p)$ by~(c).  Here
   $N/p<N$ so (by the definition of $N$) the coefficients of
   $\vph_{N/p}(x)$ are all in $\{0,1,-1\}$.  It follows that the same
   is true of $\vph_{N/p}(x^p)$, which gives a contradiction.  Thus,
   $N$ cannot be divisible by $p^2$ for any $p$, so $N$ is a product
   of distinct primes.  If one of these primes is $2$ then the
   remaining primes are odd, so~(b) is applicable and
   $\vph_N(x)=\vph_{N/2}(-x)$, which again gives a contradiction.
   Thus, $N$ must be a product of distinct odd primes.  There must be
   more than one prime factor, because of the rule
   $\vph_p(x)=\sum_{i=0}^{p-1}x^i$. 

  \item[(f)] The first few numbers that are products of at least two
   odd primes are 
   \[ 15, 21, 33, 35, 39, 51, 65, 69, 77, 85, 87, 91, 93, 95, 105.
   \]
   We can ask Maple to calculate the corresponding cyclotomic
   polynomials, and we find that they all have coefficients in
   $\{0,1,-1\}$ until we get to $\vph_{105}(x)$.  This has degree $48$
   and involves $-2t^7$ and $-2t^{41}$, so $N=105$.  In fact
   $105=3\tm 5\tm 7$, which is the smallest number that is a product
   of three distinct odd primes.

   Alternatively, we can make Maple do all the work automatically, as
   follows: 
\begin{verbatim}
 for n from 1 to 1000 do
  f := numtheory[cyclotomic](n,x);
  A := {coeffs(f,x)} minus {0,1,-1};
  if nops(A) > 0 then
   print([n,sort(f)]);
   break;
  fi:
 od:
\end{verbatim}
 \end{itemize}
\end{solution}

\begin{exercise}\exlabel{ex-phi-pq}
 Let $p$ and $q$ be distinct odd primes, and consider the power series 
 \[ f(x) = \sum_{i=0}^{q-1}\sum_{j=0}^{p-1}\sum_{k=0}^\infty
            (x^{ip+jq+kpq}-x^{1+ip+jq+kpq}).
 \]
 Prove that $f(x)=\vph_{pq}(x)$ (so in particular, enough terms must
 cancel to make $f(x)$ a polynomial).
\end{exercise}
\begin{solution}
 We can reorganise the definition and use the geometric progression
 formula as follows:
 \begin{align*}
   f(x) &= (1-x)\left(\sum_{i=0}^{q-1}x^{ip}\right)
                \left(\sum_{j=0}^{p-1}x^{jq}\right)
                \left(\sum_{k=0}^\infty x^{kpq}\right) \\
   &= (1-x)\frac{x^{pq}-1}{x^p-1}
       \frac{x^{pq}-1}{x^q-1}\frac{1}{1-x^{pq}} 
    = \frac{(x-1)(x^{pq}-1)}{(x^p-1)(x^q-1)} \\
   &= \frac{\vph_1(x)\vph_{pq}(x)\vph_p(x)\vph_q(x)\vph_1(x)}
           {\vph_p(x)\vph_1(x)\vph_q(x)\vph_1(x)} 
    = \vph_{pq}(x).
 \end{align*}

 Now consider an arbitrary natural number $m$.  The element
 $m/p\in\F_q$ is represented by some $i\in\{0,\dotsc,q-1\}$, and the
 element $m/q\in\F_p$ is represented by some $j\in\{0,\dotsc,p-1\}$.
 We find that $m-(ip+jq)$ is divisible by both $p$ and $q$, so
 $m=ip+jq+kpq$ for some $k\in\Z$.  We define $\lm(m)$ to be $1$ if
 $k\geq 0$, and $0$ if $k<0$.  Note that $ip+jq\leq(q-1)p+(p-1)q<2pq$,
 so $\lm(m)=1$ for $m\geq 2pq$.  The definition of $f(x)$ can now be
 rewritten as 
 \[ f(x) = \sum_{m=0}^\infty \lm(m)(x^m-x^{m+1}) = 
     \sum_{m=0}^\infty (\lm(m)-\lm(m-1)) x^m.
 \]
 It follows that all the coefficients of $f(x)$ are in $\{0,1,-1\}$.
 We also see that for $m>2pq$ we have $\lm(m)-\lm(m-1)=1-1=0$, so
 $f(x)$ is a polynomial as expected.
\end{solution}

\begin{exercise}\exlabel{ex-fifth-root}
 Let $\zt$ be a primitive 5th root of unity, and let $\al$ denote the 
 real 5th root of 2. You are given that $\Q(\zt,\al)$ is the
 splitting field of $x^5-2$ over $\Q$ and that $[\Q(\zt,\al):\Q]=20$.
 \begin{itemize}
  \item Specify the elements of $\Gal(\Q(\zt,\al)/\Q)$ by
   writing down how they act on $\zt$ and on $\al$.
  \item Show that there exist automorphisms $\phi$, 
   $\psi\in\Gal(\Q(\zt,\al)/\Q)$ such that $\phi$ has order 4,
   $\psi$ has order 5, and 
   $\Gal(\Q(\zt,\al)/\Q)=\langle\phi,\psi\rangle$.
  \item Write $\phi\psi\phi^{-1}$ in the form $\phi^i\psi^j$.
  \item 
   Recall that if $\bt=\zt+\frac{1}{\zt}$, then
   $\Q(\bt)=\Q(\sqrt{5})$. Under the Galois correspondence, what should
   be the order of the corresponding subgroup 
   $\Gal(\Q(\zt,\al)/\Q(\bt))$?
  \item Show that the group $\Gal(\Q(\zt,\al)/\Q(\bt))$
   is $\langle\phi^2,\psi\rangle$.
 \end{itemize}
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item Any automorphism is uniquely determined by its effect on $\al$
  and on $\zt$. The image of $\al$ must be a root of $x^5-2$, so
  must be one of $\al$, $\zt\al$, $\zt^2\al$, $\zt^3\al$
  or $\zt^4\al$. In the same way, the image of $\zt$ must be another
  primitive 5th root of unity, i.e., a root of $\vph_5$, so is one of
  $\zt$, $\zt^2$, $\zt^3$ or $\zt^4$. This gives 20 possible
  automorphisms, $\theta_{ij}$ say, defined by
  \begin{eqnarray*}
  \theta_{ij}(\zt)&=&\zt^i\\
  \theta_{ij}(\al)&=&\zt^j\al
  \end{eqnarray*}
  for $i=1$, 2, 3 or 4 and $j=0$, 1, 2, 3 or 4.
  As the extension
  $\Q(\zt,\al)/\Q$ is Galois and has degree 20, these are all of
  the automorphisms.
  \item The automorphism $\psi$ which fixes $\zt$ and maps
  $\al$ to $\zt\al$ is clearly of order 5. The automorphism 
  $\phi$ which fixes $\al$ and maps $\zt$ to $\zt^2$ is of order 4
  because $\phi^2(\zt)=\phi(\zt^2)=\zt^4$, and so
  $\phi^4(\zt)=\phi^2(\zt^4)=(\zt^4)^4=\zt$. 

  The group generated by
  $\phi$ and $\psi$ has as subgroups $\langle\phi\rangle$ and $\langle\psi\rangle$
  so its order must be a multiple of 4 and of 5 by Lagrange's Theorem. It follows
  that this group must have order 20, so is the whole Galois group.
  \item We have:
  \begin{eqnarray*}
  &\phi\psi\phi^{-1}(\al)=\phi\psi(\al)=\phi(\zt\al)=\phi(\zt)\phi(\al)=\zt^2.\al\\
  &\phi\psi\phi^{-1}(\zt)=\phi\psi(\zt^3)=\phi(\zt^3)=\zt
  \end{eqnarray*}
  It follows that $\phi\psi\phi^{-1}=\psi^2$.
  \item We see that
  $$\zt^2+\zt+1+\zt^{-1}+\zt^{-2}=0.$$
  Rearranging, we get
  $$(\zt+\frac{1}{\zt})^2+(\zt+\frac{1}{\zt})-1=0.$$
  It follows that $\bt$ is a root of $X^2+X-1$, and so 
  $\bt=\frac{-1\pm\sqrt{5}}{2}$, from the quadratic formula. It is then
  easy to see that $\Q(\bt)=\Q(\sqrt{5})$.

  $[\Q(\bt):\Q]=2$, so the index of the corresponding subgroup of
  $\Gal(M/\Q)$ must be 2, so its order must be 10.
  \item The group $\langle\phi^2,\psi\rangle$ is of order 10 (it contains
  an element of order 2, and an element of order 5, so its order must be a
  multiple of 10~--~but it isn't the whole group, as it doesn't contain $\phi$).
  Let $G$ be the subgroup associated to $\Q(\bt)$.
  If we can show that $\bt$ is fixed by both $\phi^2$ and by $\psi$, we
  will know that $\langle\phi^2,\psi\rangle\subseteq G$. But by the
  previous part of the question, $|G|=10$, and so we have to have 
  $G=\langle\phi^2,\psi\rangle$, as required.

  But this is easy to check:
  \begin{eqnarray*}
  &\phi^2(\bt)=\phi^2(\zt)+\frac{1}{\phi^2(\zt)}=\zt^{-1}+\frac{1}{\zt^{-1}}=\frac{1}{\zt}+\zt=\bt\\
  &\psi(\bt)=\psi(\zt)+\frac{1}{\psi(\zt)}=\zt+\frac{1}{\zt}=\bt.
  \end{eqnarray*}
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-forty-two}
 Let $L$ be the splitting field of $x^7-3$ over $\Q$. You know that
 $[L:\Q]=42$. Calculate the elements of $\Gal(L/\Q)$.
 Find $\psi$, $\phi\in\Gal(L/\Q)$ which satisfy:
 \begin{itemize}
  \item $\psi$ has order 7, $\phi$ has order 6
  \item $\phi\psi\phi^{-1}=\psi^3$
 \item $\Gal(L/\Q)=\langle\phi,\psi\rangle$
 \end{itemize}
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item $L=\Q(\al,\zt)$, where $\zt=e^{{2\pi i}/{7}}$ and
  $\al$ is the real 7th root of 3. Any automorphism must send $\zt$ to
  another primitive 7th root of unity, and send $\al$ to a 7th root
  of 3. 

  There is an automorphism
  $\psi$ which fixes $\zt$ but maps $\al$ to $\zt\al$. Clearly
  $\psi$ is of order 7, as doing $\psi$ seven times fixes $\al$.

  Further, there is an automorphism $\phi$ which fixes $\al$ but sends
  $\zt$ to $\zt^3$. Applying $\phi$ successively to $\zt$ we see that
  $\zt$ is sent successively to
  $$\zt\mapsto\zt^3\mapsto\zt^2\mapsto\zt^6\mapsto\zt^4\mapsto\zt^5\mapsto\zt\mapsto\cdots$$
  so $\phi$ has order 6.
  \item
  Further, 
  $$\phi\psi\phi^{-1}(\al)=\phi\psi(\al)=\phi(\zt\al)=\phi(\zt)\phi(\al)=\zt^3\al=\psi^3(\al)$$
  and
  $$\phi\psi\phi^{-1}(\zt)=\phi\psi(\zt^5)=\phi(\zt^5)=\zt=\psi^3(\zt)$$
  Thus $\phi\psi\phi^{-1}=\psi^3$.
  \item
  Finally, it remains to see that $\phi$ and $\psi$ generate the whole Galois
  group. But the Galois group has order 42, and the subgroup generated by
  $\phi$ and $\psi$ has order which is a multiple of both 6 and 7, so it must
  be the whole group.
 \end{itemize}
\end{solution}


\section{Finite fields}
\label{sec-finite-fields}

We now divert temporarily from our main focus on fields of
characteristic zero, and instead discuss finite fields.  It turns out
that the relevant theory is quite closely related to that of
cyclotomic fields.

\begin{theorem}\lbl{thm-finite-fields}
 \begin{itemize}
  \item[(a)] There is a finite field of order $n$ if and only if
   $n=p^r$ for some prime $p$ and $r>0$.
  \item[(b)] If $K$ is a field of order $p^r$ then $K$ has
   characteristic $p$, and $K^\tm\simeq C_{p^r-1}$.  Moreover, the
   function $\sg(a)=a^p$ defines an automorphism of $K$, called the
   \emph{Frobenius automorphism}.
  \item[(c)] If $K$ and $L$ are fields of the same order then they are
   isomorphic.  
  \item[(d)] If $|L|=p^{rs}$ then the set $K=\{a\in L\st a^{p^r}=a\}$
   is a subfield of $L$, and is the unique subfield of order $p^r$.
   Moreover, this procedure gives all the subfields of $L$.
  \item[(e)] If $K$ and $L$ are as above, then $L$ is normal over $K$,
   and $G(L/K)$ is cyclic of order $s$, generated by $\sg^r$.
 \end{itemize}
\end{theorem}

The proof will be given at the end of this section; it will consist of
collecting together a number of smaller results that we will prove
separately. 

We first discuss a few examples.
\begin{example}\lbl{eg-finite-misc}
 We have already seen the fields $\F_p=\Z/p\Z$ for $p$ prime, and
 Example~\ref{eg-F-four} exhibited a field $\F_4$ of order four.  Now
 suppose that $p>2$, and consider the ring $\F_p[i]$ of ``mod $p$
 complex numbers'', as discussed in Exercise~\ref{ex-Ri-field}.  The
 elements of $\F_p[i]$ have the form $a+bi$, with $a,b\in\F_p$, and
 the multiplication rule is
 \[ (a+bi)(c+di) = (ac-bd)+(ad+bc)i. \]
 We saw in Exercise~\ref{ex-Ri-field} that $\F_3[i]$ is a field (of
 order $9$) but that $\F_2[i]$ and $\F_5[i]$ are not fields.  More
 generally, we will see in Proposition~\ref{prop-Fpi} that $\F_p[i]$ is
 a field (of order $p^2$) if and only if $p=3\pmod{4}$.
\end{example}

\begin{lemma}\lbl{lem-finite-field-order}
 Let $K$ be a finite field.  Then $K$ has characteristic $p>0$ for
 some prime $p$, and $|K|=p^r$ for some $r>0$.
\end{lemma}
\begin{proof}
 As $K$ is finite, the elements $n.1$ (for $n\in\N$) cannot all be
 different.  It follows that there exist integers $n<m$ with
 $n.1=m.1$, so $(m-n).1=0$.  It follows (see
 Definition~\ref{defn-char}) that $\chr(K)>0$, and so $\chr(K)$ is a
 prime $p$ by Proposition~\ref{prop-char}.  It therefore follows from
 Proposition~\ref{prop-hom-char} that $K$ contains a copy of $\F_p$.
 Note that the whole of $K$ is certainly a finite spanning set for $K$
 over $\F_p$, so $K$ is finite-dimensional over $\F_p$, with dimension
 $r$ say.  This means that $K\simeq\F_p^r$ and so $|K|=p^r$.  As
 $1\neq 0$ in $K$ (by one of the field axioms) we have $|K|>1$ and so
 $r>0$. 
\end{proof}

\begin{lemma}\lbl{prop-frobenius-exists}
 Let $K$ be a finite field of order $p^r$.  Then the function
 $\sg(a)=a^p$ defines an automorphism of $K$.
\end{lemma}
\begin{proof}
 It is clear that $\sg(0)=0$ and $\sg(1)=1$ and
 $\sg(ab)=\sg(a)\sg(b)$.  We also see from Lemma~\ref{lem-F-additive}
 that $\sg(a+b)=\sg(a)+\sg(b)$.  This means that $\sg$ is a
 homomorphism from $K$ to $K$.  Now suppose that
 $K=\{a_1,\dotsc,a_{p^r}\}$.  We see from
 Proposition~\ref{prop-hom-inj} that $\sg$ is injective, so the $p^r$
 elements $\sg(a_1),\dotsc,\sg(a_{p^r})$ are all different, so between
 them they must cover all the $p^r$ elements of $K$.  This means that
 $\sg$ is also surjective, so it is an isomorphism as required.
\end{proof}

\begin{remark}\lbl{rem-frobenius-powers}
 We observe that
 \begin{align*}
  \sg(a) &= a^p \\
  \sg^2(a) &= \sg(\sg(a)) = (a^p)^p = a^{p\tm p} = a^{p^2} \\
  \sg^3(a) &= \sg(\sg^2(a)) = (a^{p^2})^p = a^{p^2\tm p} = a^{p^3} \\
  \sg^4(a) &= \sg(\sg^3(a)) = (a^{p^3})^p = a^{p^3\tm p} = a^{p^4}
 \end{align*}
 and so on; in general, $\sg^r(a)=a^{p^r}$.  
\end{remark}

\begin{lemma}\lbl{lem-cyclotomic-coprime}
 Suppose that $p$ is prime and $r>0$ and put $q=p^r$.  If
 $f(x),g(x)\in\F_p[x]$ and $x^q-x$ is divisible by $f(x)g(x)$, then
 $f(x)$ and $g(x)$ are coprime.
\end{lemma}
\begin{proof}
 We have $x-x^q=f(x)g(x)h(x)$ for some $h$.  Taking derivatives gives
 \[ 1-qx^{q-1} = f'(x)g(x)h(x) + f(x)g'(x)h(x) + f(x)g(x)h'(x). \]
  The left hand side is just $1$, because we are working mod $p$.  We
  can rewrite the right hand side in terms of the polynomials
  $a(x)=g'(x)h(x)+g(x)h'(x)$ and $b(x)=f'(x)h(x)$ to get 
 \[ 1= a(x)f(x)+b(x)g(x), \]
 showing that $f(x)$ and $g(x)$ are coprime.
\end{proof}

\begin{lemma}\lbl{lem-Fq-exists}
 Suppose again that $p$ is prime and $r>0$ and $q=p^r$.  Let
 $f(x)\in\F_p[x]$ be an irreducible factor of the mod $p$ reduction of
 $\vph_{q-1}(x)$, and put $K=\F_p[x]/f(x)$.  Then $K$ is a field with
 $|K|=q$, and $K^\tm$ is cyclic of order $q-1$.
\end{lemma}
\begin{proof}
 We write $\al$ for the image of $x$ in $K$, so $f(\al)=0$.  As $f(x)$
 is irreducible, we see from Corollary~\ref{cor-quotient-field} that
 $K$ is a field and $K=\F_p(\al)$.  If $f(x)$ has degree $s$ we also
 see from Proposition~\ref{prop-quotient-basis} that $K\simeq\F_p^s$
 as vector spaces over $\F_p$, so in particular $|K|=p^s$.  As
 $f(x)\;|\;\vph_{q-1}(x)\;|\;x^{q-1}-1\;|\;x^q-x$, we see that
 $\al^q=\al$.  Here $q=p^r$ and so one checks that
 $\sg^r(t)=t^{p^r}=t^q$, so we see that $\sg^r(\al)=\al$.  Now put
 $K'=\{a\in K\st\sg^r(a)=a\}$.  We see from
 Proposition~\ref{prop-fixed-subfield} that $K'$ is a subfield of
 $K=\F_p(\al)$, and it contains $\al$ so it must be all of $K$.  This
 means that every element in $K$ is a root of the polynomial
 $g(x)=x^q-x$.  However, $g(x)$ has degree $q$ and so cannot have more
 than $q$ roots in any field.  We must therefore have $|K|\leq q$.  

 We next consider the order of $\al$ in $K^\tm$.  As explained above
 we have $f(x)\;|\;x^{q-1}-1$ and so $\al^{q-1}=1$, so the order of
 $\al$ divides $q-1$.  Write $r$ for this order, and suppose (for a
 contradiction) that $r<q-1$.  It then follows from
 Proposition~\ref{prop-cyclotomic-product} that $x^{q-1}-1$ is
 divisible by $(x^r-1)f(x)$, so Lemma~\ref{lem-cyclotomic-coprime}
 tells us that $x^r-1$ and $f(x)$ are coprime mod $p$.  This means
 that there exist polynomials $a(x),b(x)\in\F_p[x]$ with
 $a(x)(x^r-1)+b(x)f(x)=1$.  We now put $x=\al$, remembering that
 $f(\al)=0=\al^r-1$, to get $0=1$, which is impossible.  We must
 therefore have $r=q-1$ instead, so the subgroup of $K^\tm$ generated
 by $\al$ is isomorphic to $C_{q-1}$.  On the other hand, we have
 shown that $|K|\leq q$ so $|K^\tm|\leq q-1$.  This can only be
 consistent if $K^\tm=\ip{\al}\simeq C_{q-1}$ as claimed.
\end{proof}

\begin{example}\lbl{eg-F-eight}
 Put $f(t)=1+t+t^3$ and $g(t)=1+t^2+t^3$, considered as elements of
 $\F_2[t]$.  By direct expansion and Example~\ref{eg-cyclotomic-p} we
 see that 
 \[ f(t)g(t) = 1+t+t^2+t^3+t^4+t^5+t^6 = \vph_7(t) 
     \text{ in } \F_2[t].
 \]
 We also claim that $f(t)$ is irreducible over $\F_2$.  Indeed, any
 nontrivial factorisation of $f(t)$ would involve a factor of degree
 one, which would give a root of $f(t)$ in $\F_2=\{0,1\}$.  However,
 we have $f(0)=f(1)=1$ so there is no such root.  By the same argument
 we see that $g(t)$ is also irreducible.  It follows that there are
 fields $K=\F_2[\al]/f(\al)$ and $L=\F_2[\bt]/g(\bt)$ of order $8$.  

 We next claim that in $K$ we have $g(\al^3)=0$.  Indeed, by
 construction we have $f(\al)=0$, and $f(t)$ divides $t^7-1$, so
 $\al^7=1$, which implies $\al^9=\al^2$.  The relation $f(\al)=0$ can
 also be rewritten as $\al^3=1+\al$, which squares to give
 $\al^6=1+\al^2$.  It follows that 
 \[ g(\al^3) = 1+\al^6+\al^9 = 1+(1+\al^2)+\al^2 = 0 \]
 as claimed.  This means that we can define a homomorphism
 $\lm\:L\to K$ by $\lm(\bt)=\al^3$.  One can check that this is
 actually an isomorphism, with $\lm^{-1}(\al)=\bt^5$.  
\end{example}

\begin{proposition}\lbl{prop-units-cyclic}
 Let $K$ be a field, and let $U$ be a finite subgroup of
 $K^\tm$.  Then $U$ is cyclic.
\end{proposition}
\begin{proof}
 Put $U[d]=\{x\in U\st x^d=1\}$.  As a polynomial of degree
 $d$ can have at most $d$ roots, we see that $|U[d]|\leq d$
 for all $d$.  The claim thus follows from
 Lemma~\ref{lem-cyclic-test} below.
\end{proof}

\begin{lemma}\lbl{lem-cyclic-test-aux}
 Let $U$ be a finite abelian group of order $n$ such that
 $|U[d]|\leq d$ for all $d$.  Then $|U[d]|=d$ whenever $d$
 divides $n$.
\end{lemma}
\begin{proof}
 We can define a group homomorphism $\al\:U\xra{}U$ by
 $\al(x)=x^{n/d}$.  We note that $\al(x)^d=x^n=1$, so
 $\al(x)\in U[d]$, so $|U[d]|\geq |\img(\al)|$.  On the other hand,
 the First Isomorphism Theorem tells us
 $|\img(\al)|=|U|/|\ker(\al)|$.  Here $|U|=n$, and it is clear from
 the definitions that $\ker(\al)=U[n/d]$, so $|\ker(\al)|\leq n/d$, so
 $|\img(\al)|\geq n/(n/d)=d$.  Putting this together gives
 $|U[d]|\geq d$, but also $|U[d]|\leq d$ by assumption, so $|U[d]|=d$
 as claimed.  The groups and homomorphisms considered can be displayed
 in the following diagram:
 \[ \xymatrix{
     U[n/d] \ar@{ >->}[r] \dto &
     U \dto_\al \ar@{->>}[rr] & & 
     U/U[n/d] \dto_\simeq^{\ov{\al}} \\
     1 \ar@{ >->}[r] &
     U & 
     U[d] \ar@{ >->}[l] & 
     \img(\al) \ar@{ >->}[l] 
    }
 \]
\end{proof}

\begin{lemma}\lbl{lem-cyclic-test}
 Let $U$ be a finite abelian group such that $|U[d]|\leq d$
 for all $d$.  Then $U$ is cyclic.
\end{lemma}
\begin{proof}
 Put $n=|U|$ and let $C$ be a cyclic group of order $n$; we will
 compare $U$ with $C$.  Put
 \[ U\ip{d} = \{x\in U\st x \text{ has exact order } d\}. \]
 Note that $x^d=1$ if and only if the exact order of $x$ is a divisor
 of $d$.  Using this together with Lemma~\ref{lem-cyclic-test-aux} we
 see that $d=|U[d]|=\sum_{e|d}|U\ip{e}|$, so 
 \[ |U\ip{d}| = d - \sum_{e|d,e<d} |U\ip{e}|.  \]
 Similarly, we have 
 \[ |C\ip{d}| = d - \sum_{e|d,e<d} |C\ip{e}|.  \]
 Note that $|U\ip{1}|=1=|C\ip{1}|$.  If we know that
 $|U\ip{e}|=|C\ip{e}|$ for all $e<d$, we can use the above two
 displayed equations to see that $|U\ip{d}|=|C\ip{d}|$ as well.  It
 therefore follows by induction that $|U\ip{d}|=|C\ip{d}|$ for all $d$
 dividing $n$, and in particular that $|U\ip{n}|=|C\ip{n}|$.  Now, any
 generator of $C$ lies in $C\ip{n}$, so $|C\ip{n}|>0$, so
 $|U\ip{n}|>0$.  If $x$ is any element of $U\ip{n}$ then $x$ generates
 a cyclic subgroup of $U$ of order $n$, which must therefore be $U$
 itself.  Thus $U$ is cyclic as claimed.
\end{proof}

\begin{remark}\lbl{rem-classify}
 We have chosen to give a proof that does not depend on the
 classification of finite abelian groups.  Readers who are familiar
 with that classification may prefer to proceed as follows.  The
 general theory implies that there is a unique sequence
 $d_1,\dotsc,d_r$ of integers with $d_k>0$ and $d_1|d_2|\dotsb|d_r$,
 such that $U$ is isomorphic to $\prod_{k=1}^rC_{d_k}$.  In
 particular, $U$ is cyclic if and only if $r=1$, so we must show that
 this is the case.  As $d_1$ divides $d_k$ for all $k$, we see that
 each cyclic factor $C_{d_k}$ contains a copy of $C_{d_1}$, and thus
 $U[d_1]\simeq C_{d_1}^r$ and $|U[d_1]|=d_1^r$.  By assumption we have
 $|U[d_1]|\leq d_1$, so we must have $r=1$ as required.
\end{remark}

\begin{corollary}\lbl{cor-units-cyclic}
 If $K$ is a finite field of order $q$ then $K^\tm$ is cyclic of order
 $q-1$.
\end{corollary}
\begin{proof}
 This is immediate from Proposition~\ref{prop-units-cyclic}.
\end{proof}

We now pause to justify the claims made in Example~\ref{eg-finite-misc}.
\begin{proposition}\lbl{prop-Fpi}
 Let $p$ be a prime.  Then $\F_p[i]$ is a field if and only if
 $p=3\pmod{4}$. 
\end{proposition}
\begin{proof}
 We first dispose of the case $p=2$.  There $p\neq 3\pmod{4}$, and the
 ring $\F_2[i]=\{0,1,i,1+i\}$ is not a field because the element $1+i$
 has no inverse.  From now on we assume that $p$ is odd, so either
 $p=1\pmod{4}$ or $p=3\pmod{4}$.  We will say that $p$ is \emph{bad}
 if $\F_p[i]$ is not a field.  We must show that $p$ is bad if and
 only if $p=1\pmod{4}$.

 We next claim that $p$ is bad if and only if there is an element
 $a\in\F_p$ with $a^2=-1$.  Indeed, if there exists such an $a$ then
 we have $a+i,a-i\neq 0$ but $(a+i)(a-i)=a^2-i^2=(-1)-(-1)=0$ so
 $\F_p[i]$ is not a field, so $p$ is bad.  On the other hand, if there
 is no such $a$ then the polynomial $f(x)=x^2+1$ has no roots in
 $\F_p[x]$ and so is irreducible (because any nontrivial factor would
 have to have degree one).  It therefore follows that $\F_p[x]/f(x)$
 is a field, which is easily seen to be isomorphic to $\F_p[i]$; so
 $p$ is good.

 Next, Corollary~\ref{cor-units-cyclic} tells us that $\F_p^\tm$ is a
 cyclic group of order $p-1$.  If $p$ is bad then there is an element
 $a$ with $a^2=-1$ so the subgroup generated by $a$ is
 $\{1,a,-1,-a\}$, which has order $4$.  It follows by Lagrange's
 theorem that $p-1$ is divisible by $4$, so $p=1\pmod{4}$.
 Conversely, suppose that $p=1\pmod{4}$, so $(p-1)/4$ is an integer.
 Choose a generator $b$ for the cyclic group $\F_p^\tm$, and put
 $a=b^{(p-1)/4}$.  The powers $1,b,\dotsc,b^{p-2}$ are then distinct,
 so we see that $a^2=b^{(p-1)/2}\neq 1$ but $a^4=b^{p-1}=1$.  This
 means that $(a^2+1)(a^2-1)=a^4-1=0$ but $a^2-1\neq 0$ so $a^2+1=0$,
 which implies that $p$ is bad.
\end{proof}

\begin{proposition}\lbl{prop-factor}
 Let $K$ be a finite field of order $q=p^r$.  Then 
 $\prod_{\al\in K}(x-\al)=x^q-x$.
\end{proposition}
\begin{proof}
 We have $|K^\tm|=q-1$, so for all $\al\in K^\tm$ we have $\al^{q-1}=1$.
 It follows that for all $\al\in K$ we have $\al^q-\al=0$.  Thus the
 elements of $K$ give $q$ distinct roots of $x^q-x$, and it follows
 that $x^q-x=\prod_\al(x-\al)$.
\end{proof}

\begin{proposition}\lbl{prop-unique}
 Let $K$ and $L$ be fields of order $q=p^n$.  Then $K\simeq L$.
\end{proposition}
\begin{proof}
 We have seen that $K^\tm$ is cyclic, generated by some element $\al$,
 say.  We then have a surjective homomorphism $\ep\:\F_p[x]\xra{}K$
 given by $x\mapsto\al$.  Let $f(x)$ be the minimal polynomial of
 $\al$ over $\F_p$, or in other words, the monic generator of
 $\ker(\ep)$.  Then $\al$ induces an isomorphism
 $\ov{\ep}\:\F_p[x]/f(x)\xra{}K$.  Moreover, $f(x)$ is non-constant
 and divides $x^q-x$, which factors in $L[x]$ as
 $\prod_{\bt\in L}(x-\bt)$.  It follows that $f(\bt)=0$ for some
 $\bt\in L$.  We can therefore define $\phi\:\F_p[x]/f(x)\xra{}L$ by
 $\phi(x)=\bt$.  Now the map $\psi=\phi\circ\ov{\ep}^{-1}\:K\xra{}L$
 is a homomorphism of fields, and so is injective.  As $|K|=|L|=q$, it
 follows that $\psi$ must be a bijection, and thus an isomorphism.
\end{proof}

\begin{proposition}\lbl{prop-finite-subfield}
 Let $L$ be a field of order $p^{rs}$.  Then the subset
 $K=\{a\in L\st a^{p^r}=a\}$ is a subfield of $L$, and is the unique
 subfield of order $p^r$.  Moreover, we have $[L:K]=s$.
\end{proposition}
\begin{proof}
 Using Remark~\ref{rem-frobenius-powers} we see that
 $K=\{a\in L\st\sg^r(a)=a\}=L^{\{\sg^r\}}$, which is a subfield by
 Proposition~\ref{prop-fixed-subfield}.   Next, put
 $f_k(t)=t^{p^k}-t$, so that $K$ is the set of roots of $f_r(t)$ in
 $L$, whereas $f_{rs}(t)=\prod_{\al\in L}(t-\al)$.   We claim that
 $f_r(t)$ divides $f_{rs}(t)$.  To see this, consider the standard
 identity  
 \[ u^m-1 = (u-1)(1+u+\dotsb+u^{m-1})=(u-1)\sum_{i=0}^{m-1}u^i. \]
 Put $u=t^{p^r-1}$ and 
 \[ m = \frac{p^{rs}-1}{p^r-1} = 1+p^s+p^{2s}+\dotsb+p^{(r-1)s}\in\N
 \]
 so that $u^m=t^{p^{rs}-1}$; we find that $t^{p^{rs}-1}-1$ is
 divisible by $t^{p^r-1}-1$, and we can multiply by $t$ to see that
 $f_{rs}(t)$ is divisible by $f_r(t)$ as claimed.  As $f_{rs}(t)$
 splits in $L$ and has distinct roots, we see from
 Proposition~\ref{prop-split-factor} that $f_r(t)$ is also split and
 has distinct roots.  This means that the number of roots of $f_r(t)$
 is precisely equal to its degree, so $|K|=p^r$.  Now if $K'$ is any
 other subfield of order $p^r$ we can apply
 Proposition~\ref{prop-factor} to $K'$ to see that $K'$ is the set of
 roots of $f_r(t)$, so $K'=K$.  

 Finally, put $t=[L:K]=\dim_K(L)$, which means that $L$ is isomorphic
 to $K^t$ as vector spaces over $K$.  We have $|K^t|=|K|^t=p^{rt}$
 whereas $|L|=p^{rs}$; it follows that $t=s$ as claimed.
\end{proof}

\begin{corollary}\lbl{cor-finite-galois}
 If $K$ and $L$ are as in Proposition~\ref{prop-finite-subfield} then
 $L$ is normal over $K$ and $G(L/K)$ is cyclic of order $s$, generated
 by $\sg^r$. 
\end{corollary}
\begin{proof}
 First, we have seen that $L$ is the set of roots of the polynomial
 $f_{rs}(t)=t^{p^{rs}}-t\in\F_p[t]\sse K[t]$, so it is the splitting
 field over $K$ of that polynomial, so it is normal over $K$.  It
 follows as in Lemma~\ref{lem-splitting-ext} that $|G(L/K)|=[L:K]=s$.
 Next, we have seen that $L^\tm$ is cyclic, of order $p^{rs}-1$.
 Choose an element $\bt$ that generates $L^\tm$, so $L^\tm$ consists
 of the powers $\bt^i$ for $0\leq i<p^{rs}-1$ and these are all
 distinct.  In particular, we see that the powers
 $\sg^j(\bt)=\bt^{p^j}$ are all distinct for $0\leq j<rs$, so the
 automorphisms $\sg^j$ are all different for $j$ in this range.  On
 the other hand, we have seen that every element $\gm\in L$ has
 $\gm^{p^{rs}}=\gm$ and so $\sg^{rs}=1$.  It follows that $\sg$
 generates a cyclic subgroup of $G(L/\F_p)$ of order precisely $rs$.
 Now let $H$ be the set of powers $\sg^{rk}$ for $0\leq k<s$, so
 $|H|=s$.  By the definition of $K$ we have $\sg^r|_K=1_K$ so every
 element of $H$ acts as the identity on $K$, so $H\sse G(L/K)$, but
 $|H|=s=|G(L/K)|$ so we must have $G(L/K)=H$ as claimed.
\end{proof}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-cyclic-five}
 Show that there exists a finite field $K$ such that $K^\tm$ contains
 a cyclic group of order $5$, but that there is no finite field $K$
 such that $K^\tm$ itself is cyclic of order $5$.
\end{exercise}
\begin{solution}
 By the general theory of finite fields, we see that $\F_{11}^\tm$ is
 cyclic of order $10$, generated by some element $\al$ say.  It
 follows that the subgroup generated by $\al^2$ is cyclic of order
 $5$.  

 In general, if $K$ is a finite field then $|K^\tm|+1=|K|$, which is a
 power of a prime.  As $5+1$ is not a power of a prime, we see that
 $|K^\tm|$ cannot be $5$, so $K^\tm$ cannot be isomorphic to $C_5$.
\end{solution}
\begin{exercise}\exlabel{ex-F-nine}
 Factorise the polynomial $\vph_8(t)=t^4+1$ in $\F_3[t]$ (by trial and
 error, if necessary).  Use this to construct two different fields of
 order $9$.  Show explicitly that they are both isomorphic to
 $\F_3[i]$ (and thus to each other).
\end{exercise}
\begin{solution}
 In $\F_3$ we have $\vph_8(0)=1\neq 0$ and $\vph_8(\pm 1)=2=-1\neq 0$,
 so $\vph_8(t)$ has no roots in $\F_3$, and thus has no factors of
 degree one in $\F_3[t]$.  Thus, the only way it can factor is as the
 product of two quadratic polynomials, say
 \[ t^4+1 = (t^2+at+b)(t^2+ct+d) = 
     t^4+(a+c)t^3+(b+d+ac)t^2+(ad+bc)t+bd.
 \]
 By comparing coefficients we get 
 \begin{align*}
  a+c &= 0 \\
  b+d+ac &= 0 \\
  ad+bc &= 0 \\
  bd &= 1.
 \end{align*}
 The last equation shows that $b\neq 0$, so $b=\pm 1$, so $b^2=1$.  We
 can thus multiply the last equation by $b$ to see that $d=b$.  On the
 other hand, the first equation gives $c=-a$.  Substituting these into
 the second equation and rearranging gives $b=-a^2$.  Here
 $a\in\{0,1,-1\}$ so $-a^2\in\{0,-1\}$ but we already know that
 $d=b\neq 0$ so $d=b=-1$.  As $b=-a^2$ we have $a\in\{1,-1\}$, and we
 have seen that $c=-a$.  We can arbitrarily choose to take $a=1$ and
 then $c=-1$, so we have the factorisation
 \[ \vph_8(t)=t^4+1=(t^2+t-1)(t^2-t-1) \in F_3[t]. \]
 This gives two fields of order 9:
 \begin{align*}
  K &= \F_3[\al]/(\al^2+\al-1) \\
  L &= \F_3[\bt]/(\bt^2-\bt-1).
 \end{align*}
 Now consider the field $\F_3[i]$ and the group 
 \[ \F_3[i]^\tm = \{ 1,-1,i,-i,1+i,1-i,-1+i,-1-i\} \simeq C_8. \]
 The elements $1,-1,i$ and $-i$ are the roots of $t^4-1$, so the
 remaining elements are roots of $(t^8-1)/(t^4-1)=t^4+1=\vph_4(t)$.
 One checks that the elements $1\pm i$ are roots of $t^2+t-1$, and the
 elements $-1\pm i$ are roots of $t^2-t-1$.  There is thus a unique
 isomorphism $\phi\:K\to\F_3[i]$ with $\phi(\al)=1+i$, and a unique
 isomorphism $\psi\:L\to\F_3[i]$ with $\psi(\bt)=-1-i=-\phi(\al)$.  It
 follows that the composite isomorphism $\psi^{-1}\phi\:K\to L$ sends
 $\al$ to $-\bt$.  
\end{solution}
\begin{exercise}\exlabel{ex-F-twentyfive}
 Let $K$ be the set of all matrices of the form
 $\bsm a+b&b\\ 2b&a+b\esm$ with $a,b\in\F_5$.  Prove that $K$ is a
 field of order $25$.
\end{exercise}
\begin{solution}
 Put $\al=\bsm 1&1\\2&1\esm$, and identify each element $a\in\F_5$
 with the matrix $aI=\bsm a&0\\ 0&a\esm$.  The set $K$ then consists
 of all matrices $a+b\al$ with $a,b\in\F_5$.  It is clear that this is
 a vector space of dimension two over $\F_5$, and so has order
 $5^2=25$.  Next, observe that 
 \begin{align*}
  \al^2 &= \bsm 1&1\\ 2&1\esm \bsm 1&1\\ 2&1\esm 
         = \bsm 3&2 \\ 4&3 \esm \\
  2\al+1 &= 2\bsm 1&1\\ 2&1\esm + \bsm 1&0\\ 0&1\esm 
          = \bsm 3&2 \\ 4&3 \esm = \al^2.
 \end{align*}
 It follows that 
 \begin{align*}
  (a+b\al)(c+d\al) &= 
    ac+(ad+bc)\al+bd\al^2 = ac+(ad+bc)\al+bd(2\al+1) \\
    &= (ac+bd)+(ad+bc+2bd)\al \in K, 
 \end{align*}
 so $K$ is closed under multiplication.  We also see from the above
 formulae that $(a+b\al)(c+d\al)=(c+d\al)(a+b\al)$, so multiplication
 in $K$ is commutative.  The remaining parts of
 Definition~\ref{defn-field}(b) are standard properties of matrix
 addition and multiplication.  We therefore see that $K$ is a
 commutative ring.  All that is left is to check that it is a field.
 To see this, put $f(x)=x^2-2x-1\in\F_5[x]$, so $f(\al)=0$, so there
 is a unique homomorphism $\phi$ from the ring $K'=K[x]/f(x)$ to $K$
 with $\phi(x+K[x]f(x))=\al$.  We also have
 \begin{align*}
  f(0) &= -1 \\
  f(1) &= -2 \\
  f(2) &= -1 \\
  f(3) &= 2 \\
  f(4) &= 2
 \end{align*}
 so $f(x)$ has no roots in $\F_5$.  As it is quadratic and has no
 roots, it must be irreducible, so $K'$ is a field.  As $1,x$ gives a
 basis for $K'$ over $\F_5$, and $1,\al$ gives a basis for $K$ over
 $\F_5$, we see that $\phi$ is an isomorphism.  This means that $K$ is
 also a field. 
\end{solution}
\begin{exercise}\exlabel{ex-cyclic-galois}
 Let $p$ be a prime.  Prove that the Galois group $G(\Q(\mu_p)/\Q)$ is
 cyclic of order $p-1$.
\end{exercise}
\begin{solution}
 Proposition~\ref{prop-cyclotomic-galois} tells us that
 $G(\Q(\mu_p)/\Q)$ is isomorphic to $(\Z/p\Z)^\tm=\F_p^\tm$, which is
 cyclic of order $p-1$ by Corollary~\ref{cor-units-cyclic}.
\end{solution}

\begin{exercise}\exlabel{ex-seven-cubed}
 Find a generator for the cyclic group $\F_7^\tm$. Deduce that $t^3-3$
 is irreducible in $\F_7$.  This means that we can construct
 $\F_{7^3}$ as $\F_7[\al]/(\al^3-3)$.  Show that although $\al$ is a
 primitive element for $\F_{7^3}$, it does not generate
 $\F_{7^3}^\tm$.
%, nor does it give a normal basis for $\F_{7^3}$ over $\F_7$. 
\end{exercise}
\begin{solution}
 We have $\F_7^\tm=\{-3,-2,-1,1,2,3\}$, and we check that 
 \[ 3^0 =  1 \qquad 3^1 =  3 \qquad 3^2=2 \qquad
    3^3 = -1 \qquad 3^4 = -3 \qquad 3^5 = -2.
 \]
 It follows that $\F_7^\tm$ is a cyclic group of order $6$, generated
 by $3$.  It follows that for every $a\in\F_7^\tm$ we have $a^6=1$, so
 $(a^3)^2=1$.  Thus, if $b^2\neq 1$ then $b$ is not the cube of any
 element in $\F_7^\tm$.  In particular, $3$ is not a cube.  (We could
 also have checked this by just writing out the cubes of all
 elements.)  Thus, the polynomial $f(t)=t^3-3$ has not roots in
 $\F_7$.  Any nontrivial factorisation would have to involve a
 quadratic term and a linear term, which would thus give a root; so
 $f(t)$ must be irreducible.  We therefore have a field
 $K=\F_7[\al]/(\al^3-3)$ of order $7^3=343$.  Now $\al^3=3$ and
 $3^6=1$, so $\al^{18}=1$, but the whole group $K^\tm$ has order
 $342$, so $\al$ does not generate $K^\tm$.  

 % Finally, recall (from the general theory of finite fields) that
 % $G(K/\F_7)=\{1,\sg,\sg^2\}$, where $\sg(x)=x^7$.  As $\al^3=3$ we
 % have $\sg(\al)=\al^7=(\al^3)^2\al=9\al=2\al$, and so
 % $\sg^2(\al)=\sg(2\al)=4\al$.  It follows that
 % $\al,\sg(\al),\sg^2(\al)$ is not a basis for $K$ over $\F_7$, so
 % $\al$ does not give rise to a normal basis.
\end{solution}

\begin{exercise}\exlabel{ex-factor-mod-five}
 Show that the polynomial $f(x)=x^6-2\in\F_5[x]$ can be written as 
 $f(x)=g_1(x)g_2(x)g_3(x)$, where each $g_i(x)$ is an irreducible
 quadratic polynomial.  Show that if $\al$ is a root of $g_i(x)$ in
 some field $K\supset\F_5$, then $\al$ generates a subgroup of $K^\tm$
 whose order is either $8$ or $24$.
\end{exercise}
\begin{solution}
 We first remark that $\F_5=\{-2,-1,0,1,2\}$, with $(\pm 1)^2=1$ and
 $(\pm 2)^2=4=-1$.  It follows that $2$ is a generator of $\F_5^\tm$.
 We also see that $2^3=8=-2$, so we can write 
 \[ f(x) = (x^2)^3 + 2^3 = (x^2+2)(x^4-2x^2+4) 
     = (x^2+2)(x^4-2x^2-1).
 \]
 We can thus take $g_1(x)=x^2+2$.  For the other two factors, suppose
 that $g_2(x)=x^2+ax+b$ and $g_3(x)=x^2+cx+d$.  We should then have 
 \[ x^4-2x^2-1 = g_2(x)g_3(x) = 
     x^4 + (a+c)x^3 + (b+d+ac) x^2 + (ad+bc)x +bd.
 \]
 By comparing coefficients, we get
 \begin{align*}
  a+c &= 0 \\
  b+d+ac &= -2 \\
  ad+bc &= 0 \\
  bd &= -1.
 \end{align*}
 If $a=0$ then these equations reduce to $c=0$ and $d=-2-b$ and
 $bd=-1$.  By checking through the five possible values of $b$, we see
 that these equations are inconsistent.  Thus, we must have
 $a\neq 0$.  The first equation gives $c=-a$, and we can feed this
 into the third equation to get $a(d-b)=0$, but $a\neq 0$ so $d=b$.
 The last equation now says that $b^2=-1$, and it follows that
 $b=\pm 2$.  The second equation can now be rearranged as $a^2=2b+2$.
 If $b=-2$ this gives $a^2=-2$, but $-2$ is not a square in $\F_5$, so
 this is impossible.  If $b=2$ then we get $a^2=6=1$, so $a=\pm 1$.
 We should therefore take 
 \begin{align*}
  g_2(x) &= x^2 + x + 2 \\
  g_3(x) &= x^2 - x + 2.
 \end{align*}
 One can then check directly that $f(x)=g_1(x)g_2(x)g_3(x)$ as
 expected.  

 Note that $2$ is not a square in $\F_5$, so it is certainly not a
 sixth power, so $f(x)$ has no roots in $\F_5$.  It follows that
 $g_i(x)$ has no roots, and a quadratic with no roots is irreducible,
 so the three factors $g_i(x)$ are irreducible as claimed.

 Now suppose we have an extension field $K$ and an element $\al\in K$
 with $g_i(\al)=0$.  Let $d$ be the multiplicative order of $\al$, so
 we have $\al^m=1$ if and only if $m$ is divisible by $d$.  As
 $g_i(x)$ is a factor of $f(x)$ we see that $f(\al)=0$, so $\al^6=2$,
 so $\al^{12}=4=-1$ and $\al^{24}=1$.  It follows that $d$ divides
 $24$ but $d$ does not divide $12$; the only possibilities are $d=8$
 or $d=24$.  In fact, if $g_1(\al)=0$ then $\al^2=-2$ and it follows
 easily that $\al^8=1$, so $d=8$.  On the other hand, if $g_2(\al)=0$
 or $g_3(\al)=0$ then $\al^8=\al^6\al^2=2\al^2=2(\pm\al-2)\neq 1$, so
 $d$ must be $24$.
\end{solution}

\begin{exercise}\exlabel{ex-Fpp}
 Consider the polynomial $f(x)=x^p-x-1\in\F_p[x]$, and suppose we have
 a finite field $K=\F_p(\al)$ with $f(\al)=0$.  Prove that
 $\al^{p^k}\neq\al$ for $0<k<p$.  Deduce that $|K|=p^p$ and that
 $f(x)$ is irreducible over $\F_p$.
\end{exercise}
\begin{solution}
 As $f(\al)=0$ we have $\al^p=\al+1$.  We can raise this to the $p$th
 power (remembering that $(x+y)^p=x^p+y^p\pmod{p}$) to get
 $\al^{p^2}=\al^p+1$, and then use $\al^p=\al+1$ again to get
 $\al^{p^2}=\al+2$.  By continuing in the same way, we find that
 $\al^{p^k}=\al+k$ for all $k$.  In particular, for $0<k<p$ this gives
 $\al^{p^k}\neq\al$.  

 Now let $g(x)$ be the minimal polynomial of $\al$ over $\F_p$, which
 is an irreducible factor or $f(x)$.  If $g(x)$ has degree $d$, we
 have $|K|=p^d$.  By the general theory of finite fields, we have
 $a^{p^d}=a$ for all $a\in K$.  In particular $\al^{p^d}=\al$, so by
 our first paragraph we must have $d\geq p$.  On the other hand,
 $g(x)$ divides $f(x)$ and $f(x)$ has degree $p$, so we must have
 $d\leq p$.  We deduce that $d=p$ and $f(x)=g(x)$, so $f(x)$ is
 irreducible. 
\end{solution}

\begin{exercise}\exlabel{ex-closed-infinite}
 Prove that every algebraically closed field is infinite.
\end{exercise}
\begin{solution}
 Let $K$ be a finite field.  We then have $|K|=p^d$, for some prime
 $p$ and $d>0$.  We have seen that $a^{p^d}=a$ for all $a\in K$.  Put
 $f(x)=x^{p^d}-x+1\in K[x]$, so $f(a)=1$ for all $a\in K$.  It follows
 that $f(x)$ has no roots in $K$, so $K$ is not algebraically closed. 
\end{solution}

\section{Multiquadratic extensions}
\label{sec-mquad}

We will next discuss another extended example, extending
Proposition~\ref{prop-biquadratic} and related to
Corollary~\ref{cor-mquad-cyclotomic}.  

Let $p_1,\dotsc,p_n$ be distinct prime numbers.  For any subset
$T\sse\{1,\dotsc,n\}$, put $r_T=\prod_{i\in T}\sqrt{p_i}$.  For the
case where $T$ is the empty set, this should be interpreted as
$r_\emptyset=1$.  We will allow ourselves to write 
$r_{245}$ rather than $r_{\{2,4,5\}}$ and so on.

Let $K(m)$ be the $\Q$-linear span of all the
numbers $r_T$ for $T\sse\{1,\dotsc,m-1\}$.  For example:
\begin{itemize}
 \item $K(0)$ should be interpreted as $\Q$.
 \item $K(1)$ is the set of all real numbers that can be written as
  $a_\emptyset+a_1\sqrt{p_1}$ for some rational numbers
  $a_\emptyset,a_1\in\Q$. 
 \item $K(2)$ is the set of all real numbers that can be written as
  \[ a_\emptyset+a_1\sqrt{p_1}+a_2\sqrt{p_2}+a_{12}\sqrt{p_1p_2} \]
  for some rational numbers $a_\emptyset,a_1,a_2,a_{12}\in\Q$.
 \item In general, $K(m)$ could also be described as
  $\Q(\sqrt{p_1},\dotsc,\sqrt{p_m})$.  
\end{itemize}
We will call fields of this type \emph{multiquadratic} extensions of
$\Q$. 

Our main result in this section is as follows:
\begin{theorem}\lbl{thm-mquad}
 \begin{itemize}
  \item[(a)] $K(m)$ is a subfield of $\R$.
  \item[(b)] The elements $\{r_T\st T\sse\{1,\dotsc,m\}\}$ form a
   basis for $K(m)$ over $\Q$ (so $K(m)$ has degree $2^m$ over $\Q$).
  \item[(c)] If $u\in K(m)$ and $u^2\in\Q$ then $u=u_Tr_T$ for some
   $T\sse\{1,\dotsc,m\}$ and $u_T\in\Q$.
 \end{itemize}
\end{theorem}

We pause to explore the meaning of this a little.  Firstly, you can
check that 
\[ 2 - 3 \sqrt{2} + 4\sqrt{3} -\sqrt{2}\sqrt{3} - \sqrt{5} = 
    0.000004822873256233\dotsc \simeq 0.
\]
Could there be any ``coincidental'' relationship between square roots
that holds \emph{exactly}?  Part~(b) of the theorem says that this is
impossible.  Next, suppose we have a nonzero real number $a$ that can
be expressed in terms of the square roots of certain primes.  The
hardest part of part~(a) of the Theorem tells us that $1/a$ can also
be expressed in terms of the square roots of the same primes.  For
example, if $a$ is the small number mentioned above,
\[ a = 2 - 3 \sqrt{2} + 4\sqrt{3} -\sqrt{2}\sqrt{3} - \sqrt{5} \]
it works out that
\[ a^{-1} = 
   25918+18327\,\sqrt{2}+14964\,\sqrt{3}+10581\,\sqrt{2}\sqrt{3}+
   11591\,\sqrt{5}+8196\,\sqrt{2}\sqrt{5}+6692\,\sqrt{3}\sqrt{5}+
   4732\,\sqrt{2}\sqrt{3}\sqrt{5}.
\]

We now prove some preliminary results, which will lead in to the proof
of Theorem~\ref{thm-mquad}.
\begin{lemma}\lbl{lem-prod}
 If $T,U\sse\{1,\dotsc,m\}$ then $r_Tr_U\in K(m)$.  More precisely, if 
 $W=T\cap U$ and $V=(T\cup U)\sm W$ and $w=\prod_{i\in W}p_i\in\Q$
 then $r_Tr_U=wr_V$.
\end{lemma}
\begin{proof}
 If $i\in W$ then $\sqrt{p_i}$ occurs in both $r_T$ and $r_U$ giving a
 factor of $p_i$ in $r_Tr_U$.  If $i\in V$ then $\sqrt{p_i}$ occurs
 either in $r_T$ or in $r_U$ but not both, giving a factor of
 $\sqrt{p_i}$ in $r_Tr_U$.  Thus, we have $r_Tr_U=wr_V$.  As $K(m)$
 was defined to be the $\Q$-linear span of a set of elements including
 the element $r_V$, it follows that $r_Tr_U\in K(m)$.
\end{proof}

\begin{lemma}\lbl{lem-mquad-subring}
 $K(m)$ is a subring of $\R$.
\end{lemma}
\begin{proof}
 We must show that $K(m)$ contains $0$ and $1$ and that it is closed
 under addition, subtraction and multiplication.  Note that $K(m)$ was
 defined as a span, so it is certainly a $\Q$-linear subspace of $\R$,
 so it contains $0$ and is closed under addition and subtraction and
 under multiplication by elements of $\Q$.  We can think of $1$ as
 $r_\emptyset$, so we also have $1\in K(m)$.  Now consider elements
 $a,b\in K(m)$.  From the definition of $K(m)$, we can write
 $a=\sum_Ta_Tr_T$ and $b=\sum_Ub_Ur_U$ for some numbers
 $a_T,b_U\in\Q$.  It follows that 
 \[ ab = \sum_{T,U} a_Tb_U r_Tr_U. \]
 Here $r_Tr_U\in K(m)$ by Lemma~\ref{lem-prod}, and $a_Tb_U$ is just a
 rational number, so $a_Tb_Ur_Tr_U\in K(m)$.  Moreover, $K(m)$ is
 closed under addition, so $\sum_{T,U}a_Tb_Ur_Tr_U\in K(m)$, or in
 other words $ab\in K(m)$.  Thus $K(m)$ is closed under
 multiplication, as required.
\end{proof}

We could now use Proposition~\ref{prop-subring-subfield} to show that
$K(m)$ is a subfield of $\R$.  However, we will instead give a more
direct and elementary argument, which might be considered more
illuminating. 

\begin{lemma}\lbl{lem-not-square}
 Suppose that $T\sse\{1,\dotsc,m-1\}$ and $u_T\in\Q$.  Then
 $(u_Tr_T)^2\neq p_m$.
\end{lemma}
\begin{proof}
 Suppose that $(u_Tr_T)^2=p_m$; we will derive a contradiction.
 Clearly we must have $u_T\neq 0$, so we can write $u_T=\pm u/v$,
 where $u$ and $v$ are positive integers with no common factors.  We
 then have 
 \[ p_m=(u_Tr_T)^2 = u^2r_T^2/v^2=u^2v^{-2}\prod_{i\in T}p_i, \]
 so 
 \[ p_mv^2 = u^2\prod_{i\in T}p_i. \]
 This is now an equation in $\Z$; it implies that $p_m$ divides
 $u^2\prod_Tp_i$.  By assumption the primes $p_i$ on the right hand
 side are all different from $p_m$, so $p_m$ must divide $u$ instead.
 We can write $u=p_mw$ and rearrange to get
 \[ v^2 = p_mw^2\prod_{i\in T}p_i. \]
 Here the right hand side is divisible by $p_m$, so the left hand side
 must be divisible by $p_m$, so $v$ must be divisible by $p_m$.  This
 contradicts the fact that $u$ and $v$ have no common factors.
\end{proof}

\begin{lemma}\lbl{lem-step}
 Suppose that Theorem~\ref{thm-mquad} holds for $K(m-1)$, and that
 $b,c\in K(m-1)$.  Put $a=b+c\sqrt{p_m}$ and $a'=b-c\sqrt{p_m}$, so
 $a,a'\in K(m)$.  Then 
 \begin{itemize}
  \item $aa'=b^2-c^2p_m\in K(m-1)$
  \item If $aa'=0$ then $b=c=0$ and so $a=0$.
  \item If $aa'\neq 0$ then $1/a\in K(m)$.
 \end{itemize}
\end{lemma}
\begin{proof}
 It is simple algebra to check that $aa'=b^2-c^2p_m$.  As
 $b,c\in K(m-1)$ and $p_m\in\Z$ it follows that $aa'\in K(m-1)$.  Now
 suppose that $aa'=0$, so $b^2=c^2p_m$.  Suppose that $c$ is nonzero,
 so $p_m=(b/c)^2$.  By assumption $K(m-1)$ is a field, so the element
 $u=b/c$ lies in $K(m-1)$, and $u^2=p_m\in\Q$.  Part~(c) of
 Theorem~\ref{thm-mquad} tells us that $u=u_Tr_T$ for some
 $T\sse\{1,\dotsc,m-1\}$ and $u_T\in\Q$, so $(u_Tr_T)^2=p_m$.
 Lemma~\ref{lem-not-square} tells us that this is impossible.  This
 contradiction means that we must in fact have $c=0$.  We also have
 $b^2=c^2p_m$, so it follows that $b=0$ as well.

 Now suppose instead that the element $aa'$ is nonzero.  As $K(m-1)$
 is a field and $aa'\in K(m-1)$ it follows that
 $(aa')^{-1}\in K(m-1)\sse K(m)$.  As $K(m)$ is a subring of $\R$ and 
 $a', (aa')^{-1}\in K(m)$ it follows that $a'.(aa')^{-1}\in K(m)$; but
 $a'.(aa')^{-1}=a^{-1}$, so $a^{-1}\in K(m)$ as claimed.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm-mquad}]
 We can assume by induction that the theorem holds for $K(m-1)$ (as
 the initial case of $K(0)$ is trivial).  

 \begin{itemize}
  \item[(b)] The elements $r_T$ span $K(m)$ by definition, so we need
   only show that they are linearly independent.  Suppose we have
   rational numbers $a_T$ for all $T\sse\{1,\dotsc,m\}$, giving an
   element $a=\sum_Ta_Tr_T\in K(m)$.  We must show that if $a=0$, then
   the individual coefficients $a_T$ are all zero.  We put 
   \begin{align*}
    b &= \sum_{U\sse\{1,\dotsc,m-1\}} a_Ur_U \in K(m-1) \\
    c &= \sum_{U\sse\{1,\dotsc,m-1\}} a_{U\cup\{m\}}r_U \in K(m-1)
   \end{align*}
   so that $a=b+c\sqrt{p_m}$.  We then put $a'=b-c\sqrt{p_m}$ as in
   Lemma~\ref{lem-step}.  If $a=0$ then certainly $aa'=0$ so the Lemma
   tells us that $b=c=0$.  As $b=0$ we have
   $\sum_{U\sse\{1,\dotsc,m-1\}}a_Ur_U=0$ but the set $\{r_U\st
   U\sse\{1,\dotsc,m-1\}\}$ is linearly independent by our inductive
   assumption, so we must have $a_U=0$ for all
   $U\sse\{1,\dotsc,m-1\}$.  By applying the same logic to $c$, we see
   that $a_{U\cup\{m\}}$ is also zero for all
   $U\sse\{1,\dotsc,m-1\}$.  These two cases cover all the
   coefficients $a_T$, so $a_T=0$ for all $T\sse\{1,\dotsc,m\}$, as
   required.
  \item[(a)] We showed in Lemma~\ref{lem-mquad-subring} that $K(m)$ is a
   subring of $\R$, so all that is left is to show that if $a\in K(m)$
   is nonzero then $a^{-1}$ is also in $K(m)$.  We can write it as
   $a=b+c\sqrt{p_m}$ and put $a'=b-c\sqrt{p_m}$, just as before.  If
   $aa'=0$ then Lemma~\ref{lem-step} tells us that $a=0$, contrary to
   assumption.  Thus $aa'\neq 0$ and the other part of
   Lemma~\ref{lem-step} tells us that $a^{-1}\in K(m)$, as required.
  \item[(c)] Suppose that $u\in K(m)$ and $u^2=q\in\Q$.  Just as above,
   we can write $u=x+y\sqrt{p_m}$ with $x,y\in K(m-1)$.  It follows
   that $(x^2+p_my^2-q)+2xy\sqrt{p_m}=u^2-q=0$.  Here $x^2+p_my^2-q$
   and $2xy$ are in $K(m-1)$, and it follows easily from part~(a) that
   $\{1,\sqrt{p_m}\}$ is a basis for $K(m)$ over $K(m-1)$.  We must
   therefore have $x^2+p_my^2-q=0$ and $2xy=0$, so either $x=0$ or
   $y=0$. 

   Suppose that $y=0$, so the equation $x^2+p_my^2-q=0$ reduces to
   $u^2=x^2=q$.  This means that $u\in K(m-1)$ and $u^2\in\Q$, so
   part~(c) of the theorem for $K(m-1)$ tells us that $u=u_Tr_T$ for
   some $T\sse\{1,\dotsc,m-1\}$ and $u_T\in\Q$, as required.

   Suppose instead that $x=0$, so $y^2=q/p_m$ with $y\in K(m-1)$ and
   $y^2\in\Q$.  It follows that $y=y_Tr_T$ for some
   $T\sse\{1,\dotsc,m-1\}$ and $y_T\in\Q$, so
   $u=y\sqrt{p_m}=y_Tr_{T\cup\{m\}}$, which again has the required form. 
 \end{itemize}
\end{proof}

We next examine the Galois groups of multiquadratic extensions.
\begin{proposition}\lbl{prop-mquad-galois}
 For $i=1,\dotsc,m$ there is an automorphism $\tau_i$ of $K(m)$ with
 $\tau_i(\sqrt{p_1})=-\sqrt{p_i}$ and $\tau_i(\sqrt{p_j})=\sqrt{p_j}$
 for all $j\neq i$.  Moreover, the full Galois group $G(K(m)/\Q)$ is
 the product of all the groups $\{1,\tau_i\}\simeq C_2$, so
 $G(K(m)/\Q)\simeq C_2^m$.
\end{proposition}
\begin{proof}
 As the elements $r_T$ form a basis for $K(m)$, we can certainly
 define a $\Q$-linear map $\tau_i\:K(m)\to K(m)$ by 
 \[ \tau_i(r_T) =
      \begin{cases} -r_T & \text{ if } i\in T \\
                    +r_T & \text{ if } i\not\in T. \end{cases}
 \]
 Note that $\tau_i(0)=0$ and $\tau_i(1)=\tau_i(r_\emptyset)=1$.  Now
 consider a pair of basis elements $r_T,r_U$ with $r_Tr_U=wr_V$ as in
 Lemma~\ref{lem-prod}.  We claim that
 $\tau_i(r_Tr_U)=\tau_i(r_T)\tau_i(r_U)$.  There are four cases to
 consider, depending on whether $i\in T$ or not, and whether $i\in U$
 or not; we leave details to the reader.  Now consider arbitrary
 elements $a,b\in K(m)$, say $a=\sum_Ta_Tr_T$ and $b=\sum_Ub_Ur_U$
 with $a_T,b_U\in\Q$.  We then have 
 \begin{align*}
   \tau_i(ab) &= \tau_i\left(\sum_{T,U}a_Tb_Ur_Tr_U\right) = 
     \sum_{T,U}a_Tb_U\tau_i(r_Tr_U) = 
     \sum_{T,U}a_Tb_U\tau_i(r_T)\tau_i(r_U) \\
   &= \left(\sum_Ta_T\tau_i(r_T)\right)\left(\sum_Ub_U\tau_i(r_U)\right)
     = \tau_i(a)\tau_i(b).
 \end{align*}
 This proves that $\tau_i$ is a homomorphism from $K(m)$ to itself.
 It is clear that $\tau_i^2(r_T)=r_T$ for all $T$, so $\tau_i^2=1$.
 Now suppose that $i\neq j$.  We find that $\tau_i\tau_j(r_T)$ is
 either $+r_T$ (if $\{i,j\}\sse T$ or $\{i,j\}\cap T=\emptyset$) or
 $-r_T$ (if $|\{i,j\}\cap T|=1$).  From this it is clear that
 $\tau_i\tau_j=\tau_j\tau_i$, so the elements $\tau_i$ generate a
 commutative subgroup $T\leq G(K(m)/\Q)$.  For any sequence
 $\ep_1,\dotsc,\ep_m$ in $\{0,1\}$ we have an element
 $\sg_{\ep}=\tau_1^{\ep_1}\dotsb\tau_m^{\ep_m}\in T$.  Note that
 $\sg_\ep(\sqrt{p_i})$ is $+\sqrt{p_i}$ if $\ep_i=0$, and
 $-\sqrt{p_i}$ if $\ep_i=1$.  Using this we see that if
 $\sg_\ep=\sg_\dl$ then $\ep=\dl$.  We thus have $2^m$ different
 elements of $T\sse G(K(m)/\Q)$.  It follows using
 Proposition~\ref{prop-normal} that $K(m)$ is normal over $\Q$ and
 that $T$ is the full Galois group.
\end{proof}

It will be proved as Theorem~\ref{thm-primitive} that every field
extension of finite degree has a primitive element.  It turns out that
there is a nice explicit example of this for multiquadratic fields.
\begin{proposition}\lbl{prop-mquad-primitive}
 If $\tht_n=\sum_{i=1}^n\sqrt{p_i}$ then $\Q(\tht_n)=K(n)$.
\end{proposition}
(I thank Jayanta Manoharmayum for this fact and its proof.)
\begin{proof}
 This is clear for $n=1$, so we may assume inductively that
 $K(n-1)=\Q(\tht_{n-1})$.  We have seen that $K(n)$ has degree $2^n$
 over $\Q$, and $\Q\leq\Q(\tht_n)\leq K(n)$ so the degree of
 $\Q(\tht_n)$ over $\Q$ must have the form $2^m$ for some $m$ with
 $0\leq m\leq n$; we must show that $m=n$.  Let the minimal polynomial
 of $\tht_n$ over $\Q$ be
 \[ f(t) = \sum_{i=0}^{2^m} a_i t^i, \]
 and put 
 \begin{align*}
  g(t) &= \sum_{i=0}^{2^m}
           \left(\sum_{2j\leq 2^m-i} \bcf{i+2j}{2j}p_n^ja_{i+2j}\right) t^i \\
  h(t) &= \sum_{i=0}^{2^m-1}
           \left(\sum_{2j<2^m-i} \bcf{i+2j+1}{2j+1}p_n^ja_{i+2j+1}\right) t^i.
 \end{align*}
 By expanding out the relation $f(\tht_{n-1}+\sqrt{p_n})=f(\tht_n)=0$
 we obtain $g(\tht_{n-1})+h(\tht_{n-1})\sqrt{p_n}=0$, with
 $g(\tht_{n-1}), h(\tht_{n-1})\in K(n-1)$.  We have seen that
 $\{1,\sqrt{p_n}\}$ is a basis for $K(n)$ over $K(n-1)$, so
 $g(\tht_{n-1})=h(\tht_{n-1})=0$.  The coefficient of $t^{2^m-1}$ in
 $h(t)$ is $2^m$, so $h$ is nonzero and has degree precisely $2^m-1$.
 It follows that $2^m-1$ must be at least as large as the degree of
 $\tht_{n-1}$ over $\Q$, which is $2^{n-1}$ by inductive assumption.
 This gives $m>n-1$ but we also had $0\leq m\leq n$, so $m=n$ as required.
\end{proof}


\section{The Galois correspondence}
\label{sec-correspondence}

The following theorem is the main result of Galois theory.
\begin{theorem}\lbl{thm-correspondence}
 Let $M$ be a normal extension of $K$, with Galois group $G=G(M/K)$.
 \begin{itemize}
  \item[(a)] For any subgroup $H\leq G$, the set
   \[ L=M^H=\{a\in M\st \sg(a)=a\text{ for all } \sg\in H\} \]
   is a subfield of $M$ containing $K$, and $M$ is normal over $L$
   with $G(M/L)=H$.
  \item[(b)] For any subfield $L\sse M$ containing $K$, the Galois
   group $H=G(M/L)$ is a subgroup of $G$ and we have $M^H=L$.
  \item[(c)] If $L$ and $H$ are as above, then $L$ is a normal
   extension of $K$ if and only if $H$ is a normal subgroup of $G$,
   and if so, then $G(L/K)=G/H$.
 \end{itemize}
\end{theorem}

This will be proved in three parts, as
Corollary~\ref{cor-correspondence-a},
Proposition~\ref{prop-correspondence-b} and
Proposition~\ref{prop-correspondence-c} below.

\begin{remark}\lbl{rem-correspondence}
 Let $\CL$ be the set of all subfields $L$ with $K\sse L\sse M$.  Let
 $\CH$ be the set of all subgroups of $G$.  We can define
 $\Phi\:\CL\to\CH$ by $\Phi(L)=G(M/L)$, and we can define
 $\Psi\:\CH\to\CL$ by $\Psi(H)=M^H$.  Parts~(a) and~(b) of the theorem
 can be rephrased as saying that $\Phi$ and $\Psi$ are inverse to each
 other, so both are bijections.
\end{remark}

\begin{remark}\lbl{rem-finite-galois}
 Suppose that $K=\F_p$, so that $M$ is also finite, of order $p^n$
 say.  Then $G=G(M/K)$ is cyclic of order $n$, generated by the
 Frobenius automorphism $\sg\:a\mapsto a^p$.  For each divisor $d$ of
 $n$ we have a cyclic subgroup of $G$ of order $d$ generated by
 $\sg^{n/d}$, and these are all the subgroups of $G$.  Given this, all
 the claims in Theorem~\ref{thm-correspondence} follow easily from
 Theorem~\ref{thm-finite-fields}.  The same is true with just a little
 more work if $M$ is finite and $K$ is any subfield of $M$.
\end{remark}

\begin{example}\lbl{eg-even-quartic-galois}
 Consider again the field $K=\Q(\al,\bt)$, where
 $\al=\sqrt{3+\sqrt{7}}$ and $\bt=\sqrt{3-\sqrt{7}}$, as in
 Example~\ref{eg-even-quartic}.  We will make the Galois
 correspondence explicit in this case.  First note that
 $\al^2-3=3-\bt^2=\sqrt{7}$ and $\al\bt=\sqrt{2}$.  It follows using
 this that $(\al+\bt)^2=\al^2+\bt^2+2\al\bt=6+2\sqrt{2}$, and
 $\al+\bt>0$ so $\al+\bt=\sqrt{6+2\sqrt{2}}$.  In the same way we also
 see that $\al-\bt=\sqrt{6-2\sqrt{2}}$.  We also note that
 $\al^2-\bt^2=2\sqrt{7}$, and we can divide this by the equation
 $\al\bt=\sqrt{2}$ to get $\al/\bt-\bt/\al=\sqrt{14}$.

 The subgroups of $D_8$ (other than $\{1\}$ and $D_8$ itself) can be
 listed as follows:
 \begin{align*}
  A_0 &= \{1,\quad (\al\; -\bt)(-\al\;\bt)\} \\
  A_1 &= \{1,\quad (\al\; -\al)\} \\
  A_2 &= \{1,\quad (\al\; \bt)(-\al\;-\bt)\} \\
  A_3 &= \{1,\quad (\bt\; -\bt)\} \\
  Z   &= \{1,\quad (\al\; -\al)(\bt\; -\bt)\} \\
  B_0 &= A_0A_2 \simeq C_2^2 \\
  B_1 &= A_1A_3 \simeq C_2^2 \\
  C_4 &= \text{ subgroup generated by } (\al\; -\bt\; -\al\; \bt).
 \end{align*}
 
 We can display the subgroups and subfields in the following diagram:
 \begin{center}
  \begin{tikzpicture}[scale=2.7]
   \def\ya{0.7}
   \def\yb{1.4}
   \def\yc{2.1}
   \def\xa{0.6}
   \def\xb{1.2}
   \def\Da{( 0.0, 0.0)}
   \def\Ba{(-\xa, \ya)}
   \def\Bb{( \xa, \ya)}
   \def\Ca{(   0, \ya)}
   \def\Aa{(-\xb, \yb)}
   \def\Ab{( \xa, \yb)}
   \def\Ac{(-\xa, \yb)}
   \def\Ad{( \xb, \yb)}
   \def\Za{(   0, \yb)}
   \def\Ta{(   0, \yc)}
   \begin{scope}[xshift=-0.5cm]
    \draw(0, 0.0) node{$8$};
    \draw(0, \ya) node{$4$};
    \draw(0, \yb) node{$2$};
    \draw(0, \yc) node{$1$};   
   \end{scope}
   \begin{scope}[xshift=1cm]
    \draw \Da node{$D_8$};
    \draw \Ca node{$C_4$};
    \draw \Ba node{$B_0$};
    \draw \Bb node{$B_1$};
    \draw \Aa node{$A_0$};
    \draw \Ab node{$A_1$};
    \draw \Ac node{$A_2$};
    \draw \Ad node{$A_3$};
    \draw \Za node{$Z$};
    \draw \Ta node{$\{1\}$};
    \draw[<-,shorten <=11pt,shorten >=11pt] \Da -- \Ba;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Da -- \Bb;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Da -- \Ca;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ca -- \Za;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ba -- \Aa;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ba -- \Ac;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ba -- \Za;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Bb -- \Ab;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Bb -- \Ad;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Bb -- \Za;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Aa -- \Ta;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ab -- \Ta;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ac -- \Ta;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ad -- \Ta;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Za -- \Ta;
   \end{scope}
   \begin{scope}[xshift=4cm]
    \draw \Da node{$\Q$};
    \draw \Ca node{$\Q(\sqrt{14})$};
    \draw \Ba node{$\Q(\sqrt{2})$};
    \draw \Bb node{$\Q(\sqrt{7})$};
    \draw \Aa node{$\Q(\al-\bt)$};
    \draw \Ab node{$\Q(\bt)$};
    \draw \Ac node{$\Q(\al+\bt)$};
    \draw \Ad node{$\Q(\al)$};
    \draw \Za node{$\Q(\sqrt{2},\sqrt{7})$};
    \draw \Ta node{$K$};
    \draw[->,shorten <=11pt,shorten >=11pt] \Da -- \Ba;
    \draw[->,shorten <=11pt,shorten >=11pt] \Da -- \Bb;
    \draw[->,shorten <=11pt,shorten >=11pt] \Da -- \Ca;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ca -- \Za;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ba -- \Aa;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ba -- \Ac;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ba -- \Za;
    \draw[->,shorten <=11pt,shorten >=11pt] \Bb -- \Ab;
    \draw[->,shorten <=11pt,shorten >=11pt] \Bb -- \Ad;
    \draw[->,shorten <=11pt,shorten >=11pt] \Bb -- \Za;
    \draw[->,shorten <=11pt,shorten >=11pt] \Aa -- \Ta;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ab -- \Ta;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ac -- \Ta;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ad -- \Ta;
    \draw[->,shorten <=11pt,shorten >=11pt] \Za -- \Ta;
   \end{scope}
  \end{tikzpicture}
 \end{center}
 The first lattice shows all the subgroups, with the smaller groups
 towards the top.  The orders of the groups are shown at the left.
 Arrows indicate inclusions between subgroups, so they point
 downwards.  For each subgroup $H$ shown on the left, we display the
 field $K^H$ in the corresponding place on the right.  As the Galois
 correspondence is order-reversing, the largest fields appear at the
 top and the inclusion arrows point upwards.

 For example, consider the group $C_4$.  We observed above that
 $\sqrt{14}=\al/\bt-\bt/\al$.  Let $\rho$ be the generator of $C_4$.
 This sends $\al$ to $-\bt$ and $\bt$ to $\al$.  It therefore sends
 $\al/\bt-\bt/\al$ to $(-\bt)/\al-\al/(-\bt)$, which is the same as
 $\al/\bt-\bt/\al$.  In other words, we have
 $\rho(\sqrt{14})=\sqrt{14}$, so $\sqrt{14}\in K^{C_4}$.  On the other
 hand, we always have $[K:K^H]=|H|$ and so $[K^H:\Q]=8/|H|$, so in
 particular $[K^{C_4}:\Q]=2$.  Similarly, it is clear that $\al$ is
 fixed by $A_3$, so $\Q(\al)\sse K^{A_3}$, and
 $[\Q(\al):\Q]=4=[K^{A_3}:\Q]$, so we must have $K^{A_3}=\Q(\al)$.
 All the other subgroups can be handled in the same way.
\end{example}

\begin{lemma}\lbl{lem-correspondence-a}
 Let $H$ be any subgroup of $G$; then $H\leq G(M/M^H)$ and
 $|G(M/M^H)|=[M:M^H]\geq |H|$.
\end{lemma}
\begin{proof}
 By definition we have 
 \begin{align*}
  M^H &= \{a\in M\st\sg(a)=a\text{ for all } \sg\in H\} \\
  G(M/M^H) &= \{\sg\:M\to M\st \sg(a)=a\text{ for all } a\in M^H\}.
 \end{align*}
 If $\sg\in H$ then $\sg(a)=a$ for all $a\in M^H$ by the very
 definition of $M^H$, so $\sg\in G(M/M^H)$.  This shows that
 $H\leq G(M/M^H)$, and so $|H|\leq|G(M/M^H)|$.  Next, as $M$ is normal
 over $K$ we see from Proposition~\ref{prop-top-normal} that it is
 normal over any intermediate field, such as $M^H$.  We therefore see
 from Proposition~\ref{prop-normal} that
 $[M:M^H]=|G(M/M^H)|\geq|H|$ as claimed. 
\end{proof}

\begin{lemma}\lbl{lem-V-zero}
 Let $H$ be any subgroup of $G$, and let $e_1,\dotsc,e_n$ be a basis
 for $M$ over $M^H$ (so $[M:M^H]=n$).  Put 
 \[ V = \{b=(b_1,\dotsc,b_n)\in M^n\st 
           \sum_{i=1}^n b_i\sg(e_i)=0 
           \text{ for all } \sg\in H\}.
 \]
 Then $V=0$.
\end{lemma}
\begin{proof}
 We first note some properties of $V$.  
 \begin{itemize}
  \item[(a)] $V$ is clearly a vector subspace of $M^n$.
  \item[(b)] If $b\in V$ then we can take $\sg=1$ in the definition to
   see that $\sum_ib_ie_i=0$.
  \item[(c)] We next claim that $V\cap(M^H)^n=\{0\}$.  Indeed, if
   $b\in V\cap(M^H)^n$ then the relation $\sum_ib_ie_i=0$ above is an
   $M^H$-linear relation between the elements $e_i$, which by
   assumption are linearly independent over $M^H$; so we must have
   $b_1=\dotsb= b_n=0$.
  \item[(d)] Suppose that $(b_1,\dotsc,b_n)\in V$ and $\tau\in H$; we
   claim that $(\tau(b_1),\dotsc,\tau(b_n))\in V$ also.  Indeed, we
   have $\sum_ib_i\sg(e_i)=0$ for all $\sg$, and as $\sg$ is arbitrary
   we can replace it by $\tau^{-1}\sg$ to see that
   $\sum_ib_i\tau^{-1}\sg(e_i)=0$.  We then apply $\tau$ to this
   equation to obtain $\sum_i\tau(b_i)\sg(e_i)=0$, which proves the
   claim. 
 \end{itemize}

 Next, for any vector $b\in V$, we define the \emph{size} of $b$ to be
 the number of nonzero entries.  We must show that for $r>0$ there are
 no elements of size $r$, which we do by induction on $r$.

 Consider an element $b\in V$ of size one, so there is an index $i$
 with $b_i\neq 0$, and all other entries are zero.  Fact~(b) above
 therefore reduces to $b_ie_i=0$.  As $e_i$ is a basis element it is
 nonzero, and $b_i\neq 0$ by assumption, so we have a contradiction.
 Thus, there are no elements in $V$ of size one, which starts the
 induction. 

 Now suppose that $r>0$, and we have shown already that there are no
 elements in $V$ of size $s$ for all $0<s<r$.  Consider an element
 $b\in V$ of size $r$.  We can then choose $i$ such that $b_i\neq 0$,
 and after replacing $b$ by $b/b_i$ we may assume that $b_i=1$.  Now
 fix $\tau\in H$ and put $c_k=b_k-\tau(b_k)$, so $c\in V$ by facts~(d)
 and~(a).  We clearly have $c_i=0$, and also $c_j=0$ whenever $b_j=0$;
 so the size of $c$ is strictly less than that of $b$.  By our
 induction hypothesis we must therefore have $c=0$.  This means that
 $b_k=\tau(b_k)$ for all $k$, but $\tau$ was arbitrary so
 $b_k\in M^H$.  This means that $b\in V\cap(M^H)^n$ so $b=0$ by
 fact~(c).  This contradicts the assumption that $b$ has size $r$, and
 so completes the induction step.
\end{proof}
\begin{corollary}\lbl{cor-correspondence-a}
 For any subgroup $H\leq G$ we have $[M:M^H]=|H|$ and $G(M/M^H)=H$.
\end{corollary}
\begin{proof}
 Choose $e_1,\dotsc,e_n$ as in the lemma, and list the elements of $H$
 as $\tau_1,\dotsc,\tau_m$.  Define $w_i\in M^m$ (for $1\leq i\leq n$)
 by $w_i=(\tau_1(e_i),\dotsc,\tau_m(e_i))$.  It is then clear that
 $V=\{b\in M^n\st\sum_ib_iw_i=0\}$, so the lemma tells us that the
 vectors $w_1,\dotsc,w_n$ are linearly independent.  The length of any
 linearly independent list is at most the dimension of the containing
 space, so we have $n\leq m$, or in other words $[M:M^H]\leq |H|$.
 Lemma~\ref{lem-correspondence-a} gives the reverse inequality, so
 $[M:M^H]=|H|$.  The same lemma also tells us that $H\leq G(M/M^H)$
 and these two groups have the same order (namely $[M:M^H]$) so
 $H=G(M/M^H)$.  
\end{proof}

\begin{proposition}\lbl{prop-correspondence-b}
 Let $M$ be a normal extension of $K$, with Galois group $G=G(M/K)$,
 and let $L$ be a field with $K\leq L\leq M$.  Put $H=G(M/L)$.  Then
 $H$ is a subgroup of $G$ and $[M:L]=|H|$ and $L=M^H$.
\end{proposition}
\begin{proof}
 Proposition~\ref{prop-top-normal} tells us that $M$ is normal over
 $L$, and so we see from Proposition~\ref{prop-normal} that
 $|H|=|G(M/L)|=[M:L]$.  Next, recall that by definition we have 
 \begin{align*}
  G &= \{\sg\:M\to M\st \sg(a)=a\text{ for all } a\in K\} \\
  H &= \{\sg\:M\to M\st \sg(a)=a\text{ for all } a\in L\supseteq K\} \\
  M^H &= \{a\in M\st\sg(a)=a\text{ for all } \sg\in H\}.
 \end{align*}
 It is clear from this that $H$ is a subgroup of $G$.  It is also
 tautological that $L\sse M^H$: if $a\in L$ then $\sg(a)=a$ for all
 $\sg\in H$ by the very definition of $H$, so certainly $a\in M^H$.
 We therefore have $|H|=[M:L]=[M:M^H][M^H:L]$.  On the other hand,
 Lemma~\ref{lem-correspondence-a} tells us that $[M:M^H]\geq |H|$.
 The only way this can be consistent is if $[M:M^H]=|H|$ and
 $[M^H:L]=1$, so $M^H=L$.
\end{proof}

\begin{proposition}\lbl{prop-correspondence-conj}
 Suppose that $K\leq L\leq M$ and $\tau\in G$.  Then
 $K\leq\tau(L)\leq M$ and $G(M/\tau(L))=\tau G(M/L)\tau^{-1}$.
\end{proposition}
\begin{proof}
 As $\tau$ is an automorphism of $M$ we have $\tau(M)=M$, and as
 $\tau|_K=1_K$ we have $\tau(K)=K$.  We can therefore apply $\tau$ to
 the inclusions $K\sse L\sse M$ to see that $K\sse\tau(L)\sse M$.  We
 thus have groups $H=G(M/L)$ and $H'=G(M/\tau(L))$.  If $\sg\in H$ and
 $a'\in\tau(L)$ then $a'=\tau(a)$ for some $a\in L$, which means that
 $\sg(a)=a$, so $\tau\sg\tau^{-1}(a')=\tau\sg(a)=\tau(a)=a'$.  This
 shows that $\tau\sg\tau^{-1}\in G(M/\tau(L))=H'$.  As $\sg\in H$ was
 arbitrary we have $\tau H\tau^{-1}\sse H'$.  Conversely, suppose that
 $\sg'\in H'$.  Put $\sg=\tau^{-1}\sg'\tau$, so
 $\sg'=\tau\sg\tau^{-1}$.  If $a\in L$ then $\tau(a)\in \tau(L)$, and
 $\sg'|_{\tau(L)}=1$ so $\sg'\tau(a)=\tau(a)$, so
 $\sg(a)=\tau^{-1}\sg'\tau(a)=\tau^{-1}\tau(a)=a$.  This shows that
 $\sg\in H$, so $\sg'=\tau\sg\tau^{-1}\in\tau H\tau^{-1}$ as
 required.  
\end{proof}

We next study the set $E_K(L,M)=\{\tht\:L\to M\st\tht|_K=1_K\}$ (as in
Definition~\ref{defn-E}). 

\begin{proposition}\lbl{prop-correspondence-cosets}
 Let $L$ and $H$ be related as in Theorem~\ref{thm-correspondence}.
 Then there is a bijection $G/H\to E_K(L,M)$ given by
 $\sg H\mapsto \sg|_L$.
\end{proposition}
\begin{proof}
 First, if $\sg H=\sg' H$ then $\sg'=\sg\tau$ for some
 $\tau\in H=G(M/L)$, so $\tau|_L=1_L$, so for $a\in L$ we have
 $\sg'(a)=\sg(\tau(a))=\sg(a)$, so $\sg'|_L=\sg|_L$.  This means that
 there is a well-defined map $f\:G/H\to E_K(L,M)$ given by
 $f(\sg H)=\sg|_L$.  It follows easily from
 Corollary~\ref{cor-top-normal-b} that this is injective.  Moreover,
 as $M$ is normal over $K$ we have 
 \[ |E_K(L,M)| = [L:K] = \frac{[M:K]}{[M:L]} = 
     \frac{|G|}{|H|} = |G/H|.
 \]
 It follows that $f$ must actually be a bijection.
\end{proof}

\begin{proposition}\lbl{prop-correspondence-c}
 Let $L$ and $H$ be related as in Theorem~\ref{thm-correspondence}.
 Then then $L$ is a normal extension of $K$ if and only if $H$ is a
 normal subgroup of $G$, and if so, then $G(L/K)=G/H$.
\end{proposition}
\begin{proof}
 First suppose that $H$ is a normal subgroup.  Consider an element
 $\zt\in E_K(L,M)$.  By the previous proposition we can choose
 $\sg\in G$ such that $\sg|_L=\zt$, and so $\zt(L)=\sg(L)$.  It
 follows by Proposition~\ref{prop-correspondence-conj} that
 $G(M/\zt(L))=\sg H\sg^{-1}$, which is the same as $H$ because $H$ is
 normal.  Next, Proposition~\ref{prop-correspondence-b} (applied to
 $\zt(L)$) tells us that $\zt(L)=M^{G(M/\zt(L))}=M^H=L$.  Thus, we can
 regard $\zt$ as an element of $G(L/K)$.  We deduce that
 $G(L/K)=E_K(L,M)$.  As $M$ is normal over $K$ we have
 $|E_K(L,M)|=[L:K]$, so $|G(L/K)|=[L:K]$, which implies that $L$ is
 normal over $K$ (by Proposition~\ref{prop-normal}).
 Proposition~\ref{prop-correspondence-cosets} now also gives us an
 isomorphism $G/H\to G(L/K)$. 
\end{proof}

We conclude this section by proving the following result:
\begin{theorem}[Theorem of the Primitive Element]\lbl{thm-primitive}
 Any extension $\phi\:K\to L$ of finite degree has a primitive
 element.  
\end{theorem}
\begin{proof}
 First suppose that $K$ (and therefore $L$) is finite.  We then know
 that $L^\tm$ is cyclic, so we can choose a generator, say $\al$.
 This is clearly a primitive element for $\phi$.  For the rest of the
 proof we may therefore assume that $K$ is infinite.

 Corollary~\ref{cor-normal-closure} tells us that there exists a
 homomorphism $\psi\:L\to M$ of finite degree such that $\psi\phi$ is
 normal.  After adjusting notation slightly, we can assume that
 $K\sse L\sse M$ and that $M$ is normal over $K$.  Now
 Theorem~\ref{thm-correspondence} tels us that the fields between $K$
 and $M$ biject with the subgroups of the finite group $G(M/K)$, so
 there are only finitely many such fields.  

 Now choose $\al\in L$ such that $[K(\al):K]$ is as large as
 possible.  We claim that $K(\al)$ is actually equal to $L$.  If not,
 we can choose $\bt\in L$ such that $\bt\not\in K(\al)$.  For each of
 the infinitely many elements $t\in K$, we have a field $K(\al+t\bt)$
 with $K\sse K(\al+t\bt)\sse M$.  As there are only finitely many
 fields between $K$ and $M$, there must exist elements $t\neq u$ with
 $K(\al+t\bt)=K(\al+u\bt)=N$ say.  We now have $t-u\in K^\tm$ and so 
 \[ \bt = \frac{(\al+t\bt)-(\al+u\bt)}{t-u} \in N, \]
 and thus $\al=(\al+t\bt)-t\bt\in N$.  This means that
 $K(\al,\bt)\sse N$, so the field $N=K(\al+t\bt)$ is strictly larger
 than $K(\al)$.  As $\al$ was chosen so that $[K(\al):K]$ is as large
 as possible, this is a contradiction.  We must therefore have
 $K(\al)=L$ as claimed.
\end{proof}

\begin{remark}\lbl{rem-mquad-primitive}
 We can now revisit Proposition~\ref{prop-mquad-primitive}.  There we
 had a field $K(n)$ and an element
 $\tht_n=\sum_{i=1}^n\sqrt{p_i}\in K(n)$.  Part~(b) of
 Theorem~\ref{thm-correspondence} tells us that $\Q(\tht_n)=K(n)^H$ for
 some subgroup $H\leq G(K(n)/\Q)$.  Using
 Proposition~\ref{prop-mquad-galois} we see that $\tht_n$ is not fixed 
 by any nontrivial element of $G(K(n)/\Q)$, which means that $H=\{1\}$
 and so $\Q(\tht_n)=K(n)$, just as we proved more directly before.
\end{remark}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-H-cap-K}
 Let $L$ be a Galois extension of $K$, with Galois group $G$, and let
 $H$ and $K$ be subgroups of $G$.  Prove that $L^HL^K=L^{H\cap K}$.  
\end{exercise}
\begin{solution}
 Put $A=G(L/(L^HL^K))\leq G$.  Every automorphism $\sg\in A$ acts as
 the identity on $L^HL^K$, so in particular it acts as the identity on
 $L^H\sse L$, which means that $A\leq G(L/L^H)=H$.  By the same
 argument we have $A\sse G(L/L^K)=K$, so in fact $A\sse H\cap K$.
 Conversely, suppose that $\sg\in H\cap K$.  Any element $a\in L^HL^K$
 can be written as $a=b_1c_1+\dotsb+b_rc_r$ with $b_i\in L^H$ and
 $c_i\in L^K$.  We have $\sg(b_i)=b_i$ (because $\sg\in H$) and
 $\sg(c_i)=c_i$ (because $\sg\in K$).  It follows that $\sg(a)=a$ for
 all $a\in L^HL^K$, so $\sg\in A$.  This means that $A=H\cap K$.  The
 Galois Correspondence tells us that for all $M$ with $K\leq M\leq L$
 we have $M=L^{G(L/M)}$.  By taking $M=L^HL^K$ we see that
 $L^HL^K=L^A=L^{H\cap K}$ as claimed.
\end{solution}

\begin{exercise}\exlabel{ex-vier}
 Let $K$ be a field of characteristic zero, and suppose that $L$ is a
 normal extension of $K$ such that $G(L/K)$ is isomorphic to
 $C_2\tm C_2$.  Show that there exist $\al,\bt\in L$ such that
 $\al^2,\bt^2\in K$ and $\{1,\al,\bt,\al\bt\}$ is a basis for $L$ over
 $K$.  Describe the lattice of subgroups of $G(L/K)$, and the
 corresponding lattice of fields between $K$ and $L$.
\end{exercise}
\begin{solution}
 Choose elements $\rho$ and $\sg$ that generate $G(L/K)$, so
 $G(L/K)=\{1,\rho,\sg,\rho\sg\}$ with $\rho^2=\sg^2=1$ and
 $\rho\sg=\sg\rho$.  Put $G=G(L/K)$ and 
 \begin{align*}
  A &= \{1,\rho\} & B &= \{1,\sg\} & C &= \{1,\rho\sg\} \\
  M &= L^A & N &= L^B & P &= L^C.
 \end{align*}
 Then $A$, $B$ and $C$ are the only proper nontrivial subgroups of
 $G$, so $M$, $N$ and $P$ are the only fields strictly between $K$ and
 $L$.  As $G$ is abelian, we see that all subroups are normal, so $M$,
 $N$ and $P$ are normal over $\Q$, with Galois groups $G/A$, $G/B$ and
 $G/C$ respectively.  All of these are of order $2$.  As
 $\sg\not\in A$, we see that $\sg$ acts nontrivially on $M$, so we can
 choose $\mu\in M$ with $\sg(\mu)\neq\mu$.  It follows that the
 element $\al=\mu-\sg(\mu)$ is nonzero, and it satisfies
 $\sg(\al)=-\al$.  It follows that $\al\not\in K$, and
 $[M:K]=|G/A|=2$, so $1$ and $\al$ must give a basis for $M$ over $K$,
 so $M=K(\al)$.  We also have $\sg(\al^2)=\al^2$, and so $\al^2\in
 M^{G/A}=K$.  Similarly, there is an element $\bt\in N$ such that
 $1,\bt$ is a basis for $N$ over $K$, and $\rho(\bt)=-\bt$, and
 $\bt^2\in K$.  Note that $\rho(\al)=\al$ (as $\al\in M$) and
 $\sg(\bt)=\bt$ (as $\bt\in N$).  It follows that
 $\rho(\sg(\al\bt))=(-\al)(-\bt)=\al\bt$, so $\al\bt\in P$.

 We next claim that the list $1,\al,\bt,\al\bt$ is linearly
 independent over $K$.  To see this, suppose that
 $a=w+x\al+y\bt+z\al\bt$ for some $w,x,y,z\in K$.  We can use the
 above formulae to understand $\sg(a)$ and $\rho(a)$, and we find that 
 \begin{align*}
  a+\rho(a)+\sg(a)+\rho\sg(a) &= 4w \\
  a+\rho(a)-\sg(a)-\rho\sg(a) &= 4x\al \\
  a-\rho(a)+\sg(a)-\rho\sg(a) &= 4y\bt \\
  a-\rho(a)-\sg(a)+\rho\sg(a) &= 4z\al\bt.
 \end{align*}
 Thus, if $w+x\al+y\bt+z\al\bt=0$ we see that $w=x=y=z=0$.  This shows
 that the list $\CB=1,\al,\bt,\al\bt$ is linearly independent list, but
 $\dim_K(L)=|G|=4$, so $\CB$ must actually be a basis. 

 \begin{center}
  \begin{tikzpicture}[scale=2]
   \def\Ga{( 1.0, 0.0)}
   \def\Aa{( 0.0, 1.0)}
   \def\Bb{( 1.0, 1.0)}
   \def\Cc{( 2.0, 1.0)}
   \def\Ta{( 1.0, 2.0)}

   \begin{scope}
    \draw(0, 0.0) node{$4$};
    \draw(0, 1.0) node{$2$};
    \draw(0, 2.0) node{$1$};
   \end{scope}
   \begin{scope}[xshift=1cm] 
    \draw \Ga node{$G$};
    \draw \Aa node{$A$}; 
    \draw \Bb node{$B$}; 
    \draw \Cc node{$C$}; 
    \draw \Ta node{$\{1\}$};
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Aa;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Bb;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Cc;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Aa -- \Ta;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Bb -- \Ta;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Cc -- \Ta;
   \end{scope}
   \begin{scope}[xshift=4cm] 
    \draw \Ga node{$\Q$};
    \draw \Aa node{$K(\al)$}; 
    \draw \Bb node{$K(\bt)$}; 
    \draw \Cc node{$K(\al\bt)$}; 
    \draw \Ta node{$L$};
    \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Aa;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Bb;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Cc;
    \draw[->,shorten <=11pt,shorten >=11pt] \Aa -- \Ta;
    \draw[->,shorten <=11pt,shorten >=11pt] \Bb -- \Ta;
    \draw[->,shorten <=11pt,shorten >=11pt] \Cc -- \Ta;
   \end{scope}
  \end{tikzpicture}
 \end{center}
\end{solution}
\begin{exercise}\exlabel{ex-golden}
 Put 
 \begin{align*}
  \zt &= e^{{2\pi i}/{5}} \\
  \al &= \zt + \zt^{-1} = 2\cos(2\pi/5) \\
  \bt &= \zt - \zt^{-1} = 2i\sin(2\pi/5). 
 \end{align*}
 Given that $\zt^4+\zt^3+\zt^2+\zt+1=0$, show that
 $\al=(-1+\sqrt{5})/2$, and deduce that $\sqrt{5}\in\Q(\zt)$.  Then
 check that $\bt^2=\al^2-4$, and thus that
 $\bt=\sqrt{-(1+\sqrt{5})/2}$.  

 Draw the subfield and subgroup lattices for the field extension
 $\Q(\zt)/\Q$.
\end{exercise}
\begin{solution}
 Since $\zt^4+\zt^3+\zt^2+\zt+1=0$, we have
 $\zt^2+\zt+1+\zt^{-1}+\zt^{-2}=0$. Since $\al^2=\zt^2+2+\zt^{-2}$, we
 see that $\al^2+\al-1=0$.  Thus $\al$ is one of the roots of
 $x^2+x-1=0$, namely, $\al=(-1\pm\sqrt{5})/2$.  However,
 $\zt+\zt^{-1}=\zt+\ov{\zt}=2\cos(2\pi/5)>0$, so we must have
 $\al=(-1+\sqrt{5})/2$.  It follows that
 $\sqrt{5}=2\al+1=2\zt+2\zt^{-1}+1$, so $\sqrt{5}=2\al+1\in\Q(\zt)$.

 Next, we have 
 \[ \bt^2=\zt^2-2+\zt^{-2}=\al^2-4=
     \left(\frac{-1+\sqrt{5}}{2}\right)^2 - 4 = 
     \frac{6-2\sqrt{5}}{4}-4 = - \frac{1+\sqrt{5}}{2}.
 \]
 We also observe that $\sin(2\pi/5)>0$, and recall that when $t<0$ the
 symbol $\sqrt{t}$ refers to the square root in the upper half plane;
 we thus have $\bt=\sqrt{-(1+\sqrt{5})/2}$.

 We now put $G=G(\Q(\mu_5)/\Q)$ and look at the subgroup lattice.
 We know that
 \[ G = G(\Q(\mu_5)/\Q)=\{\sg_k\st k\in (\Z/5\Z)^\tm\} = 
     = \{\sg_{-2},\sg_{-1},\sg_{1},\sg_{2}\},
 \]
 and this is cyclic of order $4$, generated by $\sg_{2}$.  It follows
 that the only subgroups are the trivial group, the whole group, and
 the subgroup $A=\{\ov{1},\ov{-1}\}$.  This means that the only
 subfields are $\Q(\mu_5)$, $\Q$ and the intermediate field
 $M=\Q(\mu_5)^A$.  Now $\sg_{-1}$ exchanges $\zt$ and $\zt^{-1}$ so it
 fixes $\al$ and sends $\bt$ to $-\bt$.  We therefore see that
 $M=\Q(\al)=\Q(\sqrt{5})$, and that $\Q(\bt)$ cannot be $M$ so it must
 be all of $\Q(\zt)$.  (In fact, one can check that
 $\zt=(\bt-\bt^2-3)/2$, which shows more explicitly that
 $\Q(\bt)=\Q(\zt)$.) 

 The lattices can now be displayed as follows:
 \begin{center}
  \begin{tikzpicture}[scale=2]
   \def\Ga{( 0.0, 0.0)}
   \def\Ha{( 0.0, 1.0)}
   \def\Ta{( 0.0, 2.0)}

   \begin{scope}
    \draw(0, 0.0) node{$4$};
    \draw(0, 1.0) node{$2$};
    \draw(0, 2.0) node{$1$};
   \end{scope}
   \begin{scope}[xshift=1cm] 
    \draw \Ga node{$G$};
    \draw \Ha node{$H$}; 
    \draw \Ta node{$\{1\}$};
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Ha;
    \draw[<-,shorten <=11pt,shorten >=11pt] \Ha -- \Ta;
   \end{scope}
   \begin{scope}[xshift=4cm] 
    \draw \Ga node{$\Q$};
    \draw \Ha node{$\Q(\sqrt{5})$}; 
    \draw \Ta node{$\Q(\sqrt{-(1+\sqrt{5})/2})$};
    \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Ha;
    \draw[->,shorten <=11pt,shorten >=11pt] \Ha -- \Ta;
   \end{scope}
  \end{tikzpicture}
 \end{center}
\end{solution}
\begin{exercise}\exlabel{ex-mu-eleven}
 Put $\zt=e^{{2\pi i}/{11}}$ and $K=\Q(\zt)=\Q(\mu_{11})$.  Recall
 that the corresponding cyclotomic polynomial is 
 \[ \vph_{11}(x) = x^{10}+x^9+x^8+x^7+x^6+x^5+x^4+x^3+x^2+x+1, \]
 and that the roots of this are $\zt,\zt^2,\dotsc,\zt^{10}=\zt^{-1}$.  
 Define
 \begin{align*}
  \bt &= \zt+\zt^{-1} = 2\cos(2\pi/11) \\
  \gm &= \zt+\zt^3+\zt^4+\zt^5+\zt^9.
 \end{align*}
 \begin{itemize}
  \item[(a)] Explain why $\bt$ satisfies a quintic equation over $\Q$,
   and write it down.
  \item[(b)] Expand $\gm^2$ in powers of $\zt$, and hence deduce 
   that $\gm^2+\gm+3=0$. Show that $\Q(\sqrt{-11})\subseteq\Q(\zt)$.
  \item[(c)] Use the general theory of cyclotomic extensions to find
   the structure of $G(K/\Q)$, and draw its lattice of subgroups.
  \item[(d)] Using the earlier parts of the question, draw the
   subfield lattice. 
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] 
   Since $\zt^{10}=\zt^{-1}$ etc., we can rewrite the given equation as
   \[ \zt^5+\zt^4+\zt^3+\zt^2+\zt+1 +
      \zt^{-1}+\zt^{-2}+\zt^{-3}+\zt^{-4}+\zt^{-5} = 0.
   \]
   Now 
   \[ \begin{array}{rrrrrrrrrrrrr}
       \bt   &= &&&&& \zt & & +\zt^{-1} &&&& \\
       \bt^2 &= &&&& \zt^2 & & + 2 & & +\zt^{-2} &&& \\
       \bt^3 &= &&& \zt^3 && +3\zt && +3\zt^{-1} && + \zt^{-3} && \\
       \bt^4 &= && \zt^4 && +4\zt^2 && +6 && +4\zt^{-2} && +\zt^{-4} &\\
       \bt^5 &= & \zt^5 && +5\zt^3 && +10\zt &&
                  +10\zt^{-1} && + 5\zt^{-3} && +\zt^{-5}.
      \end{array}
   \]
   By combining these, we find that $\bt^5+\bt^4-4\bt^3-3\bt^2+3\bt+1=0$.
  \item[(b)] We have
   \begin{align*}
    \gm^2 &= \zt^2+\zt^8+\zt^7+\zt^{10}+\zt^6+\\
     & \qquad 2(\zt^5+\zt^{10}+\zt^6+\zt^4+
                \zt^2+\zt^9+\zt^7+\zt^3+\zt+\zt^8)\\
     &= (-1-\zt-\zt^3-\zt^4-\zt^5-\zt^9)+2(-1)\\
     &= -3-\gm,
   \end{align*}
   so $\gm^2+\gm+3=0$.  Since $\gm$ is a root of $x^2+x+3=0$, we see
   that $\gm=(-1\pm\sqrt{-11})/2$.  The terms in $\gm$ are
   distributed in the complex plane as follows:
   \begin{center}
    \begin{tikzpicture}[scale=2]
     \draw[->] (-1.3,0) -- (1.3,0);
     \draw[->] (0,-1.3) -- (0,1.3);
     \fill[black!20] (  0:1) circle(0.03);
     \fill           ( 33:1) circle(0.03);
     \draw ( 33:1.2) node {$\zt$};
     \fill[black!20] ( 65:1) circle(0.03);
     \fill           ( 98:1) circle(0.03);
     \draw ( 98:1.2) node {$\zt^3$};
     \fill           (131:1) circle(0.03);
     \draw (131:1.2) node {$\zt^4$};
     \fill           (164:1) circle(0.03);
     \draw (164:1.2) node {$\zt^5$};
     \fill[black!20] (196:1) circle(0.03);
     \fill[black!20] (229:1) circle(0.03);
     \fill[black!20] (262:1) circle(0.03);
     \fill           (295:1) circle(0.03);
     \draw (295:1.2) node {$\zt^9$};
     \fill[black!20] (327:1) circle(0.03);
     \fill[black!20] (360:1) circle(0.03);
    \end{tikzpicture}
   \end{center}
   It is clear from this that the imaginary part of $\gm$ is positive,
   so $\gm=(-1+\sqrt{-11})/2$, so $\sqrt{-11}=2\gm+1$.  It is also
   clear from the definition that $\gm\in\Q(\zt)$, so
   $\sqrt{-11}\in\Q(\zt)$.  
  \item[(c),(d)] The general cyclotomic theory says that
   $G(K/\Q)=\{\sg_k\st k\in(\Z/11)^\tm\}$.  We have 
   \[ (\Z/11)^\tm = 
       \{-5,-4,-3,-2,-1,1,2,3,4,5\}.
   \]
   The powers of $2$ mod $11$ are as follows:
   \[ 2^0=1,  \;\;
      2^1=2,  \;\;
      2^2=4,  \;\;
      2^3=-3, \;\;
      2^4=5,  \;\;
      2^5=-1, \;\;
      2^6=-2, \;\;
      2^7=-4, \;\;
      2^8=3,  \;\;
      2^9=-5, \;\;
      2^{10}=1.
   \]
   This shows that $(\Z/11)^\tm$ is cyclic of order $10$, generated
   by $2$, and thus $G(K/\Q)$ is cyclic of order $10$, generated by
   $\sg_2$.  We write 
   \begin{align*}
    C_{10} &= G(K/\Q) = \ip{\sg_2} \\
    C_5 &= \ip{\sg_2^2} = \ip{\sg_4} = 
      \{1,\sg_4,\sg_5,\sg_{-2},\sg_3\} \\
    C_2 &= \ip{\sg_2^5} = \ip{\sg_{-1}} = \{1,\sg_{-1}\} \\
    C_1 &= \{1\}.
   \end{align*}
   These are all the subgroups of the Galois group.  It follows that
   the only subfields of $K$ are $K^{C_{10}}=\Q$, $K^{C_5}$, $K^{C_2}$
   and $K^{C_1}=K$.  The terms in $\gm$ are precisely the orbit of
   $\zt$ under $C_5$, so $\gm\in K^{C_5}$, so $\sqrt{-11}\in K^{C_5}$.
   We also know that $[K^{C_5}:\Q]=|C_{10}|/|C_5|=2$, which is the
   same as the degree of $\Q(\sqrt{-11})$, so we must have
   $K^{C_5}=\Q(\sqrt{-11})$.  Similarly, we have
   \[ \sg_{-1}(\bt) = 
      \sg_{-1}(\zt)+\sg_{-1}(\zt)^{-1}=\zt^{-1}+\zt=\bt, 
   \]
   so $\bt\in K^{C_2}$, and it follows that $K^{C_2}=\Q(\bt)$.  The
   subgroup and subfield lattices can thus be displayed as follows:
   \begin{center}
    \begin{tikzpicture}[scale=2]
     \def\Ga{( 0.8, 0.0)}
     \def\Gb{( 0.0, 0.6)}
     \def\Gc{( 2.0, 1.6)}
     \def\Gd{( 1.2, 2.2)}

     \begin{scope}
      \draw(0, 0.0) node{$10$};
      \draw(0, 0.6) node{$5$};
      \draw(0, 1.6) node{$2$};
      \draw(0, 2.2) node{$1$};
     \end{scope}
     \begin{scope}[xshift=1cm] 
      \draw \Ga node{$C_{10}$};
      \draw \Gb node{$C_5$}; 
      \draw \Gc node{$C_2$}; 
      \draw \Gd node{$\{1\}$};
      \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Gb;
      \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Gc;
      \draw[<-,shorten <=11pt,shorten >=11pt] \Gb -- \Gd;
      \draw[<-,shorten <=11pt,shorten >=11pt] \Gc -- \Gd;
     \end{scope}
     \begin{scope}[xshift=4cm] 
      \draw \Ga node{$\Q$};
      \draw \Gb node{$\Q(\sqrt{-11})$}; 
      \draw \Gc node{$\Q(\bt)$}; 
      \draw \Gd node{$\Q(\mu_{11})$};
      \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Gb;
      \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Gc;
      \draw[->,shorten <=11pt,shorten >=11pt] \Gb -- \Gd;
      \draw[->,shorten <=11pt,shorten >=11pt] \Gc -- \Gd;
     \end{scope}
    \end{tikzpicture}
   \end{center}
 \end{itemize}
\end{solution}

\begin{exercise}\exlabel{ex-two-group}
 Let $G$ be a finite group of order $2^r$ for some $r$.  It is a
 standard fact from group theory that one can find subgroups
 \[ \{1\} = H_0 < H_1 < \dotsb < H_{r-1} < H_r = G \]
 such that $|H_i|=2^i$ for all $i$, and $H_i$ is normal in $G$.  Now
 suppose that $G$ is the Galois group of some normal extension $L/K$.
 What can we deduce about the structure of $L$?
\end{exercise}
\begin{solution}
 Put $M_i=L^{H_i}$, so $L=M_0\supset M_1\supset\dotsb\supset M_r=K$.
 The Galois Correspondence tells us that $L$ is normal over $M_i$,
 with Galois group $H_i$ (so $[L:M_i]=2^i$) and $M_i$ is normal over
 $K$ (with Galois group $G/H_i$).  It follows that $[M_i:M_{i+1}]=2$,
 so the standard analysis of degree two extensions says that
 $M_i=M_{i+1}(\al_i)$ for some $\al_i$ with $\al_i^2\in M_{i+1}$.
 This means that $L=K(\al_0,\dotsc,\al_{r-1})$.  More precisely, for
 any subset $I\sse\{0,1,\dotsc,r-1\}$ we can let $\al_I$ denote the
 product of the elements $\al_i$ for $i\in I$.  We then find that
 these elements $\al_I$ give a basis for $L$ over $K$.

 This does not yet capture all the information that one might want, as
 revealed by the following question.  Suppose we have fields
 $K\subset K(\al_1)\subset K(\al_0,\al_1)$, with $\al_1^2\in K$ and
 $\al_0^2\in K(\al_1)$.  When is it true that $K(\al_0,\al_1)$ is
 normal over $K$?  This is usually false but sometimes true.  We do
 not know a good general criterion even in this case where $r=2$, let
 alone the case of general $r$.
\end{solution}


\section{Cubics}
\label{sec-cubics}

In this section we will work with cubic polynomials over $\Q$, for
convenience.  Not much would change if we instead considered cubics
over an arbitrary field $K$ (although there would be some special
features if the characteristic of $K$ was $2$ or $3$).

Consider a polynomial $f(x)=x^3+ax^2+bx+c$ with $a,b,c\in\Q$.  If
$f(x)$ is reducible then it must factor as $g(x)h(x)$ with
$\deg(g(x))=1$ and $\deg(h(x))=2$.  It is then easy to understand the
roots of $g(x)$ and $h(x)$, and this determines the roots of $f(x)$.
From now on we will ignore this case and assume instead that $f(x)$ is
irreducible over $\Q$.  We can factor this over $\C$ as
$f(x)=(x-\al)(x-\bt)(x-\gm)$ say.  Moreover,
Proposition~\ref{prop-distinct-roots} assures us that $\al$, $\bt$ and
$\gm$ are all distinct, so the set $R=\{\al,\bt,\gm\}$ has size
three.  By expanding out the relation 
\[ x^3+ax^2+bx+c = (x-\al)(x-\bt)(x-\gm) \]
we find that 
\begin{align*}
 a &= -(\al+\bt+\gm) \\
 b &= \al\bt+\bt\gm+\gm\al \\
 c &= -\al\bt\gm.
\end{align*}

Now put $K=\Q(\al,\bt,\gm)$, which is the splitting field of $f(x)$.
Put $G=G(K/\Q)$, which can be considered as a subgroup of
$\Sg_R\simeq\Sg_3$.

The subgroups of $\Sg_R$ can be enumerated as follows.
\begin{itemize}
 \item[(a)] There is the trivial subgroup, of order one.
 \item[(b)] There are three different transpositions, namely
  $(\al\;\bt)$, $(\bt\;\gm)$ and $(\gm\;\al)$.  For each transposition
  $\tau$, the set $\{1,\tau\}$ is a subgroup of $\Sg_R$ of order two.
 \item[(c)] The set $A_R=\{1,(\al\;\bt\;\gm),(\gm\;\bt\;\al)\}$ is a
  subgroup of order $3$, isomorphic to $C_3$.
 \item[(d)] The full group $\Sg_R$ has order $6$.
\end{itemize}
It is straightforward to check that this gives all possible subgroups
of $\Sg_R$.  We also know from Proposition~\ref{prop-root-perms} that
the subgroup $G$ acts transitively: for any pair of elements in $R$,
there is an element $\sg\in G$ that sends one to the other.  It is
easy to check that the subgroups of order $1$ or $2$ do not have this
property.  We must therefore have $G=A_R$ or $G=\Sg_R$.  To
distinguish between these cases we introduce the element 
\[ \dl = (\al-\bt)(\bt-\gm)(\gm-\al) \]
and the element $\Dl=\dl^2$, which is known as the \emph{discriminant}
of $f(x)$.  

\begin{proposition}\lbl{prop-cubic}
 \begin{itemize}
  \item[(a)] If $\sg\in G$ then $\sg(\dl)=\sgn(\sg)\dl$, where
   $\sgn(\sg)$ denotes the signature of the corresponding
   permutation.
  \item[(b)] We also have $\Dl\in\Q$, so $\sg(\Dl)=\Dl$ for all
   $\sg\in G$.
  \item[(c)] If $\dl\in\Q$ (or equivalently, $\Dl$ is a square in
   $\Q$) then $G=A_R\simeq C_3$, and $K=\Q(\al)$.
  \item[(d)] Suppose instead that $\dl\not\in\Q$.  Then $G=\Sg_R$, and
   $K=\Q(\dl,\al)$, and $K^{A_R}=\Q(\dl)$.
 \end{itemize}
\end{proposition}
\begin{proof}
 \begin{itemize}
  \item[(a)] Suppose that $\sg$ acts on $R$ as the transposition
   $(\al\;\bt)$.  We then have 
   \[ \sg(\dl)=\sg((\al-\bt)(\bt-\gm)(\gm-\al)) = 
       (\bt-\al)(\al-\gm)(\gm-\bt) = 
       -(\al-\bt)(\bt-\gm)(\gm-\al) = -\dl.
   \]
   Similarly, if $\sg=(\bt\;\gm)$ or $\sg=(\gm\;\al)$ we see that
   $\sg(\dl)=-\dl$.  Now suppose instead that $\sg$ acts as the
   $3$-cycle $(\al\;\bt\;\gm)$.  We then have
   \[ \sg(\dl)=(\bt-\gm)(\gm-\al)(\al-\bt)=\dl. \]
   If $\sg=(\gm\;\bt\;\al)$ we also have $\sg(\dl)=\dl$, by a very
   similar argument.  This covers all possible permutations (except for
   the identity, which is trivial) and so proves claim~(a).
  \item[(b)] For all $\sg\in G$ we have $\sg(\dl)=\pm\dl$, and so
   $\sg(\Dl)=\sg(\dl^2)=\sg(\dl)^2=(\pm\dl)^2=\dl^2=\Dl$.  This proves
   that $\Dl\in K^G$, which is just $\Q$ by
   Theorem~\ref{thm-correspondence}.
  \item[(c)] Suppose that $\dl\in\Q$.  It follows that for all
   $\sg\in G=G(K/\Q)$ we must have $\sg(\dl)=\dl$, which is only
   consistent with~(a) if $G\sse A_R$.  We also saw previously (using
   transitivity) that $G$ must either be $A_R$ or $\Sg_R$, so now we
   see that $G=A_R$.  In particular we have $|G|=3$ and so $[K:\Q]=3$,
   but as $f(x)$ is irreducible we also have $[\Q(\al):\Q]=3$, so it
   must be that $K=\Q(\al)$.
  \item[(d)] Suppose instead that $\dl\not\in\Q=K^G$, so there must
   exist $\sg\in G$ with $\sg(\dl)\neq\dl$.  We then see from~(a) that
   $\sg$ gives an odd permutation of $R$, and that $\sg(\dl)=-\dl$.
   This means that we cannot have $G=A_R$, so we must have $G=\Sg_R$
   instead.  This means in particular that $[K:\Q]=|G|=6$.  Consider
   the field $K'=\Q(\dl,\al)\sse K$.  We then see that $[K':\Q]$
   divides $[K:\Q]=6$, so $[K':\Q]\in\{1,2,3,6\}$.  On the other hand,
   as $\Q\sse\Q(\dl)\sse K'$ and $\Q\sse\Q(\al)\sse K'$ we see that
   $[K':\Q]$ is divisible by both $[\Q(\dl):\Q]=2$ and
   $[\Q(\al):\Q]=3$.  It follows that $[K':\Q]=6$, and thus that
   $K'=K$.  It is also clear from~(a) that $\Q(\dl)\sse K^{A_R}$ and
   $[K^{A_R}:\Q]=|G/A_R|=|\Sg_R/A_R|=2=[\Q(\dl):\Q]$ so
   $K^{A_R}=\Q(\dl)$ as claimed.
 \end{itemize}
\end{proof}

We will now explore the Galois correspondence in the case where
$G(K/\Q)=\Sg_R$.  Put 
\[ A = \{1,(\bt\;\gm)\} \hspace{4em}
   B = \{1,(\gm\;\al)\} \hspace{4em}
   C = \{1,(\al\;\bt)\}
\]
The lattice of subgroups is then as shown on the left below, and the
corresponding lattice of subfields is as shown on the right.
\begin{center}
 \begin{tikzpicture}[scale=2]
  \def\ya{0.7}
  \def\yb{1.4}
  \def\yc{2.1}
  \def\Ga{( 0.9, 0.0)}
  \def\Ca{( 0.0, \ya)}
  \def\Aa{( 0.9, \yb)}
  \def\Bb{( 1.5, \yb)}
  \def\Cc{( 2.1, \yb)}
  \def\Ta{( 0.9, \yc)}
  \begin{scope}
   \draw(0, 0.0) node{$6$};
   \draw(0, \ya) node{$3$};
   \draw(0, \yb) node{$2$};
   \draw(0, \yc) node{$1$};   
  \end{scope}
  \begin{scope}[xshift=1cm]
   \draw \Ga node{$\Sg_3$};
   \draw \Ca node{$C_3$};
   \draw \Aa node{$A$};
   \draw \Bb node{$B$};
   \draw \Cc node{$C$};
   \draw \Ta node{$\{1\}$};
   \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Ca;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Aa;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Bb;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Ga -- \Cc;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Ca -- \Ta;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Aa -- \Ta;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Bb -- \Ta;
   \draw[<-,shorten <=11pt,shorten >=11pt] \Cc -- \Ta;
  \end{scope}
  \begin{scope}[xshift=4cm]
   \draw \Ga node{$\Q$};
   \draw \Ca node{$\Q(\dl)$};
   \draw \Aa node{$\Q(\al)$};
   \draw \Bb node{$\Q(\bt)$};
   \draw \Cc node{$\Q(\gm)$};
   \draw \Ta node{$K$};
   \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Ca;
   \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Aa;
   \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Bb;
   \draw[->,shorten <=11pt,shorten >=11pt] \Ga -- \Cc;
   \draw[->,shorten <=11pt,shorten >=11pt] \Ca -- \Ta;
   \draw[->,shorten <=11pt,shorten >=11pt] \Aa -- \Ta;
   \draw[->,shorten <=11pt,shorten >=11pt] \Bb -- \Ta;
   \draw[->,shorten <=11pt,shorten >=11pt] \Cc -- \Ta;
  \end{scope}
 \end{tikzpicture}
\end{center}

\begin{remark}\lbl{rem-disc-formula}
 One can in fact show that 
 \begin{align*}
  \Delta(\al,\bt,\gm) &= a^2b^2-4a^3c-4b^3+18abc-27c^2 \\
  &= - \det\bbm 1&0&3&0&0 \\
                a&1&2a&3&0 \\
                b&a&b&2a&3 \\
                c&b&0&b&2a \\
                0&c&0&0&b \ebm.
 \end{align*}
 It would be long, but essentially straightforward, to check this by
 hand.  Alternatively, one can just enter the following in Maple:
 \begin{verbatim}
 a :=  - alpha - beta - gamma;
 b := alpha * beta + beta * gamma + gamma * alpha;
 c := - alpha * beta * gamma;
 delta := (alpha-beta) * (beta - gamma) * (gamma - alpha);
 M := <<1|0|3|0|0>,<a|1|2*a|3|0>,<b|a|b|2*a|3>,<c|b|0|b|2*a>,<0|c|0|0|b>>;
 expand(delta^2 - (a^2*b^2-4*a^3*c-4*b^3+18*a*b*c-27*c^2));
 expand(LinearAlgebra[Determinant](M) + delta^2);
 \end{verbatim}
 There is also a more conceptual argument using the determinant
 formula, which we will not explain here, except to mention that the
 first two columns contain the coefficients of $f(t)$ and the last three
 columns contain the coefficients of $f'(t)$.  The determinant formula
 can be generalised to cover polynomials of any degree, not just
 cubics. 
\end{remark}
\begin{remark}\label{rem-disc-simple}
 In the case where $a=0$, the formula reduces to $\Dl=-4b^3-27c^2$.
 One can always reduce to this case: if $f(x)=x^3+ax^2+bx+c$, then
 $f(x-a/3)=x^3+Bx+C$, where $B=b-a^2/3$ and $C=2a^3/27-ab/3+c$.  
\end{remark}

We next explain how to find the roots $\al$, $\bt$ and $\gm$ in terms
of the coefficients of $f(x)$.  Traditionally this is usually done by
starting with some preliminary steps that simplify the algebra but
obscure some of the symmetry.  Here we will assume that the algebra
can be handled by a system such as Maple or Mathematica, so we will
bypass these preliminary steps.

First, we define $\Dl=a^2b^2-4a^3c-4b^3+18abc-27c^2$.  If this is zero
then $f(x)$ must be reducible, and so must have a root in $\Q$.  We
will ignore this case from now on, and assume that $\Dl\neq 0$.  We
will also assume for the moment that $b\neq a^2/3$; the significance of
this will appear later.

Let $\dl$ be one of the square roots of $\Dl$.  For definiteness, we
choose $\dl>0$ if $\Dl>0$, and we take $\dl$ to be a positive multiple
of $i$ if $\Dl<0$.  Then put
\begin{align*}
 m &= (9ab - 2a^3 - 27c + 3\sqrt{-3}\delta)/2 \\
 n &= (9ab - 2a^3 - 27c - 3\sqrt{-3}\delta)/2.
\end{align*}
We find (with computer assistance if necessary) that 
\begin{align*}
 m+n &= 9ab-2a^3-27c \\
 mn &= ((9ab-2a^3-27c)^2+27\Dl)/4 = (a^2-3b)^3.
\end{align*}
In particular, as we have assumed that $b\neq a^2/3$ we see that
$mn\neq 0$ and so $m,n\neq 0$.  Now let $\mu$ be any cube root of $m$.
(If $\Dl>0$ then $m$ lies in the upper half plane and we can take
$\mu$ to be the unique cube root with $0<\arg(\mu)<\pi/3$; if $\Dl<0$
then $m$ is real and we can take $\mu$ to be the unique real cube root
of $m$.)  Now put $\nu=(a^2-3b)/\mu$ and observe (using the above
formula for $mn$) that $\nu$ is a cube root of $n$.  We now have
\begin{align*}
 \mu^3+\nu^3 &= 9ab-2a^3-27c \\
 \mu\nu &= a^2-3b.
\end{align*}
Now consider the number $\om=e^{2\pi i/3}=(\sqrt{3}i-1)/2$, so that
$\om^3=1$ and $\om^2=\ov{\om}=\om^{-1}=-1-\om$.  It is easy to check
that the above equations will still hold if we replace $(\mu,\nu)$ by
$(\om\mu,\ob\nu)$ or $(\ob\mu,\om\nu)$.  Finally, we put 
\begin{align*}
 \al &= (\mu+\nu-a)/3 \\
 \bt &= (\om\mu+\ob\nu-a)/3 \\
 \gm &= (\ob\mu+\om\nu-a)/3.
\end{align*}
We claim that these are the roots of $f(x)$.  To see this, we note by
direct expansion that 
\[ f(\al) = f((\mu+\nu-a)/3) = 
    (\mu^3+\nu^3+2a^3-9ab+27c)/27 + (\mu\nu+3b-a^2)(\mu+\nu)/9.
\]
However, we saw above that $\mu^3+\nu^3+2a^3-9ab+27c=0$ and
$\mu\nu+3b-a^2=0$, so it follows that $f(\al)=0$.  We can now replace
$(\mu,\nu)$ by $(\om\mu,\ob\nu)$ and argue in the same way to see that
$f(\bt)=0$, and similarly $f(\gm)=0$.  If we can show that $\al$,
$\bt$ and $\gm$ are distinct, it will follow from
Proposition~\ref{prop-several-roots} that $f(x)=(x-\al)(x-\bt)(x-\gm)$
as expected.

To check for distinctness, first note that
$\mu^3-\nu^3=m-n=3\sqrt{-3}\dl\neq 0$, which implies that
$\mu\neq\nu$, so $\mu-\nu\neq 0$.  We also have 
\[ \bt-\gm = (\om-\ob)(\mu-\nu)/3 = 
    \sqrt{-3}(\mu-\nu)/3 \neq 0, 
\]
so $\bt\neq\gm$.  One can show that $\al\neq\bt$ and $\al\neq\gm$ in a
similar way.

This completes our discussion of the general case where $b\neq a^2/3$.
We conclude by discussing briefly the special case where $b=a^2/3$.
Here we find that $\Dl=-(a^3-27c)^2/27$, so
$\dl=\pm(a^3-27c)/(3\sqrt{-3})$.  We also have $mn=0$, so either $m$
or $n$ is zero.  On the other hand, we have $m-n=3\sqrt{-3}\dl\neq 0$,
so $m$ and $n$ are not both zero.  If $m\neq 0$ then we proceed
exactly as before, noting that $\nu=(a^2-3b)/\mu=0$.  If $m=0$ then we
instead define $\nu$ to be the standard cube root of $n$ and put
$\mu=0$, and then the rest of the argument works as previously.

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-classify-cubics}
 Show that the cubics $g_0(x)=x^3-3x+1$ and $g_1(x)=x^3+3x+1$ are
 irreducible, and find their Galois groups.
\end{exercise}
\begin{solution}
 We first claim that $g_0(x)$ is irreducible over $\Q$.  If not, it
 would have to have a monic linear factor, say $x-a$ with $a\in\Q$.
 Then Gauss's Lemma (Proposition~\ref{prop-gauss}) would tell us that
 $a\in\Z$.  We would also have $g_0(a)=0$, which rearranges to give
 $a(3-a^2)=1$, so $a$ divides $1$, so $a=\pm 1$.  However $g_0(1)$ and
 $g_0(-1)$ are nonzero, so this is impossible.  By essentially the
 same argument, $g_1(x)$ is irreducible over $\Q$.  This can also be
 proved by applying Eisenstein's criterion (with $p=3$) to $g_0(x-1)$
 and $g_1(x-1)$.  

 We now see from the general theory that the Galois groups are either
 $A_3=C_3$ (if the discriminant is a square) or $\Sg_3$ (if the
 discriminant is not a square).  Using the formula in
 Remark~\ref{rem-disc-simple} we see that the discriminant of $g_0(x)$
 is $-4\tm(-27)-27=81=9^2$, whereas the discriminant of $g_1(x)$ is 
 $-4\tm 27-27=-135$.  Thus, the Galois group for $g_0(x)$ is $A_3$, and
 the Galois group for $g_1(x)$ is $\Sg_3$.
\end{solution}
\begin{exercise}\exlabel{ex-cyclic-cubic}
 Let $q$ be a rational number, and put $r=1+q+q^2$.  Consider the
 polynomials 
 \begin{align*}
  f(x) &= x^3 - (3x - 2q - 1)r \\
  g(x) &= x^3 + 3qx^2 - 3(q+1)x - (4q^3+6q^2+6q+1) \\
  s(x) &= x^2 +qx -2r.
 \end{align*}
 Check (with assistance from Maple if necessary) that
 $f(s(x))=f(x)g(x)$.  For the rest of the exercise we will assume that
 $q$ has been chosen so that $f(x)$ is irreducible.

 Now suppose we have a field $L$ and an element $\al\in L$ with
 $f(\al)=0$.  Show that $s(\al)$ is also a root of $f(x)$ in
 $\Q(\al)$, and is different from $\al$.  Deduce that $\Q(\al)$ is a
 splitting field for $f(x)$ over $\Q$, and that $G(\Q(\al)/\Q)$ is
 cyclic of order $3$.
\end{exercise}
\begin{solution}
 The first claim can be checked using Maple as follows:
\begin{verbatim}
 r := 1 + q + q^2;
 f := (x) -> x^3 - (3*x - 2*q - 1)*r;
 g := (x) -> (x^3+3*q*x^2-3*(q+1)*x-(4*q^3+6*q^2+6*q+1));
 s := (x) -> x^2+q*x-2*r;
 expand(f(s(x)) - f(x)*g(x));
\end{verbatim}
 It is possible but painful to do this by hand; $f(s(x))$ has 25 terms
 when fully expanded.

 Now suppose we have $\al\in L$ with $f(\al)=0$, and we put
 $\bt=s(\al)\in\Q(\al)$.  We can substitute $x=\al$ in the relation
 $f(s(x))=f(x)g(x)$ to see that $f(\bt)=f(\al)g(\al)=0$, so $\bt$ is
 another root of $f(x)$.  Next, as $f(x)$ is assumed to be
 irreducible, it must be the minimal polynomial of $\al$, so
 $\Q(\al)\simeq\Q[x]/f(x)$.  This means that homomorphisms from
 $\Q(\al)$ to any field $M$ biject with roots of $f(x)$ in $M$.  In
 particular, we can take $M=\Q(\al)$ and we find that there is a
 homomorphism $\sg\:\Q(\al)\to\Q(\al)$ with $\sg(\al)=\bt$.  

 We next claim that $\bt\neq\al$, or equivalently that $\al$ is not a
 root of the quadratic polynomial $s(x)-x$.  This is clear because the
 minimal polynomial of $\al$ is $f(x)$, which is cubic, so it cannot
 divide $s(x)-x$.  It follows that $f(x)$ is divisible in $\Q(\al)[x]$
 by $(x-\al)(x-\bt)$.  The remaining factor is a monic polynomial
 of degree $1$, so it must have the form $x-\gm$ for some
 $\gm\in\Q(\al)$.  We now have a splitting
 $f(x)=(x-\al)(x-\bt)(x-\gm)$, so $\Q(\al)$ is a splitting field for
 $f(x)$.  This means that it is normal, and the order of the Galois
 group is $[\Q(\al):\Q]=3$.  All groups of order $3$ are cyclic, and
 $\sg$ is a nontrivial element, so we must have
 $G(\Q(\al)/\Q)=\{1,\sg,\sg^2\}$. 
\end{solution}
\begin{exercise}\exlabel{ex-inv-sq-sum}
 Suppose that the polynomial $f(x)=x^3+ux^2+vx+w$ hs three distinct
 roots, namely $\al$, $\bt$ and $\gm$.  Give a formula for 
 \[ p = \frac{1}{\al^2} + \frac{1}{\bt^2} + \frac{1}{\gm^2} \]
 in terms of $u$, $v$ and $w$.
\end{exercise}
\begin{solution}
 First, we have 
 \[ x^3+ux^2+vx+w = f(x) = (x-\al)(x-\bt)(x-\gm) = 
     x^3 - (\al+\bt+\gm) x^2 + (\al\bt+\bt\gm+\gm\al) x - \al\bt\gm,
 \]
 so 
 \begin{align*}
  u &= -\al-\bt-\gm \\
  v &= \al\bt+\bt\gm+\gm\al \\
  w &= -\al\bt\gm.
 \end{align*}
 It follows that 
 \[ w^2p = \al^2\bt^2 + \bt^2\gm^2 + \gm^2\al^2. \]
 This is similar to $v^2$, but not equal to it.  More precisely, we
 have 
 \[ v^2 = \al^2\bt^2 + \bt^2\gm^2 + \gm^2\al^2 +
          2(\al^2\bt\gm + \al\bt^2\gm + \al\bt\gm^2) 
        = w^2p + 2uw.
 \]
 Rearranging this gives $p=v^2/w^2-2u/w$.
\end{solution}
\begin{exercise}\exlabel{ex-vandermonde}
 Suppose $f(x)=x^3+ax+b$. If $f$ has roots $\al$, $\bt$ and
 $\gm$, then recall that its discriminant $\Dl(f)$ is
 $(\al-\bt)^2(\al-\gm)^2(\bt-\gm)^2$.  Let $M$ denote
 the matrix
 \[ M=
     \begin{pmatrix}
      1&1&1\\
      \al&\bt&\gm\\
      \al^2&\bt^2&\gm^2
     \end{pmatrix}.
 \]
 \begin{itemize}
  \item[(a)] Define $\dl(f)=(\al-\bt)(\bt-\gm)(\gm-\al)$. Show that
   $\dl(f)=\det(M)$.
  \item[(b)] Thus $\Dl(f)=\dl(f)^2$.  Given that $\det(M)=\det(M^T)$,
   deduce that $\Dl(f)=\det(MM^T)$.
  \item[(c)] Write $S_i=\al^i+\bt^i+\gm^i$. Show that
   \[ MM^T =
        \begin{pmatrix}
         S_0&S_1&S_2\\
         S_1&S_2&S_3\\
         S_2&S_3&S_4
        \end{pmatrix}.
   \]
  \item[(d)] Clearly $S_0=3$ and $S_1=0$ (as $S_1$ is the sum of the
   roots, which is zero as the coefficient of $x^2$ in $f$ is
   zero). Show that $S_2=-2a$ by an explicit computation. 
  \item[(e)] As $\al$, $\bt$ and $\gm$ are roots of $f$, we have
   \begin{align*}
    \al^3+a\al+b &= 0\\
    \bt^3+a\bt+b &= 0\\
    \gm^3+a\gm+b &= 0.
   \end{align*}
   By summing these three, find $S_3$ in terms of $S_0$ and
   $S_1$.  Similarly, multiplying these equations by $\al$, $\bt$ and
   $\gm$ respectively, find $S_4$ in terms of $S_1$ and $S_2$. Compute
   the values of $S_3$ and $S_4$ in terms of $a$ and $b$.
  \item[(f)] Combining all the above, show that $\Dl(f)=-(4a^3+27b^2)$.
 \end{itemize}
\end{exercise}
\begin{solution}
 \begin{itemize}
  \item[(a)] One approach is to simply expand everything out.
   Alternatively, we can recall the behaviour of determinants under
   row and column operations, and argue as follows:
   \[ \det\bsm 1&1&1\\ \al&\bt&\gm\\ \al^2&\bt^2&\gm^2\esm = 
      \det\bsm 1&0&0\\ \al&\bt-\al&\gm-\al\\
                \al^2&\bt^2-\al^2&\gm^2-\al^2\esm = 
      (\bt-\al)(\gm-\al)
      \det\bsm 1&0&0\\ \al&1 &1 \\
                \al^2&\bt+\al&\gm+\al\esm = 
      (\bt-\al)(\gm-\al)(\gm-\bt) = \dl(f).
   \]
   (At the first stage we subtracted the first column from each of the
   other two columns, then we extracted factors of $\bt-\al$ and
   $\gm-\al$ from the second and third columns, then we calculated the
   final determinant directly.)
  \item[(b)] We have
   \[ \det(MM^T) = \det(M)\det(M^T) = \det(M)^2 = \dl(f)^2 = \Dl(f).
   \] 
  \item[(c)] This is just a direct calculation:
   \[ \begin{pmatrix}
      1&1&1\\
      \al&\bt&\gm\\
      \al^2&\bt^2&\gm^2
     \end{pmatrix}
     \begin{pmatrix}
      1&\al&\al^2\\
      1&\bt&\bt^2\\
      1&\gm&\gm^2
     \end{pmatrix} = 
     \begin{pmatrix}
      1+1+1&\al+\bt+\gm&\al^2+\bt^2+\gm^2\\
      \al+\bt+\gm&\al^2+\bt^2+\gm^2&\al^3+\bt^3+\gm^3\\
      \al^2+\bt^2+\gm^2&\al^3+\bt^3+\gm^3&\al^4+\bt^4+\gm^4.
     \end{pmatrix}
   \] 
  \item[(d)] We have
   \[ S_2=\al^2+\bt^2+\gm^2 = 
       (\al+\bt+\gm)^2-2(\al\bt+\bt\gm+\gm\al)=-2a,
   \]
   as $\al+\bt+\gm=S_1=0$ and $\al\bt+\bt\gm+\gm\al=a$.
  \item[(e)] Add the three equations to get
   \[ (\al^3+\bt^3+\gm^3)+a(\al+\bt+\gm)+b(1+1+1)=0, \]
   or $S_3+aS_1+bS_0=0$. Thus $S_3=-aS_1-bS_0$. Also, add
   \begin{align*}
    \al^4+a\al^2+b\al &= 0 \\
    \bt^4+a\bt^2+b\bt &= 0 \\
    \gm^4+a\gm^2+b\gm &= 0
   \end{align*}
   to get $S_4=-aS_2-bS_1$. Thus we conclude that
   \begin{align*}
     S_3 &= -3b\\
     S_4 &= 2a^2.
   \end{align*}
  \item[(f)] Substituting the values of $S_0,\ldots,S_4$ into the
   matrix in (c), we get:
   \[ MM^T =
      \begin{pmatrix}
       3   & 0   & -2a  \\
       0   & -2a & -3b  \\
       -2a & -3b & 2a^2
      \end{pmatrix}.
   \]
   By part~(b), $\Dl(f)$ is the determinant of this matrix, which can
   be evaluated directly to give $\Dl(f)=-(4a^3+27b^2)$.
 \end{itemize}
\end{solution}


\section{Quartics}
\label{sec-quartics}

Let $f(x)$ be an irreducible quartic over $\Q$, with roots
$R=\{\al,\bt,\gm,\dl\}$ say.  Let $K=\Q(\al,\bt,\gm,\dl)$ be the
splitting field, and let $G=G(K/\Q)$ be the Galois group.  This is
then a transitive subgroup of $\Sg_R$.  Our first task will be to
classify such subgroups.

First note that $|\Sg_R|=4!=24$.  The elements can be listed as
follows. 
\begin{itemize}
 \item The identity element has order $1$.
 \item There are six transpositions
  ($(\al;\bt),\;(\al\;\gm),\;(\al\;\dl),\;(\bt\;\gm),\;(\bt\;\dl)$ and
  $(\gm\;\dl)$), each of order $2$.
 \item There are three transposition pairs, which again have order
  $2$:
  \begin{align*}
   \tau_1 &= (\al\;\bt)(\gm\;\dl) \\
   \tau_2 &= (\al\;\gm)(\bt\;\dl) \\
   \tau_3 &= (\al\;\dl)(\bt\;\gm).
  \end{align*}
 \item There are eight three-cycles, each of order three.
 \item There are six four-cycles, each of order $4$.
\end{itemize}

One crucial fact is as follows:
\begin{proposition}\lbl{prop-vier}
 The set $V=\{1,\tau_1,\tau_2,\tau_3\}$ is a normal subgroup of
 $\Sg_R$, isomorphic to $C_2\tm C_2$.  It is also transitive.  For
 each $\sg\in\Sg_R$ there is a unique permutation $\ov{\sg}\in\Sg_3$
 such that $\sg\tau_i\sg^{-1}=\tau_{\ov{\sg}(i)}$ for all $i$.
 Moreover, the rule $\pi(\sg)=\ov{\sg}$ defines a surjective
 homomorphism of groups $\pi\:\Sg_R\to\Sg_3$, with kernel $V$.
\end{proposition}

\begin{remark}\lbl{rem-resolvent}
 This connection between $\Sg_R$ and $\Sg_3$ allows us to relate
 cubics to quartics.  More precisely, we will later write down a cubic
 polynomial $h(x)\in\Q[x]$ (called the \emph{resolvent cubic} of
 $f(x)$) such that $K^{G\cap V}$ is a splitting field for $h(x)$.  The
 full field $K$ can then be obtained by adjoining at most two square
 roots to $K^{G\cap V}$. 
\end{remark}

Before the proof, we will give a sample calculation with $\pi$.
Consider the three-cycle $\sg=(\al\;\bt\;\gm)$, so
$\sg^{-1}=(\gm\;\bt\;\al)$.  We have  
\begin{align*}
 \sg\tau_1\sg^{-1} &= 
  (\al\;\bt\;\gm)(\al\;\bt)(\gm\;\dl)(\gm\;\bt\;\al) = 
  (\al\;\dl)(\bt\;\gm) = \tau_3 \\
 \sg\tau_2\sg^{-1} &= 
  (\al\;\bt\;\gm)(\al\;\gm)(\bt\;\dl)(\gm\;\bt\;\al) = 
  (\al\;\bt)(\gm\;\dl) = \tau_1 \\
 \sg\tau_3\sg^{-1} &= 
  (\al\;\bt\;\gm)(\al\;\dl)(\bt\;\gm)(\gm\;\bt\;\al) = 
  (\al\;\gm)(\bt\;\dl) = \tau_2.
\end{align*}
The first line shows that $\ov{\sg}(1)=3$, the second that
$\ov{\sg}(2)=1$, and the third that $\ov{\sg}(3)=2$.  It follows that
$\ov{\sg}=(1\;3\;2)\in\Sg_3$.

\begin{proof}[Proof of Proposition~\ref{prop-vier}]
 One can check directly that $\tau_i^2=1$ for all $i$ and 
 \begin{align*}
  \tau_1\tau_2 &= \tau_2\tau_1 = \tau_3 \\
  \tau_2\tau_3 &= \tau_3\tau_2 = \tau_1 \\
  \tau_3\tau_1 &= \tau_1\tau_3 = \tau_2.
 \end{align*}
 (More succinctly, the product of any two $\tau$'s is the third one.)
 This shows that $V$ is a subgroup of $\Sg_R$.  The subgroups
 generated by $\tau_1$ and $\tau_2$ are cyclic of order $2$, and $V$
 is the direct product of these subgroups, so $V\simeq C_2\tm C_2$.

 Next, recall that any conjugate of a transposition pair is another
 transposition pair.  More precisely, for any $\sg\in\Sg_R$ and any
 transposition pair $(\kp\;\lm)(\mu\;\nu)$ we have
 \[ \sg(\kp\;\lm)(\mu\;\nu)\sg^{-1} = 
    (\sg(\kp)\;\sg(\lm))(\sg(\mu)\;\sg(\nu)).
 \]
 As $\tau_1$, $\tau_2$ and $\tau_3$ are the only transposition pairs,
 we must have $\sg\tau_i\sg^{-1}=\tau_j$ for some $j$.  We define
 $\ov{\sg}(i)$ to be this $j$, so
 $\sg\tau_i\sg^{-1}=\tau_{\ov{\sg}(j)}$.  Now if we have another
 permutation $\rho$ we find that
 \[ \tau_{\ov{\rho\sg}(i)} = \rho\sg\tau_i(\rho\sg)^{-1} = 
     \rho\sg\tau_i\sg^{-1}\rho^{-1} = \rho\tau_{\ov{\sg}(i)}\rho^{-1}
      = \tau_{\ov{\rho}(\ov{\sg}(i))},
 \] 
 so $\ov{\rho\sg}=\ov{\rho}\circ\ov{\sg}$.  In particular, we can take
 $\rho=\sg^{-1}$ and we find that $\ov{\rho}$ is an inverse for
 $\ov{\sg}$, so $\ov{\sg}$ is a permutation of $\{1,2,3\}$.  In
 particular, we see from this that $\sg V\sg^{-1}=V$, so $V$ is a
 normal subgroup of $\Sg_R$.  We can now define $\pi\:\Sg_R\to\Sg_3$
 by $\pi(\sg)=\ov{\sg}$, and the relation
 $\ov{\rho\sg}=\ov{\rho}\circ\ov{\sg}$ tells us that this is a
 homomorphism.

 Note that $V$ is commutative, so if $\sg\in V$ then
 $\sg\tau_i\sg^{-1}=\tau_i\sg\sg^{-1}=\tau_i$, so $\ov{\sg}$ is the
 identity.  We therefore have $V\leq\ker(\pi)$.
 
 Next, using the formula above for conjugating transposition pairs, we
 find that 
 \begin{align*}
  (\bt\;\gm) \tau_1 (\bt\;\gm)^{-1} &= \tau_2 & 
  (\gm\;\dl) \tau_1 (\gm\;\dl)^{-1} &= \tau_1 \\ 
  (\bt\;\gm) \tau_2 (\bt\;\gm)^{-1} &= \tau_1 & 
  (\gm\;\dl) \tau_2 (\gm\;\dl)^{-1} &= \tau_3 \\ 
  (\bt\;\gm) \tau_3 (\bt\;\gm)^{-1} &= \tau_3 & 
  (\gm\;\dl) \tau_3 (\gm\;\dl)^{-1} &= \tau_2, 
 \end{align*}
 so $\pi((\bt\;\gm))=(1\;2)$ and $\pi((\gm\;\dl))=(2\;3)$.  Thus, the
 image of $\pi$ is a subgroup of $\Sg_3$ containing $(1\;2)$ and
 $(2\;3)$, but it is straightforward to check that the only such
 subgroup is $\Sg_3$ itself, so $\pi$ is surjective.  The First
 Isomorphism Theorem for groups then gives
 $\Sg_R/\ker(\pi)\simeq\Sg_3$, so
 $|\ker(\pi)|=|\Sg_R|/|\Sg_3|=24/6=4$.  On the other hand, we also
 have $V\leq\ker(\pi)$ and $|V|=4$.  We must therefore have
 $\ker(\pi)=V$ as claimed.
\end{proof}

We next explain in more detail the Galois-theoretic significance of
$V$ and $\pi$.  We put 
\begin{align*}
 \mu_1 &= \tfrac{1}{2}((\al+\bt)-(\gm+\dl)) & \lm_1 &= \mu_1^2 \\
 \mu_2 &= \tfrac{1}{2}((\al+\gm)-(\bt+\dl)) & \lm_2 &= \mu_2^2 \\
 \mu_3 &= \tfrac{1}{2}((\al+\dl)-(\bt+\gm)) & \lm_3 &= \mu_3^2 \\
 K_0   &= \Q(\lm_1,\lm_2,\lm_3) \sse K.
\end{align*}
The factor of $1/2$ is included for later convenience.  Note that
$\mu_1+\mu_2=\al-\dl$ and $\mu_1-\mu_2=\bt-\gm$.  These are
nonzero so $\mu_1\neq\pm\mu_2$, so $\lm_1\neq\lm_2$.  We can do the
same for $\mu_1\pm\mu_3$ and $\mu_2\pm\mu_3$ so we find that all the
numbers $\pm\mu_i$ are distinct, and all the numbers $\lm_i$ are
distinct.  

Because the roots are grouped in $\mu_i$ the same way that they are in
$\tau_i$, we find that
\[ \sg(\mu_i) = \pm\mu_{\ov{\sg}(i)}
    \hspace{5em}
   \sg(\lm_i) = \lm_{\ov{\sg}(i)}
\]
for all $\sg\in G$ and $i\in\{1,2,3\}$.  It follows that
$\sg|_{K_0}=1_{K_0}$ iff $\ov{\sg}=1$ iff $\sg\in V\cap G$.  This
means that $V\cap G=G(K/K_0)$ and so (by the Galois Correspondence)
$K_0=K^{V\cap G}$.  As $V\cap G$ is normal in $G$ we deduce that $K_0$
is a Galois extension of $\Q$ with Galois group 
$G/(V\cap G)\simeq\pi(G)\leq\Sg_3$, and also $K$ is Galois over $K_0$
with Galois group $V\cap G$.  

To understand the extension $K_0/\Q$ in more detail, consider the
polynomial 
\begin{align*}
 g(x) &= (x-\lm_1)(x-\lm_2)(x-\lm_3) \\
  &= x^3 - (\lm_1+\lm_2+\lm_3) x^2 + 
     (\lm_1\lm_2+\lm_2\lm_3+\lm_3\lm_1) x - \lm_1\lm_2\lm_3.
\end{align*}
As $G$ permutes the elements $\lm_i$ and the coefficients of $g$ are
symmetric in these elements, we see that these coefficients lie in
$K^G=\Q$, so $g(x)\in\Q[x]$.  Thus $g(x)$ is a cubic over $\Q$ (called
the \emph{resolvent cubic} for $f(x)$) and $K_0$ is a splitting field
for $g(x)$.  Later we will give formulae for the coefficients of
$g(x)$ in terms of the coefficients of $f(x)$.  Once we know $g(x)$ we
can find the roots $\lm_i$ by the methods of
Section~\ref{sec-cubics}.  We can then find $\mu_i=\pm\sqrt{\lm_i}$.
We also note that the element $a=-(\al+\bt+\gm+\dl)$ is just the
coefficient of $x^3$ in $f(x)$, so we can find the roots of $f(x)$ by
the formulae 
\begin{align*}
 \al &= (+\mu_1+\mu_2+\mu_3)/2-a/4 \\
 \bt &= (+\mu_1-\mu_2-\mu_3)/2-a/4 \\
 \gm &= (-\mu_1+\mu_2-\mu_3)/2-a/4 \\
 \dl &= (-\mu_1-\mu_2+\mu_3)/2-a/4.
\end{align*}
The only issue here is to control the signs of the elements
$\mu_i=\pm\sqrt{\lm_i}$.  Suppose that 
\[ f(x) = (x-\al)(x-\bt)(x-\gm)(x-\dl) = 
    x^4 + ax^3 + bx^2 + cx + d,
\]
so that 
\begin{align*}
 a &= -(\al+\bt+\gm+\dl) \\
 b &= \al\bt+\al\gm+\al\dl+\bt\gm+\bt\dl+\gm\dl \\
 c &= -(\al\bt\gm + \al\bt\dl + \al\gm\dl + \bt\gm\dl) \\
 d &= \al\bt\gm\dl.
\end{align*}
One can check directly (perhaps with assistance from Maple) that 
\[ \mu_1\mu_2\mu_3 = (4ab - a^3 - 8c)/8. \]

When solving the quartic, one can choose the signs of $\mu_1$ and
$\mu_2$ arbitrarily, but one should then define $\mu_3$ to be 
$(4ab-a^3-8c)/(8\mu_1\mu_2)$ so that the above identity holds.  It
then works out that $\mu_3$ is a square root of $\lm_3$, and the roots
of $f(x)$ can be found by the formulae displayed above.

The formulae simplify considerably if we assume that $f(x)$ has no
term in $x^3$, so $\al+\bt+\gm+\dl=0$.  This does not really lose any
generality: if $f(x)=x^4+ax^3+bx^2+cx+d$ then one can check that the
polynomial $f(x-a/4)$ has no term in $x^3$, and if we know the roots
of $f(x-a/4)$ we can just subtract $a/3$ to get the roots of $f(x)$.  

If $\al+\bt+\gm+\dl=0$ then we find that 
\begin{align*}
 \mu_1 &= \al+\bt & -\mu_1 &= \gm+\dl & 
  \lm_1 &= (\al+\bt)^2=(\gm+\dl)^2 \\
 \mu_2 &= \al+\gm & -\mu_2 &= \bt+\dl & 
  \lm_2 &= (\al+\gm)^2=(\bt+\dl)^2 \\
 \mu_3 &= \al+\dl & -\mu_3 &= \bt+\gm & 
  \lm_3 &= (\al+\dl)^2=(\bt+\gm)^2 
\end{align*}
It follows that $\mu_1\mu_2\mu_3=-c$.  We can now expand out the
definition of $g(x)$ to obtain the following result:

\begin{proposition}\lbl{prop-resolvent}
 For a quartic polynomial of the form $f(x)=x^4+bx^2+cx+d$, the
 resolvent cubic is given by 
 \[ g(x) = x^3+2bx^2+b^2x-4dx-c^2. \qed \]
\end{proposition}

We now continue our investigation of which subgroups of $\Sg_R$ can
appear as Galois groups.

\begin{proposition}\lbl{prop-vier-converse}
 Suppose that $H$ is a transitive subgroup of $\Sg_R$ such that
 $|H|=4$, and that $H$ contains no elements of order $4$.  Then
 $H=V$. 
\end{proposition}
\begin{proof}
 Suppose that $\sg\in H$ with $\sg\neq 1$.  By Lagrange's Theorem the
 order of $\sg$ must divide $|H|=4$, but by assumption the order is
 not equal to $4$, so the order must be two.  This means that $\sg$ is
 either a transposition or a transposition pair.  Suppose that $\sg$
 is a transposition; then there exists a root $\lm$ with
 $\sg(\lm)=\lm$.  Put $K=\stab_H(\lm)=\{\rho\in H\st\rho(\lm)=\lm\}$,
 so $\{1,\sg\}\sse K$, so $|K|>1$, so $|H|/|K|<4$.  However, the
 Orbit-Stabiliser Theorem tells us that $|H\lm|=|H|/|K|$, so
 $|H\lm|<4$, so $H\lm\neq R$.  This contradicts the assumption that
 $H$ is transitive.  It follows that all nontrivial elements of $H$
 must actually be transposition pairs, but there are only three
 transposition pairs in $\Sg_R$, so all of them must be in $H$, so
 $H=V$.
\end{proof}

\begin{definition}\lbl{defn-Qi}
 For $i\in\{1,2,3\}$ we put $Q_i=\{\sg\in\Sg_R\st\ov{\sg}(i)=i\}$.  
\end{definition}

\begin{proposition}\lbl{prop-dihedral}
 $Q_i$ is a dihedral group of order $8$, and is transitive.  Moreover,
 these are the only subgroups of order $8$ in $\Sg_R$.
\end{proposition}
\begin{proof}
 We first consider $Q_2$.  Let $\rho$ be the four-cycle
 $(\al\;\bt\;\gm\;\dl)$.  Note that
 $\rho^2=(\al\;\gm)(\bt\;\dl)=\tau_2$, so
 $\rho\tau_2\rho^{-1}=\tau_2$, so $\ov{\rho}(2)=2$, so $\rho\in Q_2$.
 On the other hand, we have 
 \begin{align*}
  \rho\tau_1\rho^{-1} &= (\rho(\al)\;\rho(\bt))(\rho(\gm)\;\rho(\dl))
   = (\bt\;\gm)(\dl\;\al) = \tau_3 \\
  \rho\tau_3\rho^{-1} &= (\rho(\al)\;\rho(\dl))(\rho(\bt)\;\rho(\gm))
   = (\bt\;\al)(\gm\;\dl) = \tau_1,
 \end{align*}
 so $\ov{\rho}=(1\;3)$.  If $\sg\in Q_2$ then $\ov{\sg}$ must either
 be the identity or $(1\;3)$.  If $\ov{\sg}=1$ then
 $\sg\in\ker(\pi)=V$.  If $\ov{\sg}=(1\;3)=\ov{\rho}$ then we find
 that $\sg\rho^{-1}\in\ker(\pi)=V$, so $\sg\in V\rho$.  It follows
 that $Q_2=V\amalg V\rho$, which has order $8$.  One can also check
 that $\tau_1\rho\tau_1^{-1}=\rho^{-1}$, which mean that $\tau_1$ and
 $\rho$ generate a group isomorphic to $D_8$, which must be all of
 $Q_2$.  As $V$ is transitive and $V\leq Q_2$ we also see that $Q_2$
 is transitive.  One can show in the same way that $Q_1$ and $Q_3$ are
 also transitive and isomorphic to $D_8$.

 Now let $H$ be an arbitrary subgroup of $\Sg_R$ with $|H|=8$.  We
 then have subgroups $\pi(H)\leq\Sg_3$ and
 $H\cap V=\ker(\pi\:H\to\pi(H))\leq V$, and the First Isomorphism
 Theorem tells us that $|H\cap V||\pi(H)|=|H|=8$.  Here $|H\cap V|$
 must divide $|V|=4$ and $|\pi(H)|$ must divide $|\Sg_3|=6$.  The only
 possibility is $|\pi(H)|=2$ and $|H\cap V|=4=|V|$.  This means that
 $H\cap V=V$ (or in other words, that $V\leq H$) and that
 $\pi(H)=\{1,\sg\}$ for some transposition $\sg\in\Sg_3$.  If
 $\sg=(1\;2)$ we see that $H\leq Q_3$, but $|H|=8=|Q_3|$ so $H=Q_3$.
 Similarly, if $\sg=(1\;3)$ then $H=Q_2$, and if $\sg=(2\;3)$ then
 $H=Q_1$. 
\end{proof}

One can check directly that in any group isomorphic to $D_8$ there is
a unique cyclic subgroup of order $4$.  We can thus do the following:
\begin{definition}\lbl{defn-Pi}
 We write $P_i$ for the unique cyclic subgroup of order $4$ in $Q_i$.
\end{definition}

\begin{proposition}\lbl{prop-C-four}
 The groups $P_i$ are all different, and they are the only cyclic
 subgroups of order $4$ in $\Sg_R$.
\end{proposition}
\begin{proof}
 First, we have $Q_i=P_iV$, and the subgroups $Q_i$ are all different,
 so the subgroups $P_i$ are all different.  Each $P_i$ contains
 precisely two elements of order $4$ (each inverse to the other).  The
 elements of order $4$ are the four-cycles, and there are only six of
 them in $\Sg_R$.  Thus, there cannot be any further cyclic subgroups
 of order $4$.
\end{proof}

\begin{lemma}\lbl{lem-half-normal}
 Let $G$ be a finite group, and let $H$ be a subgroup such that
 $|G|=2|H|$.  Then $H$ is normal in $G$.
\end{lemma}
\begin{proof}
 Put $C=G\sm H$, so $|C|=|G|-|H|=|H|$.  Suppose that $g\in G$; we must
 show that $gHg^{-1}=H$.  If $g\in H$ then this is clear.  If
 $g\not\in H$, then the left coset $gH$ is disjoint from $H$ and so is
 contained in $C$, but $|gH|=|H|=|C|$ so $gH=C$.  Similarly, the right
 coset $Hg$ is disjoint from $H$ and has the same size as $C$ so it is
 equal to $C$.  We now have $gH=Hg$ and we can multiply on the right
 by $g^{-1}$ to get $gHg^{-1}=H$ as required.
\end{proof}

\begin{proposition}\lbl{prop-alternating}
 The only subgroup of $\Sg_R$ of order $12$ is the group $A_R$ of even
 permutations of $R$.
\end{proposition}
\begin{proof}
 Suppose that $|H|=12$.  By the lemma, we see that $H$ is normal so we
 have a quotient group $G/H\simeq C_2$ and a quotient homomorphism
 $q\:G\to G/H$ with kernel $H$.  Let $x$ denote the nontrivial element
 of $G/H$.  Recall that all the transpositions in $\Sg_R$ are
 conjugate to each other.  Thus, if $H$ contains any transposition
 then it must contain all of them, but the transpositions generate
 $\Sg_R$, so $H=\Sg_R$, contradicting the fact that $|H|=12$.  It
 follows that for all transpositions $\sg$ we have $q(\sg)=x$.  Now if
 $\rho$ is an even permutation then it can bew written as a product of
 $2m$ transpositions, say, which gives $q(\rho)=x^{2m}=1$, so
 $\rho\in H$.  This shows that $A_R\leq H$ but $|A_R|=12=|H|$ so
 $H=A_R$. 
\end{proof}

\begin{proposition}\lbl{prop-transitive}
 The transitive subgroups of $\Sg_R$ are as follows:
 $V,P_1,P_2,P_3,Q_1,Q_2,Q_3,A_R$ and $\Sg_R$.  Thus, the Galois group
 $G$ must be one of these groups.
\end{proposition}
\begin{proof}
 Let $H$ be a transitive subgroup of $\Sg_R$.  
 As $H$ is transitive, the orbit $H\al$ is all of $R$, so $|H\al|=4$.
 Put $K=\stab_H(\al)=\{\sg\in H\st\sg(\al)=\al\}$.  The
 Orbit-Stabiliser Theorem tells us that $|H\al|=|H|/|K|$, so
 $|H|=4|K|$, which is divisible by $4$.  On the other hand, Lagrange's
 Theorem tells us that $|H|$ divides $|\Sg_R|=24$.  It follows that
 $|H|\in\{4,8,12,24\}$.  If $|H|=24$ then clearly $H=\Sg_R$.  If
 $|H|=12$ then Proposition~\ref{prop-alternating} tells us that
 $H=A_R$.  If $|H|=8$ then Proposition~\ref{prop-dihedral} tells us
 that $H=Q_i$ for some $i$.  If $|H|=4$ and $H$ contains an element of
 order $4$ then $H$ must be cyclic and Proposition~\ref{prop-C-four}
 tells us that $H=P_i$ for some $i$.  This just leaves the case where
 $|H|=4$ but $H$ has no element of order $4$, in which case
 Proposition~\ref{prop-vier-converse} tells us that $H=V$.
\end{proof}

\begin{remark}\lbl{rem-transitive}
 The subgroups $P_i$ are all conjugate to each other, so we can
 convert between them by just renaming the roots.  As the naming of
 the roots is arbitrary, it is not very meaningful to distingush
 between these subgroups.  The same applies to the subgroups $Q_i$.
 Thus, we can say that the Galois group is always $V$, $C_4$, $D_8$,
 $A_4$ or $\Sg_4$.  The inclusions between these subgroups can be
 displayed as follows:
 \[ \xymatrix{
     & & \Sg_4 \\
     & D_8 \urto & & A_4 \ulto \\
     C_4 \urto & & V \urto \ulto
    }
 \]
\end{remark}
\begin{remark}\lbl{rem-irr-resolvent}
 Consider a quartic $f(x)$ with resolvent $g(x)$.  If the Galois group
 of $f(x)$ is $H\leq\Sg_4$, then the Galois group of $g(x)$ is the
 image of $H$ in $\Sg_4/V\simeq\Sg_3$, which we will call $\ov{H}$.
 If $g(x)$ is irreducible then $\ov{H}$ must be transitive, and so
 must have order divisible by $3$.  It follows that $|H|$ must be
 divisible by $3$, and by inspecting the above list of possibilities
 we see that either $H=A_4$ and $\ov{H}=A_3$, or $H=\Sg_4$ and
 $\ov{H}=\Sg_3$.   
\end{remark}

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-classify-quartics}
 What are the Galois groups of the quartics $f_0(x)=x^4+8x+12$ 
 and $f_1(x)=x^4+8x-12$?  

 [{\sl Hint: You may assume that these are irreducible.
  Exercise~\ref{ex-classify-cubics} is relevant.}]
\end{exercise}
\begin{solution}
 Using the formula in Proposition~\ref{prop-resolvent}, we see
 that the resolvent cubic for $f_0(x)$ is
 $x^3-32x-64=64((x/4)^3-2(x/4)-1)$.  In the notation of
 Exercise~\ref{ex-classify-cubics}, this is $64 g_0(x/4)$, so the
 Galois group is the same as for $g_0(x)$, namely $A_3$.  Using
 Remark~\ref{rem-irr-resolvent} we deduce that the Galois group for
 $f_0(x)$ is $A_4$.  

 Similarly, the resolvent cubic for $f_1(x)$ is $64 g_1(x/4)$, and the
 Galois group for $g_1(x)$ is $\Sg_3$, so the Galois group for
 $f_1(x)$ is $\Sg_4$.
\end{solution}
\begin{exercise}\exlabel{ex-biquad-quartic}
 You are given that a quartic polynomial $f(x)$ has roots as follows:
 \[ \al_0 =  \sqrt{2}+\sqrt{5} \hspace{3em}
    \al_1 =  \sqrt{2}-\sqrt{5} \hspace{3em}
    \al_2 = -\sqrt{2}+\sqrt{5} \hspace{3em}
    \al_3 = -\sqrt{2}-\sqrt{5}.
 \]
 What is its discriminant? What is the Galois group?
\end{exercise}
\begin{solution}
 The discriminant is 
 \begin{align*}
   \prod_{i<j}(\al_i-\al_j)^2
    &= (\al_0-\al_1)^2(\al_0-\al_2)^2(\al_0-\al_3)^2
       (\al_1-\al_2)^2(\al_1-\al_3)^2(\al_2-\al_3)^2 \\
    &= (2\sqrt{5})^2 (2\sqrt{2})^2 (2\sqrt{2}+2\sqrt{5})^2
       (2\sqrt{2}-2\sqrt{5})^2 (2\sqrt{2})^2 (2\sqrt{5})^2 \\
    &= 2^{14}5^2 (\sqrt{5}+\sqrt{2})^2(\sqrt{5}-\sqrt{2})^2 \\
    &= 2^{14}5^2 (5-2)^2 = 2^{14} 3^2 5^2 = 3686400.
 \end{align*}
 The splitting field is $\Q(\sqrt{2},\sqrt{5})$, so the Galois group
 is $C_2\tm C_2$ by Proposition~\ref{prop-biquadratic}.
\end{solution}
\begin{exercise}\exlabel{ex-quartic-discriminant}
 Consider an irreducible quartic of the form $f(x)=x^4+px+q$, with
 roots $\al,\bt,\gm,\dl$ say.  You may assume that the discriminant is
 $\det(MM^T)$, where $M$ is the $4\tm 4$ matrix analogous to the one
 in Exercise~\ref{ex-vandermonde}.  Show that this gives
 $\Dl(f(x))=256q^3-27p^4$.
\end{exercise}
\begin{solution}
 We merely sketch this.  The matrix $M$ is
 \[  \begin{pmatrix}
      1     & 1     & 1     & 1         \\
      \al   & \bt   & \gm   & \delta    \\
      \al^2 & \bt^2 & \gm^2 & \delta^2  \\
      \al^3 & \bt^3 & \gm^3 & \delta^3
     \end{pmatrix}.
 \]
 If we put $S_i=\al^i+\bt^i+\gm^i+\delta^i$, then
 \[ MM^T = \begin{pmatrix}
            S_0 & S_1 & S_2 & S_3\\
            S_1 & S_2 & S_3 & S_4\\
            S_2 & S_3 & S_4 & S_5\\
            S_3 & S_4 & S_5 & S_6
           \end{pmatrix}.
 \]
 From the factorisation $f(x)=(x-\al)(x-\bt)(x-\gm)(x-\dl)$ we obtain
 \begin{align*}
  \al+\bt+\gm+\dl &= 0 \\
  \al\bt+\al\gm+\al\dl+\bt\gm+\bt\dl+\gm\dl &= 0 \\
  \al\bt\gm+\al\bt\dl+\al\gm\dl+\bt\gm\dl &= -p \\
  \al\bt\gm\dl &= q.
 \end{align*}
 From this we deduce that $S_0=4$, $S_1=0$ and $S_2=0$.  To compute $S_3$, use
 \begin{align*}
  \al^3+\bt^3+\gm^3+\delta^3 &=
    S_1^3
    -3(\al^2\bt+\mbox{similar terms})
    -6(\al\bt\gm+\mbox{similar terms}) \\
  \al^2\bt+\mbox{similar terms} &=
    S_1(\al\bt+\mbox{similar terms})
    -3(\al\bt\gm+\mbox{similar terms}) \\
  \al\bt\gm+\mbox{similar terms} &= -p.
 \end{align*}
 Combining these, together with $S_1=0$, we see that $S_3=-3p$.
 Using the same trick as in Exercise~\ref{ex-vandermonde}, we get that
 \begin{align*}
  S_4 &= -(pS_1+qS_0) =-4q  \\
  S_5 &= -(pS_2+qS_1) =0    \\
  S_6 &= -(pS_3+qS_2) =-3p^2
 \end{align*}
 and so
 \[ \Dl(f) = \det
     \begin{pmatrix}
      4   & 0   & 0   & -3p    \\
      0   & 0   & -3p & -4q    \\
      0   & -3p & -4q & 0      \\
      -3p & -4q & 0   & -3p^2
     \end{pmatrix} = 27p^4+256q^3.
 \] 
\end{solution}

\section{Cyclic extensions}
\label{sec-cyclic}

In this section we will study normal extensions $L/K$ for which the
Galois group is cyclic.

\begin{proposition}\lbl{prop-cyclic-ext}
 Let $K$ be a field of characteristic zero, and suppose that the
 polynomial $x^n-1$ is split in $K$.
 \begin{itemize}
  \item[(a)] If $L$ is a normal extension of $K$ and $G(L/K)$ is
   cyclic of order $n$, then there exists $\al\in K$ and $\bt\in L$
   such that $min(\bt,K)=x^n-\al$ and $L=K(\bt)$.  In other words, we
   have $L=K(\al^{1/n})$.
  \item[(b)] Conversely, if $L=K(\bt)$ for some $\bt$ with
   $\bt^n=\al\in K$, then $L$ is normal over $K$ and the Galois group
   $G(L/K)$ is cyclic, with order dividing $n$.  If the polynomial
   $x^n-\al\in K[x]$ is irreducible, then the order is precisely $n$. 
 \end{itemize}
\end{proposition}

The proof will follow after some preparatory results.

For $K$ as in the proposition, we see that the group 
\[ \mu_n = \{a\in K\st a^n=1\} \] 
has order $n$.  It is also cyclic by
Proposition~\ref{prop-units-cyclic}.  We can thus choose a generator
$\zt\in\mu_n$.  For $r=0,1,\dotsc,n-1$ we define a $K$-linear map
$\ep_r\:L\to L$ by 
\[ \ep_r(a) = \tfrac{1}{n} \sum_{i=0}^{n-1}\zt^{-ir}\sg^i(a).  \]

\begin{lemma}\lbl{lem-sg-ep}
 For all $a\in L$ we have $\sg(\ep_r(a))=\zt^r\,\ep_r(a)$. 
\end{lemma}
\begin{proof}
 We have $\sg|_K=1_K$ by assumption and $\zt\in K$ so
 $\sg(\ep_r(a))=n^{-1}\sum_{i=0}^{n-1}\zt^{-ir}\sg^{i+1}(a)$.  We can rewrite
 this in terms of the index $j=i+1$ as
 \[ \sg(\ep_r(a)) =
    n^{-1}\sum_{j=1}^n\zt^{r-jr}\sg^j = 
    \zt^r\sum_{j=1}^n\zt^{-jr}\sg^j.
 \]
 Here $\zt^{rn}=1=\zt^0$ and $\sg^n=1=\sg^0$ so we can replace the $j=n$
 term by the $j=0$ term to get
 $\sg(\ep_r(a))=\zt^r\sum_{j=0}^{n-1}\zt^{-rj}\sg^j(a)=\zt\ep_r(a)$ as
 claimed.
\end{proof}

\begin{lemma}\lbl{lem-circle-powers}
 For any $t\in\Z$ we have 
 \[ \tfrac{1}{n} \sum_{i=0}^{n-1}\zt^{it} = 
     \begin{cases} 
       1 & \text{ if } t = 0\pmod{n} \\
       0 & \text{ if } t\neq 0\pmod{n}.
      \end{cases}
 \]
\end{lemma}
\begin{proof}
 If $t=0\pmod{n}$ then $\zt^{it}=1$ for all $i$ so we just have
 $n^{-1}\sum_{i=0}^{n-1}1=1$ as claimed.  In general, the standard
 geometric progression argument shows that 
 \[ (\zt^t-1)\sum_{i=0}^{n-1} \zt^{it} = 
     (\zt^t+\zt^{2t}+\dotsb+\zt^{nt}) - 
     (1+\zt^{t}+\dotsb+\zt^{(n-1)t}) = \zt^{nt}-1 = 0. 
 \]
 If $t\neq 0\pmod{n}$ thn $\zt^t-1\neq 0$ so we can divide by it (and
 then by $n$) to see that $n^{-1}\sum_{i=0}^{n-1}\zt^{it}=0$ as
 claimed. 
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop-cyclic-ext}]
 \begin{itemize}
  \item[(a)] $L$ be an extension with cyclic Galois group
   $G=\{1,\sg,\dotsc,\sg^{n-1}\}\simeq C_n$ as in the last two lemmas.
   Proposition~\ref{prop-dedekind} tells us that the map $\ep_1\:L\to
   L$ is nonzero.  Choose $\lm\in L$ such that $\phi(\lm)\neq 0$, and
   put $\bt=\ep_1(\lm)\in L^\tm$.  By Lemma~\ref{lem-sg-ep} we have
   $\sg(\bt)=\zt\bt$, so $\sg(\bt^j)=\sg(\bt)^j=\zt^j\bt^j$.  From this
   it follows that
   \[ \sg^2(\bt^j)=\sg(\sg(\bt^j))=\sg(\zt^j\bt^j)=
       \zt^j\sg(\bt^j)=\zt^{2j}\bt^j.
   \]
   By continuing in the same way (or, more formally, by induction) we
   see that $\sg^i(\bt^j)=\zt^{ij}\bt^j$ for all $i,j\in\Z$.  As
   $\zt^n=1$, it follows that the element $\al=\bt^n$ has
   $\sg^i(\al)=\al$ for all $i$.  This means that $\al\in L^G$, but
   $L^G=K$ by the Galois Correspondence, so $\al\in K$.  We can now put
   $f(x)=x^n-\al\in K[x]$, and we see that $f(\bt)=0$.

   Next, we claim that 
   \[ \ep_r(\bt^j) = \begin{cases}
       \bt^j & \text{ if } r=j\pmod{n} \\
       0 & \text{ otherwise. }
      \end{cases}
   \]
   Indeed, from the definition and the fact that
   $\sg^i(\bt^j)=\zt^{ij}\bt^j$ we get
   \[ \ep_r(\bt^j) = 
       n^{-1} \sum_{i=0}^{n-1} \zt^{-ri}\sg^i(\bt^j) = 
       \bt^j n^{-1} \sum_{i=0}^{n-1} \zt^{(j-r)i},
   \]
   so the claim follows from Lemma~\ref{lem-circle-powers}.

   Next, we claim that the elements $1,\bt,\dotsc,\bt^{n-1}$ are
   linearly independent over $K$.  To see this, consider a linear
   relation $\sum_{i=0}^{n-1}a_i\bt^i=0$, with $a_i\in K$.  We can apply
   $\ep_r$ to both sides of this equation.  On the right hand side we
   get zero, and on the left hand side most terms become zero, but we
   have $\ep_r(a_r\bt^r)=a_r\bt^r$.  As $\bt\neq 0$ this gives $a_r=0$,
   but $r$ was arbitrary so our linear relation is the trivial one.  We
   conclude that the list $1,\bt,\dotsc,\bt^{n-1}$ is indeed linearly
   independent, or equivalently that $\bt$ is not a root of any
   polynomial in $K[x]$ of degree less than $n$.  Thus, the polynomial
   $f(x)=x^n-\al$ must actually be the minimal polynomial of $\bt$ over
   $K$.
  \item[(b)] Conversely, suppose we have an extension $L=K(\bt)$ such
   that the element $\al=\bt^n$ lies in $K$.  To avoid trivialities we
   may assume that $\bt\neq 0$.  Choose a generator $\zt$ of the group
   $\mu_n=\{a\in K\st a^n=1\}$.  We then see from the cyclotomic
   theory that $x^n-1=\prod_{k=0}^{n-1}(x-\zt^k)$ and thus that
   $x^n-\al=x^n-\bt^n=\prod_{k=0}^{n-1}(x-\zt^k\bt)$.  In particular
   we see that $L$ is a splitting field for $x^n-\al$ over $K$, so it
   is normal over $K$.  Next, for any $\sg\in G(L/K)$ we put
   $\lm(\sg)=\sg(\bt)/\bt$.  We can then apply $\sg$ to the equation
   $\bt^n=\al$ to see that $\sg(\bt)^n=\al$, which implies that
   $\lm(\sg)^n=1$, so $\lm(\sg)\in\mu_n\sse K^\tm$.  We claim that the
   map $\lm\:G(L/K)\to\mu_n$ is actually a group homomorphism.
   Indeed, if $\tau$ is another element of $G(L/K)$ we have
   $\tau(\lm(\sg))=\lm(\sg)$, because $\lm(\sg)\in K$.  We can
   therefore apply $\tau$ to the equation $\sg(\bt)=\lm(\sg)\,\bt$ to
   get $\tau(\sg(\bt))=\lm(\sg)\tau(\bt)=\lm(\sg)\lm(\tau)\bt$, which
   rearranges to give $\lm(\tau\sg)=\lm(\tau)\lm(\sg)$ as required.
   Next, we claim that $\lm$ is injective.  Indeed, if $\lm(\sg)=1$
   then $\sg(\bt)/\bt=1$ so $\sg(\bt)=\bt$, so $\sg$ acts as the
   identity on $K(\bt)$, but $K(\bt)=L$, so $\sg=1$ as required.  It
   follows that $\lm$ gives an isomorphism from $G(L/K)$ to a subgroup
   of $\mu_n$.  We know from Proposition~\ref{prop-units-cyclic} that
   $\mu_n$ is cyclic, and it follows that $G(L/K)$ is cyclic as
   claimed.  If $x^n-\al$ is irreducible then $G(L/K)$ acts
   transitively on the set of roots, so for each $\xi\in\mu_n$ we can
   choose $\sg\in G(L/K)$ with $\sg(\bt)=\xi\bt$, so $\lm(\sg)=\xi$.
   In this case we see that $\lm$ is also surjective, so it is an
   isomorphism and therefore $|G(L/K)|=n$.
 \end{itemize}
\end{proof}

\section{Extension by radicals}
\label{sec-radicals}

The roots of a quadratic polynomial $f(x)=x^2+bx+c$ are of course
given by $(-b\pm\sqrt{b^2-4c})/2$.  To evaluate these, we need the
ordinary algebraic operations of addition, subtraction, multiplication
and division, and we also need to find a square root.  Similarly, to
solve a cubic by the method described in Section~\ref{sec-cubics} we
need algebraic operations, and we need to extract some square roots
and some cube roots.  For quartics, we use the same type of operations
to solve the resolvent cubic, and then we take some further square
roots as part of the process of finding roots of the original
equation.  More generally, we say that a polynomial $f(x)$ is
\emph{solvable by radicals} if all the roots can be found using only
algebraic operations and extraction of roots.  It turns out that most
quintics are \emph{not} solvable by radicals, so there cannot be any
general for solving quintics similar to that for quadratics, cubics
and quartics.  In this section we will develop the theory necessary to
prove this.

The main idea is as follows.  We will define a property called
\emph{solvability} for finite groups.  Roughly speaking, a group is
solvable if it can be broken up into cyclic groups.
Proposition~\ref{prop-cyclic-ext} tells us that cyclic groups
correspond to field extensions generated by taking an $n$'th root.  It
follows that for a polynomial $f(x)$, we can find the roots of $f(x)$
by extracting roots if and only if the Galois group of the splitting
field is solvable.  For a typical polynomial of degree $d$ the Galois
group will be $\Sg_d$, and $\Sg_d$ is only solvable if $d\leq 4$.
Thus, all polynomials of degree less than or equal to four are
solvable by radicals, but most polynomials of higher degree are not. 

\begin{definition}\lbl{defn-solvable}
 Let $G$ be a finite group.  We say that $G$ is \emph{solvable} if
 there is a chain of subgroups $\{1\}=G_0\leq G_1\leq\dotsb\leq G_r=G$
 such that $G_{i-1}$ is normal in $G_i$, and the quotient groups
 $G_i/G_{i-1}$ are all cyclic.  Any such chain is called a
 \emph{solvable series} for $G$.
\end{definition}

\begin{remark}\lbl{rem-solvable-defn}
 It is more standard to say that $G$ is solvable if it has a chain as
 above in which the quotients $G_i/G_{i-1}$ are abelian (not
 necessarily cyclic).  We will see in
 Corollary~\ref{cor-solvable-defn} below that this is equivalent to
 our definition.
\end{remark}

\begin{definition}\lbl{defn-radical-extension}
 Let $K$ be a field, and let $L$ be an extension of $K$ of finite
 degree.  We say that $L$ is a \emph{radical extension} if there
 exist elements $\al_1,\dotsc,\al_r\in L$ and integers
 $n_1,\dotsc,n_r>0$ such that $L=K(\al_1,\dotsc,\al_r)$ and
 $\al_i^{n_i}\in K(\al_1,\dotsc,\al_{i-1})$ for all $i$.
\end{definition}

\begin{definition}\lbl{defn-solvable-poly}
 Let $K$ be a field, and let $f(x)$ be a monic polynomial in $K[x]$.
 We say that $f(x)$ is \emph{solvable by radicals} if there exists a
 radical extension $L/K$ such that $f(x)$ splits in $K[x]$.
\end{definition}

\begin{theorem}\lbl{thm-solvable-poly}
 Suppose that $K$ has characteristic zero.  Let $f(x)$ be a monic
 polynomial in $f(x)$, and let $N$ be a splitting field for $f(x)$.
 Then $f(x)$ is solvable by radicals if and only if the Galois group
 $G(N/K)$ is solvable.
\end{theorem}

One half of this will be proved as Proposition~\ref{prop-radicals-a}
below, and the converse half as Corollary~\ref{cor-radicals-b}.
First, however, we will give some examples and preliminary results
about solvable groups.

\begin{example}\lbl{eg-solvable-three}
 Consider the group $\Sg_3$.  The alternating subgroup $A_3$ is cyclic
 of order $3$, and the quotient $\Sg_3/A_3$ is cyclic of order $2$.
 We thus have a series $\{1\}<A_3<\Sg_3$ proving that $\Sg_3$ is
 solvable. 
\end{example}
\begin{example}\lbl{eg-solvable-four}
 Consider the group $\Sg_4$.  Put $C=\{1,(1\;2)(3\;4)\}$, which is
 cyclic of order $2$.  In the notation of Section~\ref{sec-quartics}
 we then have a series
 \[ \{1\} < C < V < A_4 < \Sg_4 \]
 with $C/\{1\}\simeq V/C\simeq\Sg_4/A_4\simeq C_2$ and
 $A_4/V\simeq C_3$, which shows that $\Sg_4$ is solvable.
\end{example}
\begin{example}\lbl{eg-An-unsolvable}
 We will show later that $\Sg_n$ and $A_n$ are not solvable if $n>4$. 
\end{example}
\begin{example}\lbl{eg-order-solvable}
 Let $G$ be a group of order $n$.  If $n$ is prime then $G$ is cyclic
 and therefore solvable.  If $n$ is a power of a prime, then $G$ is
 still solvable.  We will not give the proof here but it is a standard
 exercise in the theory of groups of prime power order.  If $n$
 involves only two primes, then $G$ is still solvable by a theorem of
 Burnside which is often covered in advanced undergraduate courses on
 Representation Theory.  More strikingly, if $n$ is odd then $G$ is
 automatically solvable.  This is a famous theorem of Feit and
 Thompson; the proof takes hundreds of pages and is only accessible to
 specialists in finite group theory.
\end{example}

\begin{proposition}\lbl{prop-abelian-solvable}
 Any finite abelian group is solvable.
\end{proposition}
\begin{proof}
 Let $G$ be a finite abelian group.  Put $G_0=\{1\}\leq G$.  If
 $G\neq G_0$, we choose an element $a_1\in G\sm G_0$, and let $G_1$ be
 the subgroup generated by $G_0$ together with $a_1$.  If $G\neq G_1$,
 we choose an element $a_2\in G\sm G_1$, and let $G_2$ be the subgroup
 generated by $G_1$ together with $a_2$.  Continuing in this way, we
 get a chain of subgroups
 \[ \{1\} = G_0 < G_1 < G_2 < \dotsb \leq G. \]
 As $G$ is finite and $G_i$ is strictly bigger than $G_{i-1}$, we must
 eventually reach a stage where $G_r=G$.  As everything is abelian,
 all subgroups are normal, so we can form quotient groups
 $G_i/G_{i-1}$.  As $G_i$ is generated by $G_{i-1}$ together with
 $a_i$, we see that $G_i/G_{i-1}$ is generated by the coset
 $a_iG_{i-1}$ and so is cyclic.  We therefore have a solvable series
 for $G$.
\end{proof}

\begin{proposition}\lbl{prop-subquotient}
 Let $G$ be a finite group, and let $H$ be a normal subgroup.  Put
 $\ov{G}=G/H$ and let $\pi\:G\to\ov{G}$ be the quotient homomorphism,
 so $\pi(g)=gH$.
 \begin{itemize}
  \item[(a)] If $K$ is any subgroup of $G$ such that $H\sse K$, then
   the set $\ov{K}=\pi(K)$ is a subgroup of $\ov{G}$ and is the same
   as $K/H$.  Moreover, we have $K=\{x\in G\st\pi(x)\in\ov{K}\}$.
  \item[(b)] Conversely, if $\ov{K}$ is any subgroup of $\ov{G}$ then
   the set $K=\{x\in G\st\pi(x)\in\ov{K}\}$ is a subgroup of $G$
   containing $H$, and we have $\ov{K}=\pi(K)=K/H$.
  \item[(c)] If $K$ and $\ov{K}$ are related as above, then $K$ is
   normal in $G$ if and only if $\ov{K}$ is normal in $\ov{G}$.  If
   so, then there is an isomorphism $G/K\to\ov{G}/\ov{K}$ given by
   $gK\mapsto\pi(g)\ov{K}$.
 \end{itemize}
\end{proposition}
\begin{proof}
 \begin{itemize}
  \item[(a)] The identity element $1_G$ lies in $K$, so the identity
   element $1_{\ov{G}}=\pi(1_G)$ lies in $\ov{K}$.  Suppose we have
   elements $\ov{a},\ov{b}\in\ov{K}$.  By the definition of $\ov{K}$,
   we can choose $a,b\in K$ with $\ov{a}=\pi(a)$ and $\ov{b}=\pi(b)$.
   As $K$ is a subgroup, we have $ab\in K$ and $a^{-1}\in K$.  It
   follows that $\pi(ab),\pi(a^{-1})\in\ov{K}$ but
   $\pi(ab)=\ov{a}\,\ov{b}$ and $\pi(a^{-1})=\ov{a}^{-1}$, so
   $\ov{a}\,\ov{b}\in\ov{K}$ and $\ov{a}^{-1}\in\ov{K}$.  This proves
   that $\ov{K}$ is a subgroup of $\ov{G}$.  The elements are just the
   cosets $xH$ for $x\in K$, which are the same as the elements of
   $K/H$; so $\ov{K}=K/H$.  Now consider the set
   $K'=\{x\in G\st \pi(x)\in\ov{K}\}$; we claim that this is the same
   as $K$.  If $x\in K$ then $\pi(x)\in\ov{K}$ by the definition of
   $\ov{K}$, so $x\in K'$ by the definition of $K'$.  Thus
   $K\sse K'$.  Conversely, suppose that $x\in K'$.  Then
   $\pi(x)\in\ov{K}=\pi(K)$, so $\pi(x)=\pi(y)$ for some $y\in K$.
   This means that $xH=yH$, so $x=yz$ for some $z\in H$.  However, we
   have $H\sse K$ by assumption, so $y$ and $z$ both lie in $K$, so
   $x\in K$.  This shows that $K'\sse K$, so in fact $K'=K$ as
   claimed.
  \item[(b)] Now let $\ov{K}$ be an arbitrary subgroup of $\ov{G}$,
   and put $K=\{x\in G\st\pi(x)\in\ov{K}\}$.  Clearly, if $x\in H$
   then $\pi(x)=1_{\ov{G}}\in\ov{K}$, so $x\in K$.  This proves that
   $H\sse K$, so in particular $1\in K$.  Now suppose we have alements
   $a,b\in K$.  This means that the elements $\pi(a)$ and $\pi(b)$ lie
   in $\ov{K}$, but $\ov{K}$ is a subgroup, so we have
   $\pi(a)\pi(b)\in\ov{K}$ and $\pi(a)^{-1}\in\ov{K}$.  As $\pi$ is a
   homomorphism we have $\pi(ab)=\pi(a)\pi(b)$, which lies in
   $\ov{K}$, so $ab\in K$.  Similarly we have
   $\pi(a^{-1})=\pi(a)^{-1}$, which lies in $\ov{K}$, so
   $a^{-1}\in K$.  This shows that $K$ is a subgroup of $G$ containing
   $H$.  From the very definition of $K$ we have $\pi(K)\sse\ov{K}$.
   Conversely, if $u\in\ov{K}\sse\ov{G}=G/H$ then we must have
   $u=xH=\pi(x)$ for some $x\in G$.  Now $\pi(x)\in\ov{K}$ so by the
   definition of $K$ we have $x\in K$.  This means that $u\in\pi(K)$.
   We thus have $\ov{K}\sse\pi(K)$, and so $\ov{K}=\pi(K)$ as
   claimed.
  \item[(c)] Let $K$ and $\ov{K}$ be related as discussed above.
   Suppose that $K$ is normal in $G$.  For any $\ov{a}\in\ov{G}$ we
   can choose $a\in G$ with $\pi(a)=\ov{a}$, and we note that
   $aKa^{-1}=K$  because $K$ is normal.  We thus have
   \[ \ov{a}\ov{K}\ov{a}^{-1}=\pi(a)\pi(K)\pi(a)^{-1}=\pi(aKa^{-1})=
       \pi(K)=\ov{K},
   \]
   which proves that $\ov{K}$ is normal in $\ov{G}$.  Conversely,
   suppose that $\ov{K}$ is normal in $\ov{G}$.  Consider an element
   $a\in G$, and the corresponding subgroup $K'=aKa^{-1}\leq G$.  Note
   that $K'$ contains $aHa^{-1}$, but $aHa^{-1}=H$ as $H$ is normal.
   We can thus apply part~(a) to $K'$ as well as to $K$.  The last
   claim in~(a) says that $K'=\{x\st\pi(x)\in\pi(K')\}$, whereas
   $K=\{x\st\pi(x)\in\pi(K)\}$.  Now
   $\pi(K')=\pi(a)\ov{K}\pi(a)^{-1}$, but this is just the same as
   $\ov{K}$, because $\ov{K}$ is assumed to be normal.  We thus have
   $K=K'$, which means that $K$ is normal.

   Finally, suppose that $K$ (and thus $\ov{K}$) is normal, and define
   a homomorphism $\phi\:G\to\ov{G}/\ov{K}$ by
   $\phi(x)=\pi(x)\ov{K}$.  This is clearly surjective, and we have 
   \begin{align*}
    \ker(\phi) &= \{x\in G\st \pi(x)\ov{K} = \ov{K}\} \\
      &= \{x\in G\st \pi(x)\in\ov{K}\} = K
   \end{align*}
   (where we have again used the last part of~(a)).  The First
   Isomorphism Theorem therefore gives us an induced isomorphism
   $\ov{\phi}\:G/K=G/\ker(\phi)\to\ov{G}/\ov{K}$, as claimed.
 \end{itemize}
\end{proof}

\begin{proposition}\lbl{prop-solvable-layers}
 Let $G$ be a finite group.
 \begin{itemize}
  \item[(a)] If $G$ is solvable then every subgroup of $G$ is solvable.
  \item[(b)] If $G$ is solvable, then for every normal subgroup $H\leq
   G$, the quotient $G/H$ is also solvable.
  \item[(c)] If $G$ has a normal subgroup $H$ such that both $H$ and
   $G/H$ are solvable, then $G$ is solvable.
 \end{itemize}
\end{proposition}
\begin{proof}
 \begin{itemize}
  \item[(a)] Suppose that $G$ is solvable, so we have a solvable series
   $G_0\leq\dotsb\leq G_r$ as in the definition.  Let $H$ be a
   subgroup of $G$.  Put $H_i=H\cap G_i$, which is a subgroup of $H$.
   Note that $H_0=H\cap\{1\}=\{1\}$ and $H_r=H\cap G=H$.
   We can define a homomorphism $\pi_i\:H_i\to G_i/G_{i-1}$ by
   $\pi_i(x)=xG_{i-1}$.  The kernel of this is the set of elements in
   $H_i$ that also lie in $G_{i-1}$, so
   \[ \ker(\pi_i)=H_i\cap G_{i-1}=H\cap G_i\cap G_{i-1}=
       H\cap G_{i-1} = H_{i-1}.
   \]
   Thus, the First Isomorphism Theorem tells us that $H_{i-1}$ is
   normal in $H_i$ and that $H_i/H_{i-1}$ is isomorphic to
   $\pi_i(H_i)$.  This is a subgroup of the cyclic group
   $G_i/G_{i-1}$, so is itself cyclic.  Thus, the subgroups $H_i$ form
   a solvable series for $H$.
  \item[(b)] Now suppose that $H$ is normal, so we have a quotient
   group $\ov{G}=G/H$ and a quotient homomorphism $\pi\:G\to\ov{G}$
   given by $\pi(g)=gH$.  Put $\ov{G}_i=\pi(G_i)$, which is a subgroup
   of $\ov{G}$.  Note that $\ov{G}_0=\pi(\{1\})=\{1\}$ and
   $\ov{G}_r=\pi(G)=\ov{G}$.  As $G_{i-1}\sse G_i$ we have
   $\ov{G}_{i-1}\sse \ov{G}_i$.  We next claim that $\ov{G}_{i-1}$ is
   normal in $\ov{G}_i$.  Indeed, if $a\in\ov{G}_i$ and
   $b\in\ov{G}_{i-1}$ then we must have $a=\pi(x)$ and $b=\pi(y)$ for
   some $x\in G_i$ and $y\in G_{i-1}$.  This means that
   $aba^{-1}=\pi(xyx^{-1})$, but $G_{i-1}$ is normal in $G_i$, so
   $xyx^{-1}\in G_{i-1}$, so $aba^{-1}\in\pi(G_{i-1})=\ov{G}_{i-1}$ as
   claimed.  Finally, we claim that $\ov{G}_i/\ov{G}_{i-1}$ is cyclic.
   To see this, choose $x\in H_i$ such that $xH_{i-1}$ generates the
   cyclic group $H_i/H_{i-1}$, and put $a=\pi(x)\ov{G}_{i-1}\in
   \ov{G}_i/\ov{G}_{i-1}$.  Any other element $b\in
   \ov{G}_i/\ov{G}_{i-1}$ has the form $b=\pi(y)\ov{G}_{i-1}$ for some
   $y\in H_i$.  By our choice of $x$ we have $y=x^iz$ for some
   $i\in\Z$ and $z\in H_{i-1}$, and it follows that $b=a^i$, as
   required.  We have thus constructed a solvable series for $\ov{G}$.
  \item[(c)] Now suppose instead that $G$ is a finite group with a
   normal subgroup $H$, and that both $H$ and the quotient group
   $\ov{G}=G/H$ are solvable.  Let $\pi\:G\to\ov{G}$ be the quotient
   map.  Choose solvable series
   \[ \{1\} = H_0 \leq H_1 \leq \dotsb \leq H_r = H \]
   \[ \{1\} = \ov{G}_0 \leq\ov{G}_1 \leq \dotsb \leq \ov{G}_s = \ov{G}.
   \]
   For $1\leq j\leq s$ we put
   $H_{r+j}=\{x\in G\st\pi(x)\in\ov{G}_j\}$.  (For $j=0$ the group
   $H_{r+j}$ is already defined and is equal to $H$, and in this case
   it is still true that $H_{r+j}=\{x\in G\st\pi(x)\in\ov{G}_j\}$.)
   This defines a chain
   \[ \{1\} = H_0 \leq \dotsb \leq H_r = H \leq H_{r+1}
       \leq \dotsb H_{r+s} = G,
   \]
   and with the help of Proposition~\ref{prop-subquotient} we see that
   this is a solvable series for $G$.
 \end{itemize}
\end{proof}

\begin{corollary}\lbl{cor-solvable-defn}
 Let $G$ be a finite group, and suppose that there is a chain 
 \[ \{1\} = G_0 \leq G_1 \leq \dotsb \leq G_r = G \]
 such that $G_{i-1}$ is normal in $G_i$ and $G_i/G_{i-1}$ is abelian
 for all $i$.  Then $G$ is solvable.
\end{corollary}
\begin{proof}
 Recall from Proposition~\ref{prop-abelian-solvable} that all abelian
 groups are solvable, so $G_i/G_{i-1}$ is solvable for all $i$.  This
 means that $G_1$ and $G_2/G_1$ are solvable, so $G_2$ is solvable by
 Proposition~\ref{prop-solvable-layers}(c).  Now $G_2$ and $G_3/G_2$
 are solvable, so $G_3$ is solvable by
 Proposition~\ref{prop-solvable-layers}(c).  Continuing in this way,
 we see that $G_i$ is solvable for all $i$.  In particular, the group
 $G=G_r$ is solvable as claimed.
\end{proof}


In Section~\ref{sec-cyclotomic} we analysed cyclotomic extensions of
$\Q$.  In fact, most of what we said there can be adapted to cover
cyclotomic extensions of any field of characteristic zero.  Our next
result is one instance of that.

\begin{proposition}\lbl{prop-cyclotomic-abelian}
 Suppose we have a field $K$ of characteristic zero and an extension
 $L=K(\zt)$, where $\zt^n=1$.  Then $L$ is normal over $K$ and
 $G(L/K)$ is abelian.
\end{proposition}
\begin{proof}
 Let $d$ be the smallest positive integer such that $\zt^d=1$.  We
 then find that $1,\zt,\dots,\zt^{d-1}$ are $d$ distinct roots of the
 polynomial $x^d-1$, so we have $x^d-1=\prod_{i=0}^{d-1}(x-\zt^i)$ in
 $L[x]$.  This proves that $L$ is a splitting field for $x^d-1$ over
 $K$, so it is a normal extension of $K$.  Next, for each
 $\sg\in G(L/K)$ we see that $\sg(\zt)$ is a root of $x^d-1$, so
 $\sg(\zt)=\zt^{\lm(\sg)}$ say.  Here $\lm(\sg)$ is an integer that is
 well-defined modulo $d$, so we can regard $\lm$ as a function
 $G(L/K)\to\Z/d\Z$.  Note that
 \[ \tau(\sg(\zt)) = \tau(\zt^{\lm(\sg)}) = 
     \tau(\zt)^{\lm(\sg)}=\zt^{\lm(\tau)\lm(\sg)},
 \]
 which means that $\lm(\tau\sg)=\lm(\tau)\lm(\sg)$.  In particular, we
 have $\lm(\sg^{-1})\lm(\sg)=\lm(1_L)=1$, so $\lm(\sg)$ is invertible
 in $\Z/n\Z$, and we can regard $\lm$ as a group homomorphism
 $G(L/K)\to(\Z/n\Z)^\tm$.  We claim that this is injective.  Indeed,
 if $\lm(\sg)=1$ then $\sg(\zt)=\zt$, so $\sg$ acts as the identity on
 $K(\zt)$, but $K(\zt)=L$, so $\sg=1$ as required.  We now see that
 $G(L/K)$ is isomorphic to a subgroup of the abelian group
 $(\Z/n\Z)^\tm$, so $G(L/K)$ is abelian.
\end{proof}

\begin{proposition}\lbl{prop-radicals-a}
 Let $K$ be a field of characteristic zero.  Let $L$ be a splitting
 field for a polynomial $f(x)\in K[x]$, and suppose that $G(L/K)$ is
 solvable.  Then $f(x)$ is solvable by radicals.
\end{proposition}
\begin{proof}
 Put $n=[L:K]$, and let $N$ be a splitting field for $x^n-1$ over $L$.
 This is also a splitting field for $(x^n-1)f(x)$ over $K$, so it is
 normal over $K$.   Next, consider the composite 
 \[ \phi = (G(N/K(\zt)) \xra{\text{include}} G(N/K)
              \xra{\text{restrict}} G(L/K)).
 \]
 If $\sg$ is in the kernel then it acts as the identity on $K(\zt)$
 (because $\sg\in G(L/K)$) and on $L$ (as $\phi(\sg)=1$) so it acts
 as the identity on $L(\zt)=N$, so $\sg=1$.  This means that $\phi$ is
 injective, so $G(N/K(\zt))$ is isomorphic to a subgroup of $G(L/K)$.
 This means that $|G(N/K(\zt))|$ divides $n$, and also that
 $G(N/K(\zt))$ is solvable.  We can thus find a solvable series 
 \[ \{1\} = H_0 \leq H_1 \leq \dotsb \leq H_r = G(N/K(\zt)). \]
 We put $N_i=N^{H_i}$, so that 
 \[ N = N_0 \supseteq N_1 \supseteq \dotsb \supseteq N_r = K(\zt).
 \]
 As $H_{i-1}$ is normal in $H_i$ we see that $N_{i-1}$ is normal over
 $N_i$.  The Galois group $G(N_{i-1}/N_i)$ is isomorphic to
 $H_i/H_{i-1}$, so it is cyclic, of order $n_i$ say.  Here $n_i$
 divides $|H_r|$ which divides $n$, so $x^{n_i}-1$ splits in
 $K(\zt)\sse N_i$.  We can thus use Proposition~\ref{prop-cyclic-ext}
 to find $\al_{i-1}\in N_{i-1}$ such that $N_{i-1}=N_i(\al_{i-1})$ and
 $\al_{i-1}^{n_i}\in N_i$.  This proves that $N$ is a radical
 extension of $K(\zt)$, which is clearly a radical extension of $K$.
 Thus $L$ is contained in a radical extension of $K$, as required.
\end{proof}

\begin{lemma}\lbl{lem-normal-radical}
 Let $N$ be a radical extension of $K$.  Then there is another
 extension $M\supseteq N$, an integer $n>0$, and a chain of
 subfields $K\sse M_0\sse \dotsb \sse M_t=M$ such that:
 \begin{itemize}
  \item[(a)] $M$ is normal over $K$.
  \item[(b)] $M_0=K(\zt)$ for some $\zt$ such that
   $x^n-1=\prod_{i=0}^{n-1}(x-\zt^i)$ in $M_0[x]$.
  \item[(c)] For $0<k\leq t$ we have $M_k=M_{k-1}(\bt_k)$ for some 
   $\bt_k$ such that $\bt_k^n\in M_{k-1}$.
 \end{itemize}
 (In particular, $M$ is again a radical extension of $K$.)
\end{lemma}
\begin{proof}
 As $N$ is a radical extension of $K$, we can choose elements
 $\al_1,\dotsc,\al_r$ and integers $n_1,\dotsc,n_r$ as in
 Definition~\ref{defn-radical-extension}.  Put $n=n_1n_2\dotsb n_r$,
 so $\al_i^n$ is a power of $\al_i^{n_i}$ and therefore lies in
 $K(\al_1,\dotsc,\al_{i-1})$.  Put $f_i(t)=\min(\al_i,K)$ and
 $f(t)=(t^n-1)\prod_{i=1}^rf_i(t)\in K[t]$.  Let $M$ be a splitting
 field for $f(t)$ over $N$, so $K\sse N\sse M$.  Put
 $\mu_n=\{a\in M\st a^n=1\}$.  This is a subgroup of $M^\tm$, and it
 has order $n$ because $x^n-1$ splits in $M[t]$.  It is also cyclic by
 Proposition~\ref{prop-units-cyclic}.  We choose a generator and call
 it $\zt$.  Next, let $P_i$ be the
 subfield of $M$ generated by the roots of
 $x^n-1,f_1(t),\dotsc,f_i(t)$, so 
 \[ K \sse K(\zt) = P_0\sse P_1\sse \dotsb\sse P_r=M. \]
 Let the roots of $f_i(t)$ be $\gm_1,\dotsc,\gm_s$, so
 $P_i=P_{i-1}(\gm_1,\dotsc,\gm_s)$.  We claim that $\gm_j^n\in
 P_{i-1}$.  Indeed, $\al_i$ and $\gm_j$ are both roots in $M$ of the
 irreducible polynomial $f_i(t)\in K[t]$, so
 Proposition~\ref{prop-root-perms}(c) tells us that there is an
 automorphism $\sg\in G(M/K)$ with $\sg(\al_i)=\gm_j$.  As
 $\al_i^n\in K(\al_1,\dotsc,\al_{i-1})\sse P_{i-1}$, we deduce that
 $\gm_j^n=\sg(\al_i^n)\in\sg(P_{i-1})$.  As $P_{i-1}$ is normal over
 $K$ we have $\sg(P_{i-1})=P_{i-1}$, so $\gm_j^n\in P_{i-1}$ as
 required.  

 Now let the list $\bt_1,\dotsc,\bt_t$ consist of the roots of
 $f_1(t)$, followed by the roots of $f_2(t)$, and so on.  Put
 $M_k=K(\zt,\bt_1,\dotsc,\bt_k)$.  It is now clear that these have the
 stated properties.
\end{proof}

\begin{lemma}\lbl{lem-radicals-b}
 In the situation of Lemma~\ref{lem-normal-radical}, the group
 $G(M/K)$ is solvable.
\end{lemma}
\begin{proof}
 By the Galois Correspondence, there are subgroups 
 \[ G(M/K) \geq H_0 \geq H_1 \geq \dotsb \geq H_t = \{1\} \]
 such that $M_k=M^{H_k}$ for all $k$.  As $\zt\in M_0$ we see that the
 polynomial $t^n-\bt_k^n\in M_{k-1}[t]$ actually splits as
 $\prod_{i=0}^{n-1}(t-\zt^i\bt_k)$ in $M_k[t]$, so $M_k$ is normal
 over $M_{k-1}$.  It follows that $H_k$ is normal in $H_{k-1}$, and
 the quotient $H_{k-1}/H_k$ can be identified with $G(M_k/M_{k-1})$,
 which is cyclic by Proposition~\ref{prop-cyclic-ext}.  Similarly, as
 $M_0$ is a splitting field for $t^n-1$ over $K$ we see that $H_0$ is
 normal in $G(M/K)$, and the quotient $G(M/K)/H_0$ can be identified
 with $G(K(\zt)/K)$, which is abelian by
 Proposition~\ref{prop-cyclotomic-abelian}.  We can thus apply
 Corollary~\ref{cor-solvable-defn} to see that $G(M/K)$ is solvable,
 as claimed.
\end{proof}

\begin{corollary}\lbl{cor-radicals-b}
 Let $K$ be a field of characteristic zero, and let $f(x)$ be a monic
 polynomial over $K$.  Suppose we have fields $K\sse L\sse N$ such
 $L$ is a splitting field for $K$, and $N$ is a radical extension of
 $K$.  Then $G(L/K)$ is solvable.
\end{corollary}
\begin{proof}
 Choose $M$ as in Lemma~\ref{lem-normal-radical}, so $G(M/K)$ is
 solvable by the lemma.  As $L$ and $M$ are both normal over
 $K$, we have $G(L/K)\simeq G(M/K)/G(M/L)$, which is solvable by
 Proposition~\ref{prop-solvable-layers}(b). 
\end{proof}

\begin{proposition}\lbl{prop-An-simple}
 If $n\geq 5$ then the only normal subgroups of $A_n$ are $\{1\}$ and
 $A_n$ itself.  
\end{proposition}

The proof will be given after some preliminaries.

\begin{lemma}\lbl{lem-commutator}
 Let $G$ be a group, and let $H$ be a normal subgroup.  Then for all
 $g\in G$ and $h\in H$, the commutator $[g,h]=ghg^{-1}h^{-1}$ lies in
 $H$.  
\end{lemma}
\begin{proof}
 As $H$ is normal we see that $ghg^{-1}\in H$, and also $h^{-1}\in H$
 and $H$ is closed under multiplication so $ghg^{-1}h^{-1}\in H$.
\end{proof}

\begin{lemma}\lbl{lem-cycle-type}
 Let $\sg$ and $\sg'$ be permutations in $A_n$ with the same cycle
 type, and suppose that there is an odd permutation $\tau$ that
 commutes with $\sg$.  Then $\sg$ is conjugate to $\sg'$ in $A_n$.
\end{lemma}
\begin{proof}
 It is standard that the cycle type determines the conjugacy class in
 $\Sg_n$, so there is a permutation $\lm\in\Sg_n$ with
 $\lm\sg\lm^{-1}=\sg'$.  If $\lm$ is even then we are done.
 Otherwise, the permutation $\mu=\lm\tau$ is even and we have 
 \[ \mu\sg\mu^{-1} = \lm\tau\sg\tau^{-1}\lm^{-1} = 
     \lm\sg\tau\tau^{-1}\lm^{-1} = \lm\sg\lm^{-1} = \sg',
 \]
 so again $\sg'$ is conjugate in $A_n$ to $\sg$.
\end{proof}
\begin{corollary}\lbl{cor-An-conjugacy}
 If $n\geq 5$ then all $3$-cycles are conjugate in $A_n$, and all
 transposition pairs are conjugate in $A_n$.
\end{corollary}
\begin{proof}
 Any transposition pair $\sg=(a\;b)(c\;d)$ comutes with the odd
 permutation $(a\;b)$.  If $\rho=(a\;b\;c)$ is a $3$-cycle, then (as
 $n\geq 5$) we can find a transposition $(d\;e)$ that is disjoint from
 $\rho$, so again this gives an odd permutation that commutes with
 $\rho$.  
\end{proof}

\begin{lemma}\lbl{lem-An-simple}
 Let $H$ be a normal subgroup of $A_n$ (where $n\geq 5$) and suppose
 that $H$ contains either a $3$-cycle or a transposition pair.  Then
 $H=A_n$. 
\end{lemma}
\begin{proof}
 If $H$ contains one $3$-cycle it contains all of them (by
 Corollary~\ref{cor-An-conjugacy}).  One can then
 check that $[(1\;2)(3\;4),(1\;2\;3)]=(1\;3)(2\;4)$, so $H$ also
 contains a transposition pair, and therefore (by the same corollary)
 contains all transposition pairs.  

 Suppose instead we start by assuming that $H$ contains a
 transposition pair, and thus contains all transposition pairs.  One
 can then check that $[(1\;2\;5),(1\;2)(3\;4)]=(1\;5\;2)$, so $H$
 contains a $3$-cycle, and so contains all $3$-cycles.  

 Now let $\al$ and $\bt$ be any two transpositions.  Then $\al\bt$ is
 either the identity (if $\al=\bt$) or a $3$-cycle (if $\al$ and $\bt$
 overlap) or a transposition pair.  In all cases, we have
 $\al\bt\in H$.  Now let $\sg$ be any even permutation.  Then we can
 write $\sg$ as the product of an even number of transposition, and by
 grouping them in pairs, we see that $\sg\in H$.  Thus $H=A_n$ as
 claimed. 
\end{proof}

\begin{proof}[Proof of Proposition~\ref{prop-An-simple}]
 Let $H$ be a nontrivial normal subgroup of $A_n$.  Choose an element
 $\sg\in H$ with $\sg\neq 1$.  We will consider various different
 cases depending on the cycle type of $\sg$.
 \begin{itemize}
  \item[(a)] Suppose that $\sg$ involves an $r$-cycle
   $\rho=(a_1\;\dotsb\;a_r)$ for some $r>3$.  Put
   $\tau=(a_1\;a_2\;a_3)$.  This commutes with all the other cycles in
   $\sg$, and it follows that $[\tau,\sg]=[\tau,\rho]$.  One can check
   directly that $[\tau,\rho]=(a_1\;a_2\;a_4)$, so $H$ contains a
   $3$-cycle, so $H=A_n$ by Lemma~\ref{lem-An-simple}.
  \item[(b)] Now suppose that~(a) does not hold, so $\sg$ involves
   only $3$-cycles and transpositions.  Suppose that there is at least
   one transposition.  As $\sg$ is even and $3$-cycles are even, there
   must be an even number of transpositions.  We can thus write
   $\sg=\rho\om$, where $\rho=(a\;b)(c\;d)$ and $\om$ is disjoint from
   $\rho$.  Put $\tau=(a\;b\;c)$; we then find that
   $[\tau,\sg]=[\tau,\rho]=(a\;b)(c\;d)$, so $H$ contains a
   transposition pair.  It follows by Lemma~\ref{lem-An-simple} that
   $H=A_n$.
  \item[(c)] Now suppose that neither~(a) nor~(b) holds, so $\sg$ is a
   product of $3$-cycles.  If $\sg$ is a single $3$-cycle then we can
   immediately use Lemma~\ref{lem-An-simple} to see that $H=A_n$.  If
   there are at least two $3$-cycles then we can write $\sg=\rho\om$,
   where $\rho=(a\;b\;c)(d\;e\;f)$ and $\om$ is disjoint from $\rho$.
   We then put $\tau=(a\;b\;d)$ and check that 
   \[ [\tau,\sg] = [\tau,\rho] = (a\;b\;e\;c\;d). \]
   We can thus apply case~(a) to this $5$-cycle to see that $H=A_n$
   again. 
 \end{itemize}
\end{proof}

\begin{corollary}\lbl{cor-not-solvable}
 For $n\geq 5$ the groups $\Sg_n$ and $A_n$ are not solvable.
\end{corollary}
\begin{proof}
 Suppose we have a solvable series
 $1=H_0\leq H_1\leq \dotsb\leq H_{r-1}\leq H_r=A_n$.  After
 eliminating any repetitions, we may assume that these inclusions are
 strict, so $1<H_1<\dotsb<H_{r-1}<H_r=A_n$.  By the definition of a
 solvable series, the group $H_{r-1}$ must be normal in $A_n$, and
 also $H_{r-1}<A_n$, so we must have $H_{r-1}=1$.  This means that
 $A_n=H_r/H_{r-1}$, but $H_r/H_{r-1}$ is cyclic, so this is
 impossible.  This means that $A_n$ is not solvable.  As every
 subgroup of a solvable group is solvable, it follows that $\Sg_n$ is
 also not solvable.
\end{proof}

We now see, as claimed previously, that polynomials of degree at least
$5$ are typically not solvable by radicals.

%============================================================
%============================================================

\begin{center}
 \Large \textbf{Exercises}
\end{center}

\begin{exercise}\exlabel{ex-check-solvable}
 Which of the following polynomials are solvable by radicals over $\Q$?
 \begin{align*}
  f_0(x) &= 2x^5-10x^2-5x \\
  f_1(x) &= 2x^5-10x-5    \\
  f_2(x) &= 2x^6-10x^2-5  \\
  f_3(x) &= 5x^5+10x^4-2  \\
  f_4(x) &= x^5-405x+3    \\
  f_5(x) &= 4x^{10}-40x^6-20x^5+100x^2+100x+25.
 \end{align*}
 Three of these polynomials have the same splitting field. Which are they?
\end{exercise}
\begin{solution}
 The polynomials $f_0(x)$ and $f_2(x)$ are solvable by radicals, but
 $f_1(x)$, $f_3(x)$, $f_4(x)$ and $f_5(x)$ are not.  This can be
 proved as follows.
 \begin{itemize}
  \item $f_0(x)$ is $x$ times a quartic, and quartics are solvable by
   radicals.  (Maple says that the relevant Galois group is $\Sg_4$.)
  \item $f_1(x)$ is irreducible by Eisenstein's criterion at $p=5$.
   It also has precisely three real roots (approximately $-1.33,
   -0.51, 1.60$), as one can see by plotting or an argument with
   Rolle's Theorem and the Intermediate Value Theorem.  The Galois
   group is thus $\Sg_5$ by Corollary~\ref{cor-all-perms}, which means
   that $f_1(x)$ is not solvable by radicals. 
  \item Put $g_2(x)=2x^3-10x+5$, so $f_2(x)=g_2(x^2)$.  As $g_2(x)$ is
   cubic, it is solvable by radicals.  If the roots of $g_2(x)$ are
   $\al$, $\bt$ and $\gm$, then the roots of $f_2(x)$ are
   $\pm\sqrt{\al}$, $\pm\sqrt{\bt}$ and $\pm\sqrt{\gm}$.  It follows
   that the splitting field for $f_2(x)$ is obtained from that for
   $g_2(x)$ by adjoining some square roots, which is a further radical
   extension; so $f_2(x)$ is solvable by radicals.  Maple says
   that the relevant Galois group is of order 48, isomorphic to the
   subgroup of $\Sg_6$ generated by $(1~2~3~4)$ and $(1~5)(3~6)$.
  \item We observe that $f_3(x)=x^5f_1(1/x)$, so the roots of $f_3(x)$
   are the inverses of the roots of $f_1(x)$.  This means that
   $f_3(x)$ has the same splitting field as $f_1(x)$, so the Galois
   group is again $\Sg_5$, so $f_3(x)$ is not solvable by radicals. 
  \item $f_4(x)$ is irreducible by Eisenstein's criterion at $p=3$,
   and has precisely three real roots (close to $x=0$ and
   $x=\pm 4.5$).  We can again use Corollary~\ref{cor-all-perms} to
   see that the Galois group is $\Sg_5$ and the polynomial is not
   solvable by radicals.
  \item One can check that $f_5(x)=f_1(x)^2$, so $f_5(x)$ has the same
   roots and the same splitting field as $f_1(x)$, so it is not
   solvable by radicals.
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-septic}
 Prove that the polynomial $f(x)=30x^7-70x^6-42x^5+105x^4-21$ is not
 solvable by radicals.
\end{exercise}
\begin{solution}
 It will be enough to show that the Galois group of the splitting
 field is $\Sg_7$.  Using Corollary~\ref{cor-all-perms}, it will thus
 be enough to show that $f(x)$ is irreducible and has precisely five
 real roots.  Irreducibility follows from Eisenstein's criterion at
 $p=7$.  We can plot the graph using Maple, and we see that the roots
 are as required:
 \begin{center}
  \begin{tikzpicture}[xscale=1.5]
   \def\ff{-0.21+(1.05+(-0.42+(-0.7+0.3*\x)*\x)*\x)*\x*\x*\x*\x}
   \begin{scope}
    \draw[->] (-1.4,0) -- (2.4,0);
    \draw[->] (0,-3.3) -- (0,2.4);
    \draw (-1,0) -- (-1,-0.1);
    \draw ( 0,0) -- ( 0,-0.1);
    \draw ( 1,0) -- ( 1,-0.1);
    \draw ( 2,0) -- ( 2,-0.1);
    \draw (-1,-0.25) node{$-1$};
    \draw ( 1,-0.25) node{$ 1$};
    \draw[red,domain=-1.35:2.35,smooth,samples=200,variable=\x]
      plot ({\x},{\ff});
    \draw[dotted] (1,0) circle(0.15);
   \end{scope}
   \begin{scope}[xshift=3cm,xscale=3,yscale=10]
    \draw (0.85,0) -- (1.15,0);
    \draw[red,domain=0.85:1.15,smooth,samples=200,variable=\x]
      plot ({\x},{\ff});
    \draw[dotted] (1,0) circle(0.15);
   \end{scope}
  \end{tikzpicture}
 \end{center}
 More rigorously, we can check that
 \[ f'(x) = 210(x^6-2x^5-x^4+2x^3) = 210x^3(x-1)(x+1)(x-2), \]
 which has four real roots, at $-1,0,1,2$.  Rolle's Theorem says that
 between any two real roots of $f(x)$ there is a real root of
 $f'(x)$, so there are at most five real roots.  We also have   
 \begin{align*}
   f(x)  &\to -\infty\qquad\mbox{as }x\to-\infty\\
   f(-1) &= 26    \\
   f(0)  &= -21   \\
   f(1)  &= 2     \\
   f(2)  &= -325  \\
   f(x)  &\to +\infty\qquad\mbox{as }x\to+\infty
 \end{align*}
  so (by the Intermediate Value Theorem) $f(x)$ has exactly five real
  roots. 
\end{solution}
\begin{exercise}\exlabel{ex-affine-five}
 In this question it will be convenient to think $\Sg_5$ as the group
 of permutations of the set $\F_5=\{0,1,2,3,4\}$.  For $a\in\F_5^\tm$
 and $b\in\F_5$ we define $\rho_{ab}\:\F_5\to\F_5$ by
 $\rho_{ab}(u)=au+b$.  We then put 
 \[ U = \{\rho_{ab}\st a\in\F_5^\tm,b\in\F_5.  \]
 \begin{itemize}
  \item[(a)] Prove that $U$ is a subgroup of $\Sg_5$, which contains a
   normal cyclic subgroup of order $5$, whose quotient is cyclic of
   order $4$.
  \item[(b)] Suppose that $H$ is some other subgroup of $\Sg_5$, and
   there is a cyclic subgroup $C$ of order $5$ that is normal in $H$.
   Prove that $H$ is conjugate to a subgroup of $A$.
  \item[(c)] Prove that any transitive subgroup of $\Sg_5$ is either
   equal to $\Sg_5$, or equal to $A_5$, or conjugate to a subgroup of
   $A$. 
 \end{itemize}
\end{exercise}
\begin{solution}\ \\
 \begin{itemize}
  \item[(a)] First note that 
   \[ \rho_{ab}(\rho_{cd}(u)) = 
       a(cu+d)+b = (ac)u+(ad+b) = \rho_{ac,ad+b}(u).
   \] 
   It follows that $U$ is closed under composition.  We also see that
   $\rho_{10}$ is the identity, and that $\rho_{1/a,-b/a}$ is an
   inverse for $\rho_{ab}$.  This means that $U$ is a subgroup of
   $\Sg_5$.  Now define $\pi\:U\to\F_5^\tm$ by $\pi(\rho_{ab})=a$.
   The above composition formula shows that
   $\pi(\rho_{ab}\rho_{cd})=ac=\pi(\rho_{ab})\pi(\rho_{cd})$, so $\pi$
   is a homomorphism.  For each $a\in\F_5^\tm$ we have an element
   $\rho_{a0}\in U$ with $\pi(\rho_{a0})=a$, so $\pi$ is surjective.
   The kernel is $V=\{\rho_{1b}\st b\in\F_5\}$, which is therefore a
   normal subgroup.  The First Isomorphism Theorem tells us that
   $U/V\simeq\F_5^\tm=\{-2,-1,1,2\}$, which is cyclic of order $4$,
   generated by $2$.  We also see from the composition formula that
   $\rho_{1b}\rho_{1d}=\rho_{1,b+d}$, so $\rho_{1b}=\rho_{11}^b$.  It
   follows that $V$ is cyclic of order $5$, generated by $\rho_{11}$.
  \item[(b)] Let $H$ be a subgroup of $\Sg_5$, and let $C$ be a normal
   subgroup of $H$ that is cyclic of order $5$.  Choose a generator
   $\sg$ for $C$.  This has order $5$, and by considering the possible
   cycle types in $\Sg_5$ we see that it must be a $5$-cycle, say
   $\sg=(p_0\;p_1\;p_2\;p_3\;p_4)$.  Let $\tht$ be the permutation
   that sends $i$ to $p_i$, and note that
   $\tht^{-1}\sg\tht=\rho_{11}$.  Put $H'=\tht^{-1}H\tht$ and
   $C'=\tht^{-1}C\tht$, so $C'$ is normal in $H'$.  As
   $\tht^{-1}\sg\tht=\rho_{11}$ we see that $C'=V$.  Now consider an
   arbitrary element $\tau\in H'$.  Put $b=\tau(0)\in\F_5$.  As $V$ is
   normal in $H'$ we see that $\tau\rho_{11}\tau^{-1}$ must be another
   generator for $V$, so $\tau\rho_{11}\tau^{-1}=\rho_{1a}$ for some
   $a\in\F_5^\tm$.  We now claim that $\tau=\rho_{ab}$, or
   equivalently that the permutation $\phi=\rho_{ab}^{-1}\tau$ is the
   identity.  Indeed, we have $\rho_{ab}(0)=b=\tau(0)$, so
   $\phi(0)=0$.  We also have
   \[ \rho_{ab}\rho_{11}\rho_{ab}^{-1}=\rho_{a,a+b}\rho_{1/a,-b/a}=
    \rho_{1a} = \tau\rho_{11}\tau^{-1},
   \]
   so $\phi\rho_{11}\phi^{-1}=\rho_{11}$.  This means that $\phi$
   commutes with $\rho_{11}$, and thus also with
   $\rho_{1m}=\rho_{11}^m$.  It follows that 
   \[ \phi(m) = \phi(\rho_{1m}(0)) = \rho_{1m}(\phi(0)) = 
       \rho_{1m}(0) = m,
   \]
   so $\phi$ is the identity as claimed, so $\tau=\rho_{ab}$.  As
   $\tau$ was an arbitrary element of $H'$, we conclude that
   $H'\sse U$, and so $H=\tht H'\tht^{-1}\sse\tht U\tht^{-1}$.
  \item[(c)] Now instead let $H$ be an arbitrary transitive subgroup
   of $\Sg_5$.  For any $x\in\F_5$, the orbit $Hx$ is then the whole
   set $\F_5$.  We have the standard orbit-stabiliser identity
   $|H|=|Hx|.|\stab_H(x)|=5|\stab_H(x)|$, so $|H|$ must be divisible
   by $5$.  Moreover, $|H|$ must divide $|\Sg_5|=120$, so it cannot be
   divisible by $5^2$.  Let $C$ be any Sylow $5$-subgroup of $H$; then
   $|C|=5$ is prime, so $C$ must be cyclic.  If $C$ is normal in $H$
   then $H$ is conjugate to a subgroup of $U$ by part~(b).  From now
   on we suppose that $C$ is not normal in $H$.  Sylow theory tells us
   that the Sylow subgroups of $H$ are precisely the conjugates of
   $C$, and that the number $n$ of such conjugates divides
   $|H|/|C|$ and is congruent to $1$ modulo $5$.  Moreover, as $C$ is
   not normal we have $n>1$, and $|H|/|C|$ must divide
   $|\Sg_5|/|C|=24$.  It follows that $n=6$, and this must divide
   $|H|/|C|$, so $|H|\in\{30,60,120\}$.  If $|H|=120$ then $H$ is all
   of $\Sg_5$.  If $|H|=60$ then $H$ has index two, so it is normal by
   a standard lemma.  It is not hard to deduce that $H=A_5$.  

   \textbf{This just leaves the case where $|H|=30$. I think that
    there are no subgroups of order $30$ in $\Sg_5$, but this needs a
    proof. }
 \end{itemize}
\end{solution}
\begin{exercise}\exlabel{ex-special-sextic}
 Find an irreducible polynomial of degree 6 over $\Q$ with 4 real roots,
 but whose Galois group over $\Q$ is not $\Sg_6$.
\end{exercise}
\begin{solution}
 These are not too difficult to construct. Here is one way to do it:
 \begin{description}
  \item[1] Choose a cubic with two positive real roots and one negative real
  root. For example, $x^3-7x+6=(x+3)(x-1)(x-2)$.
  \item[2] Move this polynomial up or down the $y$-axis slightly to make it
  irreducible, but still ensuring that there are two positive and one
  negative real root. (If you do this cleverly, you will be able to use
  Eisenstein's criterion to check irreducibility!) For example, 
  $x^3-7x+6-\frac{1}{6}=\frac{1}{6}(6x^3-42x+35)$ is irreducible by
  Eisenstein's criterion with $p=7$.
  \item[3] Now replace $x$ by $x^2$ to get a polynomial of degree 6. In our
  example, we can consider the polynomial $6x^6-42x^2+35$. Now this polynomial 
  is still irreducible by Eisenstein with $p=7$, and its roots are the square
  roots of the roots of the cubic in step 2, two of which were positive, 
  giving 4 real roots, and one negative, giving 2 imaginary roots. Finally, the
  Galois group cannot be $\Sg_6$, since the polynomial is solvable by radicals
  (the roots are just the square roots of the roots of the cubic, so are
  certainly expressible as radicals).
 \end{description} 
\end{solution}



% \section{Things still to do}

% \begin{itemize}
%  \item Ruler and compass constructions
%  \item Norms, traces and characteristic polynomials
%  \item Hilbert's Theorem 90
%  \item The Normal Basis Theorem.
% \end{itemize}

\newpage

\section*{Solutions}
\label{apx-solutions}

\includesolutions


% \begin{bibdiv}
% \begin{biblist}
% \bibselect{%
% ../../../BiBTeX/refs,%
% ../../../BiBTeX/myrefs%
% }
% \end{biblist}
% \end{bibdiv}

\end{document}



